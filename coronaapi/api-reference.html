<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>API Reference</title>
    <!-- base href="http://developer.anscamobile.com/" -->
    <link type="text/css" rel="stylesheet" 
href="api-reference_files/print.css">
      </head>
  <body>
        
    <div id="node-728" class="section-1">
  <h1 class="book-heading">API Reference</h1>
  <h3 id="Index_of_Methods_and_Properties">Index of Methods and 
Properties</h3>
<p>This list is a quick reference.  It's constantly being updated.  Use 
the navigation to the left to view full articles, or click a method or 
property below to read more about it.</p>

<div class="col1">

<h5 id="Display_Objects">Display Objects</h5>
<hr>
<em>Factory Functions</em>
<ul>
  <li><a 
href="#display.newCircle_">display.newCircle
 ( ) </a></li>
  <li><a 
href="#display.newImage_">display.newImage
 ( )</a></li>
  <li><a 
href="#display.newLine_">display.newLine
 ( )</a></li>
  <li><a 
href="#display.newRect_">display.newRect
 ( ) </a></li>
  <li><a 
href="#display.newRoundedRect_">display.newRoundedRect
 ( )</a></li>
  <li><a 
href="#display.newText_">display.newText
 ( )</a></li>
  <li><a 
href="#display.newGroup">display.newGroup
 ( )</a></li>
</ul>
<br>
<em>Common Properties</em>
<ul>
  <li><a 
href="#object.alpha">object.alpha</a></li>
  <li><a 
href="#object.height">object.height</a></li>
  <li><a 
href="#object.isVisible_">object.isVisible
 </a></li>
  <li><a 
href="#object.isHitTestable">object.isHitTestable</a></li>
  <li><a 
href="#object.length">object.length</a></li>
  <li><a 
href="#object.parent">object.parent</a></li>
  <li><a 
href="#object.rotation">object.rotation</a></li>
  <li><a 
href="#object.stageBounds">object.stageBounds</a></li>
  <li><a 
href="#object.stageHeight">object.stageHeight</a></li>
  <li><a 
href="#object.stageWidth">object.stageWidth</a></li>
  <li><a 
href="#object.width">object.width</a></li>
  <li><a 
href="#object.x">object.x</a></li>
  <li><a 
href="#object.xOrigin">object.xOrigin</a></li>
  <li><a 
href="#object.xReference">object.xReference</a></li>
  <li><a 
href="#object.xScale">object.xScale</a></li>
  <li><a 
href="#object.y">object.y</a></li>
  <li><a 
href="#object.yOrigin">object.yOrigin</a></li>
  <li><a 
href="#object.yReference">object.yReference</a></li>
  <li><a 
href="#object.yScale">object.yScale</a></li>
</ul>
<br>
<em>Common Methods</em>
<ul>
  <li><a 
href="#object:dispatchEvent_event_">object:dispatchEvent
 ( )</a></li>  <li><a 
href="#object:getParent">object:getParent
 ( )</a></li>
  <li><a 
href="#object:rotate_">object:rotate
 ( )</a></li>
  <li><a 
href="#object:scale_">object:scale
 ( )</a></li>
  <li><a 
href="#object:setReferencePoint_">object:setReferencePoint
 ( )</a></li>
  <li><a 
href="#object:translate_deltaX_deltaY_">object:translate
 ( ) </a></li>
</ul>
<br>
<em>Vector Display Objects</em>
<ul>
  <li><a 
href="#object.strokeWidth">object.strokeWidth</a></li>
  <li><a 
href="#object:setFillColor_">object:setFillColor
 ( )</a></li>
  <li><a 
href="#object:setStrokeColor_">object:setStrokeColor
 ( ) </a></li>
</ul>
<br>
<em>Text Display Objects</em>
<ul>
  <li><a 
href="#object.text">object.text</a></li>
  <li><a 
href="#object.size">object.size</a></li>
  <li><a 
href="#object:setTextColor_">object:setTextColor
 ( )</a></li>
</ul>
<br>
<em>Group Display Objects</em>
<ul>
  <li><a 
href="#group.numChildren">group.numChildren</a></li>
  <li><a 
href="#group:insert_">group:insert
 ( ) </a></li>
  <li><a 
href="#group:remove_">group:remove
 ( )</a></li>
</ul>
<br>
<em>Stage Display Objects</em>
<ul>
  <li><a 
href="#stage:setFocus_">stage:setFocus
 ( )</a></li>
</ul>
<br>
<em>Other Display Functions</em>
<ul>
  <li><a 
href="#display.captureScreen_saveToAlbum_">display.captureScreen
 ( ) </a></li>
  <li><a 
href="#display.save_displayObject_filename_baseDirectory_">display.save
 ( ) </a></li>
  <li><a 
href="#display.setStatusBar_mode_">display.setStatusBar
 ( ) </a></li>
</ul>
<br>
<em>Content Size Properties</em>
<ul>
  <li><a 
href="#display.contentWidth">display.contentWidth</a></li>
  <li><a 
href="#display.contentHeight">display.contentHeight</a></li>
  <li><a 
href="#display.statusBarHeight_">display.statusBarHeight
 </a></li>
</ul>

<h5 id="Events">Events</h5>
<hr>
<ul>
	<li><a 
href="#object:addEventListener_">object:addEventListener
 ( )</a></li>
	<li><a 
href="#object:removeEventListener_">object:removeEventListener
 ( )</a></li>
</ul>
<br>
<em>accelerometer</em>
<ul>
	<li><a 
href="#event.name-4">event.name</a></li>
	<li><a 
href="#event.xGravity">event.xGravity</a></li>
	<li><a 
href="#event.yGravity">event.yGravity</a></li>
	<li><a 
href="#event.zGravity">event.zGravity</a></li>
	<li><a 
href="#event.xInstant">event.xInstant</a></li>
	<li><a 
href="#event.yInstant">event.yInstant</a></li>
	<li><a 
href="#event.zInstant">event.zInstant</a></li>
	<li><a 
href="#event.isShake">event.isShake</a></li>
</ul>
<br>
<em>animation</em>
<ul>
   <li><a 
href="#si:addListeneranimation_listener">event.sprite</a></li>
   <li><a 
href="#si:addListeneranimation_listener">event.phase</a></li>
</ul>
<br>
<em>collision</em>
<ul>
	<li><a 
href="#Collision_events">event.phase</a></li>
    <li><a 
href="#Global_collision_listeners">event.object1</a></li>
    <li><a 
href="#Global_collision_listeners">event.object2</a></li>
    <li><a 
href="#Local_collision_listeners">event.other</a></li>
    <li><a 
href="#Collision_forces">event.force</a></li>
    <li><a 
href="#Collision_forces">event.friction</a></li>
</ul>

<br>
<em>completion</em>
<ul>
	<li><a 
href="#event.name-8">event.name</a></li>
</ul>
<br>
<em>enterFrame</em>
<ul>
	<li><a 
href="#event.name">event.name</a></li>
	<li><a 
href="#event.time">event.time</a></li>
</ul>
<br>
<em>heading (compass)</em>
<ul>
	<li><a 
href="#event.name-7">event.name</a></li>
	<li><a 
href="#event.geographic">event.geographic</a></li>
	<li><a 
href="#event.magnetic">event.magnetic</a></li>
</ul>
<br>
<em>location (GPS)</em>
<ul>
	<li><a 
href="#event.name-5">event.name</a></li>
	<li><a 
href="#event.latitude">event.latitude</a></li>
	<li><a 
href="#event.longitude">event.longitude</a></li>
	<li><a 
href="#event.altitude">event.altitude</a></li>
	<li><a 
href="#event.accuracy">event.accuracy</a></li>
	<li><a 
href="#event.speed">event.speed</a></li>
	<li><a 
href="#event.direction">event.direction</a></li>
	<li><a 
href="#event.time-6">event.time</a></li>
	<li><a 
href="#event.errorMessage">event.errorMessage</a></li>
	<li><a 
href="#event.errorCode">event.errorCode</a></li>
</ul>
<br>
<em>orientation</em>
<ul>
	<li><a 
href="#event.name-2">event.name</a></li>
	<li><a 
href="#event.type-3">event.type</a></li>
	<li><a 
href="#event.delta">event.delta</a></li>
</ul>
<br>
<em>system</em>
<ul>
	<li><a 
href="#event.name-1">event.name</a></li>
	<li><a 
href="#event.type">event.type</a></li>
</ul>
<br>
<em>timer</em>
<ul>
	<li><a 
href="#event.name-9">event.name</a></li>
	<li><a 
href="#event.source">event.source</a></li>
	<li><a 
href="#event.count">event.count</a></li>
	<li><a 
href="#event.time-10">event.time</a></li>
</ul>
<br>
<em>touch</em>
<ul>
	<li><a 
href="#event.x">event.x</a></li>
	<li><a 
href="#event.y">event.y</a></li>
	<li><a 
href="#event.xStart">event.xStart</a></li>
	<li><a 
href="#event.yStart">event.yStart</a></li>
	<li><a 
href="#event.phase">event.phase</a></li>
	<li><a 
href="#event.id">event.id</a></li>
	<li><a 
href="#event.time-14">event.time</a></li>
</ul>
<br>
<em>urlRequest</em>
<ul>
	<li><a 
href="#event.name-11">event.name</a></li>
	<li><a 
href="#event.url">event.url</a></li>
	<li><a 
href="#event.errorMessage-12">event.errorMessage</a></li>
	<li><a 
href="#event.errorCode-13">event.errorCode</a></li>
</ul>
<br>

</div>

<div class="col2">
<h5 id="Animation">Animation</h5>
<hr>
<em>Transitions</em>
<ul>
  <li><a 
href="#transition.to_target_params_">transition.to
 ( )</a></li>
  <li><a 
href="#transition.from_target_params_">transition.from
 ( )</a></li>
</ul>
<br>

<em>Easing</em>
<ul>
  <li><a 
href="#easing.linear_t_tMax_start_delta_">easing.linear
 ( )</a></li>
  <li><a 
href="#easing.inQuad_t_tMax_start_delta_">easing.inQuad
 ( )</a></li>
  <li><a 
href="#easing.outQuad_t_tMax_start_delta_">easing.outQuad
  ( )</a></li>
  <li><a 
href="#easing.inOutQuad_t_tMax_start_delta_">easing.inOutQuad
 ( )</a></li>
  <li><a 
href="#easing.inExpo_t_tMax_start_delta_">easing.inExpo
 ( )</a></li>
  <li><a 
href="#easing.outExpo_t_tMax_start_delta_">easing.outExpo
 ( )</a></li>
  <li><a 
href="#easing.inOutExpo_t_tMax_start_delta_">easing.inOutExpo
 ( )</a></li>
</ul>
<br>

<em>Movieclips</em>
<ul>
  <li><a 
href="#movieclip.newAnim_frames_">movieclip.newAnim
 ( )</a></li>
  <li><a 
href="#object:play">object:play
 ( )</a></li>
  <li><a 
href="#object:play_startFramea_endFrameb_loopc_removeshouldRemove_">object:play
 ( )</a></li>
  <li><a 
href="#object:reverse">object:reverse
 ( )</a></li>
  <li><a 
href="#object:reverse_startFramea_endFrameb_loopc_removeshouldRemove_">object:reverse
 ( )</a></li>
  <li><a 
href="#object:nextFrame">object:nextFrame
 ( )</a></li>
  <li><a 
href="#object:previousFrame">object:previousFrame
 ( )</a></li>
  <li><a 
href="#object:stop">object:stop
 ( )</a></li>
  <li><a 
href="#object:stopAtFrame_frame_">object:stopAtFrame
 ( )</a></li>
  <li><a 
href="#object:setLabels_labels_">object:setLabels
 ( )</a></li>
  <li><a 
href="#object:setDrag">object:setDrag
 ( )</a></li>
</ul>

<h5 id="Multimedia">Multimedia</h5>
<hr>
<ul>
  <li><a 
href="#media.newEventSound_soundFile_">media.newEventSound
 ( )</a></li>
  <li><a 
href="#media.playEventSound_sound_">media.playEventSound
 ( )</a></li>
  <li><a 
href="#media.playSound_soundFile_">media.playSound
 ( )</a></li>
  <li><a 
href="#media.pauseSound">media.pauseSound
 ( )</a></li>
  <li><a 
href="#media.stopSound">media.stopSound
 ( )</a></li>
  <li><a 
href="#media.playVideo_path_baseSource_showControls_listener_">media.playVideo
 ( )</a></li>
  <li><a 
href="#media.show_imageSource_listener_">media.show
 ( )</a></li>
</ul>

<h5 id="Native_UI">Native UI</h5>
<hr>
<ul>
  <li><a 
href="#native.setActivityIndicator_">native.setActivityIndicator
 ( )</a></li>
  <li><a 
href="#native.showAlert_">native.showAlert
 ( )</a></li>
  <li><a 
href="#native.cancelAlert_">native.cancelAlert
 ( )</a></li>
  <li><a 
href="#native.newFont_">native.newFont
 ( )</a></li>
  <li><a 
href="#native.getFontNames">native.getFontNames
 ( )</a></li>
  <li><a 
href="#native.setKeyboardFocus_">native.setKeyboardFocus
  ( )</a></li>
</ul>
<br>
<em>Input Text Fields</em>
<ul>
  <li><a 
href="#native.newTextField_">native.newTextField
  ( )</a></li>
  <li><a 
href="#object.align">object.align</a></li>
  <li><a 
href="#object.font">object.font</a></li>
  <li><a 
href="#object.isSecure">object.isSecure</a></li>
  <li><a 
href="#object.size">object.size</a></li>
  <li><a 
href="#object.text">object.text</a></li>
  <li><a 
href="#object:setTextColor_">object:setTextColor
 ( )</a></li>
</ul>
<br>
<em>Input Text Boxes</em>
<ul>
  <li><a 
href="#native.newTextBox_">native.newTextBox
  ( )</a>
  </li><li><a 
href="#object.align_">object.align</a></li>
  <li><a 
href="#object.font_">object.font</a></li>
  <li><a 
href="#object.hasBackground">object.hasBackground</a></li>
  <li><a 
href="#object.size-1">object.size</a></li>
  <li><a 
href="#object.text_">object.text</a></li>
  <li><a 
href="#object:setTextColor_-2">object:setTextColor
 ( )</a></li>
</ul>
<br>
<em>Web Popups</em>
<ul>
  <li><a 
href="#native.showWebPopup_">native.showWebPopup
  ( )</a></li>
  <li><a 
href="#native.cancelWebPopup">native.cancelWebPopup
  ( )</a></li>
  <li><a 
href="#object.baseUrl_">object.baseUrl</a></li>
  <li><a 
href="#object.hasBackground_">object.hasBackground</a></li>
  <li><a 
href="#object.urlRequest">object.urlRequest</a></li>
</ul>

<h5 id="Box2D_Physics">Box2D Physics</h5>
<hr>
<em>Bodies</em>
<ul>
	<li><a 
href="#physics.addBody">physics.addBody
 ( )</a></li>
  	<li><a 
href="#body.isAwake">body.isAwake</a></li>
	<li><a 
href="#body.isBodyActive">body.isBodyActive</a></li>
	<li><a 
href="#body.isBullet">body.isBullet</a></li>
	<li><a 
href="#body.isSleepingAllowed">body.isSleepingAllowed</a></li>
	<li><a 
href="#body.isFixedRotation">body.isFixedRotation</a></li>
	<li><a 
href="#body.angularVelocity">body.angularVelocity</a></li>
	<li><a 
href="#body.linearDamping">body.linearDamping</a></li>
	<li><a 
href="#body.angularDamping">body.angularDamping</a></li>
	<li><a 
href="#body.bodyType">body.bodyType</a></li>
	<li><a 
href="#body:setLinearVelocity">body:setLinearVelocity
 ( )</a></li>
	<li><a 
href="#body:getLinearVelocity">body:getLinearVelocity
 ( )</a></li>
	<li><a 
href="#body:applyForce">body:applyForce
 ( )</a></li>
	<li><a 
href="#body:applyTorque">body:applyTorque
 ( )</a></li>
	<li><a 
href="#body:applyLinearImpulse">body:applyLinearImpulse
 ( )</a></li>
	<li><a 
href="#body:applyAngularImpulse">body:applyAngularImpulse
 ( )</a></li>
	<li><a 
href="#body:resetMassData">body:resetMassData
 ( )</a></li>
</ul>

<br>
<em>Joints</em>
<ul>
	<li><a 
href="#Joints">physics.newJoint
 ( )</a></li>
	<li><a 
href="#Common_features_of_all_joints">joint:getAnchorA
 ( )</a></li>
  	<li><a 
href="#Common_features_of_all_joints">joint:getAnchorB
 ( )</a></li>
    <li><a 
href="#Common_features_of_all_joints">joint:getReactionForce
 ( )</a></li>
    <li><a 
href="#Destroying_joints">joint:removeSelf
 ( )</a></li>
</ul>
<br>
<em>Pivot joint</em>
<ul>
	<li><a 
href="#Pivot_joint">joint.isMotorEnabled</a></li>
 	<li><a 
href="#Pivot_joint">joint.motorSpeed</a></li>
    <li><a 
href="#Pivot_joint">joint.motorTorque</a></li>
	<li><a 
href="#Pivot_joint">joint.maxMotorTorque</a></li>
	<li><a 
href="#Pivot_joint">joint.isLimitEnabled</a></li>
	<li><a 
href="#Pivot_joint">joint:setRotationLimits
 ( )</a></li>
	<li><a 
href="#Pivot_joint">joint:getRotationLimits
 ( )</a></li>
	<li><a 
href="#Pivot_joint">joint.jointAngle</a></li>
    <li><a 
href="#Pivot_joint">joint.jointSpeed</a></li>
        
</ul>
<br>
<em>Distance joint</em>
<ul>
	<li><a 
href="#Distance_joint">joint.length</a></li>
    <li><a 
href="#Distance_joint">joint.frequency</a></li>
    <li><a 
href="#Distance_joint">joint.dampingRatio</a></li>
</ul>
<br>
<em>Piston joint</em>
<ul>
	<li><a 
href="#Piston_joint">joint.isMotorEnabled</a></li>
    <li><a 
href="#Piston_joint">joint.motorSpeed</a></li>
    <li><a 
href="#Piston_joint">joint.motorForce</a></li>
    <li><a 
href="#Piston_joint">joint.maxMotorForce</a></li>
    <li><a 
href="#Piston_joint">joint.isLimitEnabled</a></li>
    <li><a 
href="#Piston_joint">joint:setLimits
 ( )</a></li>
    <li><a 
href="#Piston_joint">joint:getLimits
 ( )</a></li>
    <li><a 
href="#Piston_joint">joint.jointTranslation</a></li>
    <li><a 
href="#Piston_joint">joint.jointSpeed</a></li>
</ul>
<br>
<em>Friction joint</em>
<ul>
	<li><a 
href="#Friction_joint">joint.maxForce</a></li>
    <li><a 
href="#Friction_joint">joint.maxTorque</a></li>
</ul>
<br>
<em>Wheel joint</em>
<ul>
	<li><a 
href="#Wheel_joint">joint.isMotorEnabled</a></li>
    <li><a 
href="#Wheel_joint">joint.motorSpeed</a></li>
    <li><a 
href="#Wheel_joint">joint.motorForce</a></li>
    <li><a 
href="#Wheel_joint">joint.maxMotorForce</a></li>
    <li><a 
href="#Wheel_joint">joint.isLimitEnabled</a></li>
    <li><a 
href="#Wheel_joint">joint:setLimits
 ( )</a></li>
    <li><a 
href="#Wheel_joint">joint:getLimits
 ( )</a></li>
    <li><a 
href="#Wheel_joint">joint.jointTranslation</a></li>
    <li><a 
href="#Wheel_joint">joint.jointSpeed</a></li>
</ul>
<br>
<em>Pulley joint</em>
<ul>
	<li><a 
href="#Pulley_joint">joint.length1</a></li>
    <li><a 
href="#Pulley_joint">joint.length2</a></li>
    <li><a 
href="#Pulley_joint">joint.ratio</a></li>
</ul>

<br>
<h5 id="Sprite_Sheets">Sprite Sheets</h5>
<hr>
<ul>
	<li><a 
href="#sprite.newSpriteSheet">sprite.newSpriteSheet
 ( )</a></li>
    <li><a 
href="#spriteSet_sprite.newSpriteSetspriteSheet_startFrame_frameCount">sprite.newSpriteSet
 ( )</a></li>
	<li><a 
href="#sprite.add_spriteSet_startFlying_startFrame_frameCount_time_loopCount_">sprite.add
 ( )</a></li>
	<li><a 
href="#si_sprite.newSprite_spriteSet_">spriteInstance.newSprite
 ( )</a></li>
	<li><a 
href="#si:preparesequence">spriteInstance:prepare
 ( )</a></li>
	<li><a 
href="#si:play">spriteInstance:play
 ( )</a></li>
	<li><a 
href="#si:pause">spriteInstance:pause
 ( )</a></li>
	<li><a 
href="#si:addListeneranimation_listener">spriteInstance:addListener
 ( )</a></li>
	<li><a 
href="#spriteSheet:dispose">spriteSheet:dispose
 ( )</a></li>
	<li><a 
href="#Sprite_properties">spriteInstance.animating</a></li>
    <li><a 
href="#Sprite_properties">spriteInstance.currentFrame</a></li>
    <li><a 
href="#Sprite_properties">spriteInstance.sequence</a></li>
    <li><a 
href="#Sprite_properties">spriteInstance.sequences</a></li>
 </ul>
 
<br>
<h5 id="OpenFeint">OpenFeint</h5>
<hr>
<ul>
	<li><a 
href="#openfeint.init_OpenFeint_Product_Key_OpenFeint_Product_Secret_Display_Name_">openfeint.init
 ( )</a></li>
	<li><a 
href="#openfeint.launchDashboard">openfeint.launchDashboard
 ( )</a></li>
	<li><a 
href="#openfeint.unlockAchievement_achievementId_">openfeint.unlockAchievement
 ( )</a></li>
	<li><a 
href="#openfeint.setHighScore_leaderboardId_score_">openfeint.setHighScore
 ( )</a></li>
	<li><a 
href="#Network_Save_Card">openfeint.uploadBlob
 ( )</a></li>
    <li><a 
href="#Network_Save_Card">openfeint.downloadBlob
 ( )</a></li>
</ul>

</div>


<div class="col3 last">

<h5 id="Basic_Functions">Basic Functions</h5>
<hr>
<ul>
  <li><a 
href="#assert_v_message">assert(
 )</a></li>
  <li><a 
href="#error_message_level">error
 ( )</a></li>
  <li><a 
href="#G">_G</a></li>
  <li><a 
href="#getfenv_f">getfenv
 ( )</a></li>
  <li><a 
href="#getmetatable_object">getmetatable
 ( )</a></li>
  <li><a 
href="#ipairs_t">ipairs
 ( )</a></li>
  <li><a 
href="#next_table_index">next
 ( )</a></li>
  <li><a 
href="#pairs_t">pairs
 ( )</a></li>
  <li><a 
href="#pcall_f_arg1_...">pcall
 ( )</a></li>
  <li><a 
href="#print_...">print
 ( )</a></li>
  <li><a 
href="#rawequal_v1_v2">rawequal
 ( )</a></li>
  <li><a 
href="#rawget_table_index">rawget
 ( )</a></li>
  <li><a 
href="#rawset_table_index_value">rawset
 ( )</a></li>
  <li><a 
href="#select_index_...">select
 ( )</a></li>
  <li><a 
href="#setfenv_f_table">setfenv
 ( )</a></li>
  <li><a 
href="#setmetatable_table_metatable">setmetatable
 ( )</a></li>
  <li><a 
href="#tonumber_e_base">tonumber
 ( )</a></li>
  <li><a 
href="#tostring_e">tostring
 ( )</a></li>
  <li><a 
href="#type_v">type
 ( )</a></li>
  <li><a 
href="#unpack_list_i_j">unpack
 ( )</a></li>
</ul>

<h5 id="Arrays">Arrays</h5>
<hr>
<ul>
  <li><a 
href="#table.concat_table_sep_i_j">table.concat
 ( )</a></li>
  <li><a 
href="#table.insert_table_pos_value">table.insert
 ( )</a></li>
  <li><a 
href="#table.maxn_table">table.maxn
 ( )</a></li>
  <li><a 
href="#table.remove_table_pos">table.remove
 ( )</a></li>
  <li><a 
href="#table.sort_table_comp">table.sort
 ( )</a></li>
</ul>

<h5 id="Crypto">Crypto</h5>
<hr>
<ul>
  <li><a 
href="#crypto.digest_algorithm_string_raw_">crypto.digest
 ( )</a></li>
  <li><a 
href="#crypto.hmac_algorithm_string_key_raw_">crypto.hmac
 ( )</a>
  </li><li><a 
href="#crypto.md4">crypto.md4</a></li>
  <li><a 
href="#crypto.md5">crypto.md5</a></li>
  <li><a 
href="#crypto.sha1">crypto.sha1</a></li>
  <li><a 
href="#crypto.sha224">crypto.sha224</a></li>
  <li><a 
href="#crypto.sha256">crypto.sha256</a></li>
  <li><a 
href="#crypto.sha384">crypto.sha384</a></li>
  <li><a 
href="#crypto.sha512">crypto.sha512</a></li>
</ul>

<h5 id="Database">Database</h5>
<hr>
<ul>
  <li><a href="http://luasqlite.luaforge.net/lsqlite3.html">luasqlite</a></li>
</ul>

<h5 id="File_IO">File I/O</h5>
<hr>
<em>Implicit file manipulation</em>
<ul>
  <li><a 
href="#io.close_file">io.close
 ( )</a></li>
  <li><a href="#io.flush_">io.flush
 ( )</a></li>
  <li><a 
href="#io.input_file">io.input
 ( )</a></li>
  <li><a 
href="#io.lines_filename">io.lines
 ( )</a></li>
  <li><a 
href="#io.open_filename_mode">io.open
 ( )</a></li>
  <li><a 
href="#io.output_file">io.output
 ( )</a></li>
  <li><a 
href="#io.popen_prog_mode">io.popen
 ( )</a></li>
  <li><a 
href="#io.read_...">io.read
 ( )</a></li>
  <li><a 
href="#io.tmpfile_">io.tmpfile
 ( )</a></li>
  <li><a 
href="#io.type_obj">io.type
 ( )</a></li>
  <li><a 
href="#io.write_...">io.write
 ( )</a></li>
</ul>
<br>
<em>Explicit file manipulation</em>
<ul>
  <li><a 
href="#file:close_">file:close
 ( )</a></li>
  <li><a 
href="#file:flush_">file:flush
 ( )</a></li>
  <li><a 
href="#file:lines_">file:lines
 ( )</a></li>
  <li><a 
href="#file:read_...">file:read
 ( )</a></li>
  <li><a 
href="#file:seek_whence_offset">file:seek
 ( )</a></li>
  <li><a 
href="#file:setvbuf_mode_size">file:setvbuf
 (  )</a></li>
  <li><a 
href="#file:write_...">file:write
 ( )</a></li>
</ul>

<h5 id="Math">Math</h5>
<hr>
<ul>
  <li><a href="#math.abs_x">math.abs
 ( )</a></li>
  <li><a 
href="#math.acos_x">math.acos
 ( )</a></li>
  <li><a 
href="#math.asin_x">math.asin
 ( )</a></li>
  <li><a 
href="#math.atan_x">math.atan
 ( )</a></li>
  <li><a 
href="#math.atan2_y_x">math.atan2
 ( )</a></li>
  <li><a 
href="#math.ceil_x">math.ceil
 ( )</a></li>
  <li><a href="#math.cos_x">math.cos
 ( )</a></li>
  <li><a 
href="#math.cosh_x">math.cosh
 ( )</a></li>
  <li><a href="#math.deg_x">math.deg
 ( )</a></li>
  <li><a href="#math.exp_x">math.exp
 ( )</a></li>
  <li><a 
href="#math.floor_x">math.floor
 ( )</a></li>
  <li><a 
href="#math.fmod_x_y">math.fmod
 ( )</a></li>
  <li><a 
href="#math.frexp_x">math.frexp
 ( )</a></li>
  <li><a href="#math.huge">math.huge</a></li>
  <li><a 
href="#math.ldexp_m_e">math.ldexp
 ( )</a></li>
  <li><a href="#math.log_x">math.log
 ( )</a></li>
  <li><a 
href="#math.log10_x">math.log10
 ( )</a></li>
  <li><a 
href="#math.max_x_...">math.max
 ( )</a></li>
  <li><a 
href="#math.min_x_...">math.min
 ( )</a></li>
  <li><a 
href="#math.modf_x">math.modf
 ( )</a></li>
  <li><a href="#math.pi">math.pi</a></li>
  <li><a 
href="#math.pow_x_y">math.pow
 ( )</a></li>
  <li><a href="#math.rad_x">math.rad
 ( )</a></li>
  <li><a 
href="#math.random_m_n">math.random
 ( )</a></li>
  <li><a 
href="#math.randomseed_x">math.randomseed
 ( )</a></li>
  <li><a href="#math.sin_x">math.sin
 ( )</a></li>
  <li><a 
href="#math.sinh_x">math.sinh
 ( )</a></li>
  <li><a 
href="#math.sqrt_x">math.sqrt
 ( )</a></li>
  <li><a href="#math.tan_x">math.tan
 ( )</a></li>
  <li><a 
href="#math.tanh_x">math.tanh
 ( )</a></li>
</ul>

<h5 id="Modules_and_Packages">Modules and Packages</h5>
<hr>
<ul>
  <li><a 
href="#module_name_">module
 ( )</a></li>
  <li><a 
href="#require_modname">require
 ( )</a></li>
  <li><a 
href="#package.loaded">package.loaded</a></li>
  <li><a 
href="#package.loaders">package.loaders</a></li>
  <li><a 
href="#package.seeall_module">package.seeall
 ( )</a></li>
</ul>

<h5 id="Network">Network</h5>
<hr>
<ul>
  <li><a 
href="http://www.tecgraf.puc-rio.br/%7Ediego/professional/luasocket/reference.html">luasocket</a></li>
</ul>

<h5 id="Operating_System_Facilities">Operating System Facilities</h5>
<hr>
<ul>
  <li><a 
href="#os.clock_">os.clock
 ( )</a></li>
  <li><a 
href="#os.date_format_time">os.date
 ( )</a></li>
  <li><a 
href="#os.difftime_t2_t1">os.difftime
 ( )</a></li>
  <li><a 
href="#os.exit_code_">os.exit
 ( )</a></li>
  <li><a 
href="#os.remove_filename">os.remove
 ( )</a></li>
  <li><a 
href="#os.rename_oldname_newname">os.rename
 ( )</a></li>
  <li><a 
href="#os.time_table">os.time
 ( )</a></li>
</ul>

<h5 id="Strings">Strings</h5>
<hr>
<ul>
  <li><a 
href="#string.byte_s_i_j">string.byte
 ( )</a></li>
  <li><a 
href="#string.char_...">string.char
 ( )</a></li>
  <li><a 
href="#string.find_s_pattern_init_plain">string.find
 ( )</a></li>
  <li><a 
href="#string.format_formatstring_...">string.format
 ( )</a></li>
  <li><a 
href="#string.gmatch_s_pattern">string.gmatch(
 )</a></li>
  <li><a 
href="#string.gsub_s_pattern_repl_n">string.gsub
 ( )</a></li>
  <li><a 
href="#string.len_s">string.len
 ( )</a></li>
  <li><a 
href="#string.lower_s">string.lower
 ( )</a></li>
  <li><a 
href="#string.match_s_pattern_init">string.match
 ( )</a></li>
  <li><a 
href="#string.rep_s_n">string.rep
 ( )</a></li>
  <li><a 
href="#string.reverse_s">string.reverse
 ( )</a></li>
  <li><a 
href="#string.sub_s_i_j">string.sub
 ( )</a></li>
  <li><a 
href="#string.upper_s">string.upper
 ( )</a></li>
</ul>

<h5 id="System">System</h5>
<hr>
<ul>
  <li><a 
href="#system.getPreference_category_name_">system.getPreference
 ( )</a></li>
  <li><a 
href="#system.getTimer_">system.getTimer
 ( ) </a></li>
  <li><a 
href="#system.openURL_url_">system.openURL
 ( )</a></li>
  <li><a 
href="#system.pathForFile_filename_baseDirectory_">system.pathForFile
 ( )</a></li>
  <li><a 
href="#system.setAccelerometerInterval_frequency_">system.setAccelerometerInterval
 ( )</a></li>
  <li><a 
href="#system.setIdleTimer_enabled_">system.setIdleTimer
 ( )</a></li>
  <li><a 
href="#system.setLocationAccuracy_distance_">system.setLocationAccuracy
 ( )</a></li>
  <li><a 
href="#system.setLocationThreshold_distance_">system.setLocationThreshold
 ( )</a></li>
  <li><a 
href="#system.vibrate">system.vibrate
 ( )</a></li>
</ul>

</div>
  <div id="node-931" class="section-2">
  <h1 class="book-heading">Lua: An Introduction</h1>
  <p>Corona uses a scripting language called Lua as its programming 
environment. </p>
<p>Lua is a programming language known for its speed and ease of use by 
non-programmers, and is commonly used in the game-development industry. 
The syntax is different from JavaScript, but both share many common 
semantics.</p>

<h3>Conventions</h3>

<p>Names (also called identifiers) in Lua can be any string of letters, 
digits, and underscores, not beginning with a digit. This coincides with
 the definition of names in most languages. (The definition of letter 
depends on the current locale: any character considered alphabetic by 
the current locale can be used in an identifier.) Identifiers are used 
to name variables and table fields.</p>
<p>The following keywords are reserved and cannot be used as names:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">and</span> &nbsp; &nbsp; &nbsp; <span class="kw1">break</span> &nbsp; &nbsp; <span class="kw1">do</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">else</span> &nbsp; &nbsp; &nbsp;<span class="kw1">elseif</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">end</span> &nbsp; &nbsp; &nbsp; <span class="kw1">false</span> &nbsp; &nbsp; <span class="kw1">for</span> &nbsp; &nbsp; &nbsp; <span class="kw1">function</span> &nbsp;<span class="kw1">if</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">in</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">local</span> &nbsp; &nbsp; <span class="kw1">nil</span> &nbsp; &nbsp; &nbsp; <span class="kw1">not</span> &nbsp; &nbsp; &nbsp; <span class="kw1">or</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">repeat</span> &nbsp; &nbsp;<span class="kw1">return</span> &nbsp; &nbsp;<span class="kw1">then</span> &nbsp; &nbsp; &nbsp;<span class="kw1">true</span> &nbsp; &nbsp; &nbsp;<span class="kw1">until</span> &nbsp; &nbsp; <span class="kw1">while</span></pre></div></div>
<p>Lua is a case-sensitive language: and is a reserved word, but And and
 AND are two different, valid names. As a convention, names starting 
with an underscore (such as _VERSION) are reserved for use by Corona.</p>
<p>Comments begin anywhere with a double hyphen (--) except inside a 
string. They run until the end of the line. Block comments are available
 as well. A common trick to comment out a block is to surround it with 
--[[ and --]]</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="coMULTI">--[[</span>
<span class="coMULTI">print( 10 ) &nbsp; &nbsp; &nbsp; -- no action (comment)</span>
<span class="coMULTI">--]]</span></pre></td></tr></tbody></table></div>

<p>To uncomment the code, add a single hyphen at the beginning of the 
first line:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="co1">---[[</span>
<span class="kw1">print</span><span class="br0">(</span> <span class="nu0">10</span> <span class="br0">)</span> &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 10</span>
<span class="co1">--]]</span></pre></td></tr></tbody></table></div>

<p>A numerical constant can be written with an optional decimal part and
 an optional decimal exponent. Lua also accepts integer hexadecimal 
constants, by prefixing them with 0x. Examples of valid numerical 
constants are</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="nu0">3</span> &nbsp; <span class="nu0">3.0</span> &nbsp; <span class="nu0">3.1416</span> &nbsp; 314.16e-2 &nbsp; 0.31416E1 &nbsp; 0xff &nbsp; 0x56</pre></div></div>

<h3>Types and Values</h3>

<p>Lua is a dynamically typed language. Unlike other languages, you do 
not need to declare the type of a variable; each value implicitly 
carries a type.</p>
<p>All values in Lua are first-class values. This means that all values 
can be stored in variables, passed as arguments to other functions, and 
returned as results.</p>
<p>The basic types that you’ll deal with are:</p>
<ul>
<li><strong>nil</strong>. Nil is a type with a single value, nil. By 
default, global variables are nil which means that they have not been 
assigned a value. This is analogous to <strong>null</strong> in 
JavaScript/ActionScript.</li>
<li><strong>boolean</strong>. The boolean type has two values, <strong>false</strong>
 and <strong>true</strong>. Note that in conditional expressions, e.g. 
if ( condition ), both <strong>false</strong> and <strong>nil</strong> 
evaluate as false; everything else evaluates as <strong>true</strong>.</li>
<li><strong>number</strong>. Represents real (double-precision 
floating-point) numbers.</li>
<li><strong>string</strong>. Represents arrays of characters (any 8-bit 
character, including embedded zeroes)</li>
<li><strong>function</strong>.</li>
<li><strong>table</strong>. Tables are the fundamental data structure in
 Lua. They implement an associative array which is just a fancy way of 
saying that the array can be indexed not just by numbers, but also by 
any other value of the language except nil. Typically, you would use a 
string as an index (see Properties).</li>
</ul>

<h4>Conversions between string and number</h4>
<p>Lua provides automatic conversion between string and number values at
 run time. Any arithmetic operation applied to a string tries to convert
 this string to a number, following the usual conversion rules. 
Conversely, whenever a number is used where a string is expected, the 
number is converted to a string, in a reasonable format. For complete 
control over how numbers are converted to strings, use the format 
function from the string library (see string.format).</p>

<h4>Objects</h4>
<p>Tables and functions are objects: variables do not actually contain 
these values, only references to them. Assignment, parameter passing, 
and function returns always manipulate references to such values; these 
operations do <strong>not</strong> imply any kind of copy. </p>

<h4>Tables</h4>
<p>Tables implement associative arrays, that is, arrays that can be 
indexed not only with numbers, but with any value (except nil). Tables 
can be heterogeneous; that is, they can contain values of all types 
(except nil). Tables are the sole data structuring mechanism in Lua; 
they can be used to represent ordinary arrays, symbol tables, sets, 
records, graphs, trees, etc. To represent records (a.k.a. properties), 
Lua uses the field name as an index. The language supports this 
representation by providing a.name as syntactic sugar for a["name"].</p>
<p>Like indices, the value of a table field can be of any type (except 
nil). In particular, because functions are first-class values, table 
fields can contain functions. Thus tables can also carry methods.</p>
<p>You can create tables using the table constructor which is written as
 {}:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp; &nbsp; t <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- create a table</span>
&nbsp; &nbsp; &nbsp; &nbsp; k <span class="sy0">=</span> <span class="st0">"x"</span>
&nbsp; &nbsp; &nbsp; &nbsp; t<span class="br0">[</span>k<span class="br0">]</span> <span class="sy0">=</span> <span class="nu0">3.14</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- new table entry, with key="x" and value=3.14</span>
&nbsp; &nbsp; &nbsp; &nbsp; t<span class="br0">[</span><span class="nu0">10</span><span class="br0">]</span> <span class="sy0">=</span> <span class="st0">"hi"</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- new table entry, with key=10 and value="hi"</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> t<span class="br0">[</span>k<span class="br0">]</span> <span class="br0">)</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 3.14</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> t<span class="br0">[</span><span class="st0">"x"</span><span class="br0">]</span> <span class="br0">)</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 3.14</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> t.x <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 3.14</span>
&nbsp; &nbsp; &nbsp; &nbsp; k<span class="sy0">=</span><span class="nu0">10</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> t<span class="br0">[</span>k<span class="br0">]</span> <span class="br0">)</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; "hi"</span></pre></td></tr></tbody></table></div>

<p>Note in the above example, the entry with field name "x" was accessed
 in two ways: as a property using the dot operator t.x (line 7) and as 
an array item using indexing t["x"] (line 6).</p>
<p>A common mistake is to confuse t.x with t[x]. The first is equivalent
 to t["x"], or in other words a table indexed by the string “x”. The 
second is a table indexed by the value of variable x.</p>

<h3>Variables</h3>
<p>Variables are places that store values. There are three kinds of 
variables in Lua: global variables, local variables, and table fields. 
Any non-initialized variable is nil by default.</p>

<h4>Global</h4>
<p>Global variables do not need declarations. You simply assign a value 
to one to create it:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">print</span><span class="br0">(</span> s <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; nil</span>
s <span class="sy0">=</span> <span class="st0">"One million dollars"</span>
<span class="kw1">print</span><span class="br0">(</span> s <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; "One million dollars"</span></pre></td></tr></tbody></table></div>

<p>Global variables live as long as your application is running. You can
 delete a global variable by assigning nil to it. At this point, the 
global variable behaves as if it were never initialized:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">s <span class="sy0">=</span> <span class="kw1">nil</span>
<span class="kw1">print</span><span class="br0">(</span> s <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; nil</span></pre></td></tr></tbody></table></div>

<h4>Local</h4>
<p>Local variables are declared using the local statement:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">x <span class="sy0">=</span> <span class="nu0">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- global variable</span>
<span class="kw1">local</span> y <span class="sy0">=</span> <span class="nu0">10</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- local variable</span></pre></td></tr></tbody></table></div>

<p>Unlike global variables, local variables are visible only in the 
block where they are declared. The scope of the local variable begins 
after the declaration and ends at the end of the block.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1">a <span class="sy0">=</span> <span class="nu0">10</span>
<span class="kw1">local</span> i <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">while</span> i <span class="sy0">&lt;=</span> <span class="nu0">10</span> <span class="kw1">do</span>
&nbsp; &nbsp;<span class="kw1">local</span> a <span class="sy0">=</span> i<span class="sy0">*</span>i&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- different variable 'a' local to while block</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> a <span class="br0">)</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 1, 4, 9, 16, 25, ...</span>
&nbsp; &nbsp;i <span class="sy0">=</span> i + <span class="nu0">1</span>
<span class="kw1">end</span>
&nbsp;
<span class="kw1">print</span><span class="br0">(</span> a <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 10 (the global 'a')</span></pre></td></tr></tbody></table></div>

<h4>Table fields (properties)</h4>
<p>Table fields are just the elements of the table themselves. You index
 into the array to assign the values to a field. When the index is a 
string, the field is known as a property (see also Properties):</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1">t <span class="sy0">=</span> <span class="br0">{</span> foo<span class="sy0">=</span><span class="st0">"hello"</span> <span class="br0">}</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- create table with a single property "foo"</span>
<span class="kw1">print</span><span class="br0">(</span> t.foo <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; "hello"</span>
t.foo <span class="sy0">=</span> <span class="st0">"bye"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- assign a new value to property "foo"</span>
<span class="kw1">print</span><span class="br0">(</span> t.foo <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; "bye"</span>
t.bar <span class="sy0">=</span> <span class="nu0">10</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; create a new property bar</span>
<span class="kw1">print</span><span class="br0">(</span> t.bar <span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 10</span>
<span class="kw1">print</span><span class="br0">(</span> t<span class="br0">[</span><span class="st0">"bar"</span><span class="br0">]</span> <span class="br0">)</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 10</span></pre></td></tr></tbody></table></div>

<h3>Expressions</h3>
<h4>Arithmetic Operators</h4>
<p>Lua supports the usual arithmetic operators: the binary + (addition),
 - (subtraction), * (multiplication), / (division), % (modulo), and ^ 
(exponentiation); and unary - (negation). If the operands are numbers, 
or strings that can be converted to numbers (see Conversions between 
string and number), then all operations have the usual meaning. 
Exponentiation works for any exponent. For instance, x^(-0.5) computes 
the inverse of the square root of x. Modulo is defined as</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; &nbsp; &nbsp;a <span class="sy0">%</span> b <span class="sy0">==</span> a - <span class="kw1">math.floor</span><span class="br0">(</span>a<span class="sy0">/</span>b<span class="br0">)</span><span class="sy0">*</span>b</pre></div></div>
<p>That is, it is the remainder of a division that rounds the quotient 
towards minus infinity.</p>
<h4>Relational Operators</h4>
<p>The relational operators in Lua are</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="sy0">==</span> &nbsp; &nbsp;~<span class="sy0">=</span> &nbsp; &nbsp;<span class="sy0">&lt;</span> &nbsp; &nbsp; <span class="sy0">&gt;</span> &nbsp; &nbsp; <span class="sy0">&lt;=</span> &nbsp; &nbsp;<span class="sy0">&gt;=</span></pre></div></div>
<p>These operators always result in <strong>false</strong> or <strong>true</strong>.</p>
<p>Equality (==) first compares the type of its operands. If the types 
are different, then the result is <strong>false</strong>. Otherwise, the
 values of the operands are compared. Numbers and strings are compared 
in the usual way. Objects (tables and functions) are compared by 
reference: two objects are considered equal only if they are the same 
object. Every time you create a new object (a table or function), this 
new object is different from any previously existing object.</p>
<p>The conversion rules of strings and numbers do not apply to equality 
comparisons. Thus, "0"==0 evaluates to <strong>false</strong>, and t[0] 
and t["0"] denote different entries in a table.</p>
<p>The operator ~= is exactly the negation of equality (==).</p>

<h4>Logical Operators</h4>
<p>The logical operators in Lua are and, or, and not. All logical 
operators consider both <strong>false</strong> and <strong>nil</strong> 
as <strong>false</strong> and anything else as <strong>true</strong>.</p>
<p>The negation operator not always returns <strong>false</strong> or <strong>true</strong>.
 The conjunction operator and returns its first argument if this value 
is <strong>false</strong> or <strong>nil</strong>; otherwise, and 
returns its second argument. The disjunction operator or returns its 
first argument if this value is different from <strong>nil</strong> and <strong>false</strong>;
 otherwise, or returns its second argument. Both and and or use 
short-cut evaluation; that is, the second operand is evaluated only if 
necessary. Here are some examples:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="nu0">10</span> <span class="kw1">or</span> <span class="nu0">20</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">--&gt; 10</span>
&nbsp; &nbsp; &nbsp;<span class="nu0">10</span> <span class="kw1">or</span> <span class="kw1">error</span><span class="br0">(</span><span class="br0">)</span> &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 10</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">nil</span> <span class="kw1">or</span> <span class="st0">"a"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">--&gt; "a"</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">nil</span> <span class="kw1">and</span> <span class="nu0">10</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">--&gt; nil</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">false</span> <span class="kw1">and</span> <span class="kw1">error</span><span class="br0">(</span><span class="br0">)</span> &nbsp; <span class="co1">--&gt; false</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">false</span> <span class="kw1">and</span> <span class="kw1">nil</span> &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; false</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">false</span> <span class="kw1">or</span> <span class="kw1">nil</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">--&gt; nil</span>
&nbsp; &nbsp; &nbsp;<span class="nu0">10</span> <span class="kw1">and</span> <span class="nu0">20</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">--&gt; 20</span></pre></div></div>

<h4>Concatenation</h4>
<p>The string concatenation operator in Lua is denoted by two dots 
('..'). If both operands are strings or numbers, then they are converted
 to strings.</p>

<h4>Length Operator</h4>
<p>The length operator is denoted by the unary operator #. The length of
 a string is its number of bytes (that is, the usual meaning of string 
length when each character is one byte).</p>
<p>The length of a table t is defined to be any integer index n such 
that t[n] is not <strong>nil</strong> and t[n+1] is <strong>nil</strong>;
 moreover, if t[1] is <strong>nil</strong>, n can be zero. For a regular
 array, with non-nil values from 1 to a given n, its length is exactly 
that n, the index of its last value. If the array has "holes" (that is, <strong>nil</strong>
 values between other non-nil values), then #t can be any of the indices
 that directly precedes a <strong>nil</strong> value (that is, it may 
consider any such <strong>nil</strong> value as the end of the array).</p>

<h4>Precedence</h4>
<p>Operator precedence in Lua follows the table below, from lower to 
higher priority:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">or</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">and</span>
&nbsp; &nbsp; &nbsp;<span class="sy0">&gt;</span> &nbsp; &nbsp; <span class="sy0">&lt;</span> &nbsp; &nbsp; <span class="sy0">&gt;=</span> &nbsp; &nbsp;<span class="sy0">&lt;=</span> &nbsp; &nbsp;~<span class="sy0">=</span> &nbsp; &nbsp;<span class="sy0">==</span>
&nbsp; &nbsp; &nbsp;..
&nbsp; &nbsp; &nbsp;+ &nbsp; &nbsp; -
&nbsp; &nbsp; &nbsp;<span class="sy0">*</span> &nbsp; &nbsp; <span class="sy0">/</span> &nbsp; &nbsp; <span class="sy0">%</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">not</span> &nbsp; # &nbsp; &nbsp; - <span class="br0">(</span>unary<span class="br0">)</span>
&nbsp; &nbsp; &nbsp;^</pre></div></div>
<p>As usual, you can use parentheses to change the precedences of an 
expression. The concatenation ('..') and exponentiation ('^') operators 
are right associative. All other binary operators are left associative.</p>

<h3>Properties</h3>
<p>Many Corona API’s return objects. You are free to manipulate the 
documented properties of these objects just like you would on a table. 
You can even add your own properties provided you do not prefix any of 
your custom properties with an underscore (“_”). Ansca reserves the 
right to use any property name that begins with an underscore. </p>
<p>Like most languages, all properties can be accessed via the dot (“.”)
 operator. It's really just a convenient way to index into a table. In 
other words, we can access property foo of a table t using the dot 
operator (t.foo) or index into it using a string (t["foo"]); the result 
is the same.</p>

<h3>Functions</h3>

<p>Because functions can be variables, a table can store them as 
properties. This creates allows for very flexible uses of a table. It 
can be used to logically group a family functions into a table, e.g. the
 math library. It can also be used to make a table have object methods 
(instance methods).</p>

<h4>Plain functions</h4>

<p>Plain functions are just what you expect. You provide some arguments 
as input, the function performs some task, and depending on the 
function, some result is returned. Most functions are stored in tables 
as properties. For example, to calculate the sine of 100, we would write
 math.sin(100). Here, math is merely a table. The property sin is the 
actual function. </p>
<p>All of the Ansca libraries such as the display library similarly 
group functions into tables.</p>

<h4>Object Methods</h4>

<p>Objects in Lua are represented by tables. Display objects 
(rectangles, images, etc.) and the global Runtime object are all 
examples of objects. Like the math library, these objects similarly 
store object methods (a.k.a. instance methods) as properties. One key 
difference, however, is syntax. You need to tell Lua that you intend 
this function to be called as an object method, not just a plain 
function. To do so, you need to use the colon (“:”) operator  instead of
 the dot (“.”) operator. This may be slightly different than what you 
are used to in other languages. Compare the syntax of Javascript and 
Lua:</p>

<table>
  <tbody><tr>
    <th scope="col">JavaScript</th>
    <th scope="col">Lua</th>
  </tr>
  <tr>
    <td><span class="geshifilter"><code class="lua geshifilter-lua">object.translate<span
 class="br0">(</span> <span class="nu0">10</span>, <span class="nu0">10</span>
 <span class="br0">)</span><span class="sy0">;</span></code></span></td>
    <td><span class="geshifilter"><code class="lua geshifilter-lua">object:translate<span
 class="br0">(</span> <span class="nu0">10</span>, <span class="nu0">10</span>
 <span class="br0">)</span></code></span></td>
  </tr>
</tbody></table>
<h4>Dot vs Colon</h4>
<p>What does the colon operator do? It is actually a shortcut. In most 
languages, an object method call is just like a plain function call 
except there's a hidden first argument to the function that is the 
object itself. This hidden argument is known as this in Javascript and 
self in Lua. Therefore, the colon operator is merely a shortcut to save 
you from extra typing. You could call an object method using the dot 
operator if you pass the object as the first argument:</p>

<table>
  <tbody><tr>
    <th scope="col">Object call with dot</th>
    <th scope="col">Object call with colon</th>
  </tr>
  <tr>
    <td><span class="geshifilter"><code class="lua geshifilter-lua">object.translate<span
 class="br0">(</span> object, <span class="nu0">10</span>, <span 
class="nu0">10</span> <span class="br0">)</span><span class="sy0">;</span></code></span></td>
    <td><span class="geshifilter"><code class="lua geshifilter-lua">object:translate<span
 class="br0">(</span> <span class="nu0">10</span>, <span class="nu0">10</span>
 <span class="br0">)</span></code></span></td>
  </tr>
</tbody></table>

<h3>Comparison with Other Languages</h3>

<p>If you have used other scripting languages, you should have no 
problem adjusting to Lua. </p>

<h4>Memory Allocation</h4>

<p>Devices have limited memory available for use, so care must be taken 
to ensure that the total memory footprint of your application is kept to
 a minimum. </p>
<p>To help you, Lua does automatic memory management. This means you can
 create tables, functions, etc. but there is no function to delete them.
 Instead, Lua automatically deletes them via garbage collection. It can 
even handle cyclic data structures. So most of the burdens of memory 
management such as dangling pointers and memory leaks are taken care of 
for you. </p>
<p>However, it is up to you to tell Lua what to consider garbage. For 
example, anything stored in a global variable is not considered garbage,
 even if your application never uses it again. Similarly, anything 
stored in a table or array will not be considered garbage. In both 
cases, it is up to you to assign nil to these positions. This ensures 
that their corresponding memory will not be locked and can be freed by 
the garbage collector.</p>
<p>For display objects in the display hierarchy, the situation is 
slightly different. In addition to nil'ing references to a display 
object, you must explicitly remove them from the display hierarchy 
before it can be considered garbage. </p>

<h4>Common Syntax Errors and Notable Syntax Differences</h4>

<p>Some differences in syntax between Lua and other languages are worth 
noting because they can help avoid compiler errors:</p>
<ul>
<li><strong>Semicolons</strong>. Whereas some languages require a 
trailing semicolon at the end of each statement (effectively a line of 
code), in Lua this is optional. </li>
<li><strong>Braces</strong>. You may be used to using { and } to define 
variable scope. In Lua, you can do this by bracketing the code with do 
and end. Braces in Lua are interpreted as table constructors</li>
<li><strong>If then else</strong>. If you come from C, Java, Javascript,
 etc., a common mistake you'll make in writing if and elseif statements 
is forgetting to append then to the end of the if/elseif test condition.
 Another common mistake is inadvertently using else if (note the space) 
when you really mean elseif.</li>
<li><strong>Arrays</strong>. In Lua, arrays are 1-based. Technically, 
you can index into an array starting with 0. However, all Lua and Ansca 
API's assume that the first element of table t is t[1] not t[0].</li>
<li><strong>? : (ternary operator)</strong>. Lua does not offer the 
equivalent to the C ternary operator a?b:c. The Lua idiom (a and b) or c
  (or simply a and b or c, because and has a higher precendence than or)
 offers a close approximation provided b is <strong>not</strong> false. 
For example, the Lua equivalent to max=(x&gt;y?x:y) would be max=(x&gt;y
 and x or y). <strong>Beware</strong> that this idiom fails to work if b
 is false.</li>
<li><strong>Multiple return values</strong>. An unconventional but 
useful feature in Lua is the ability for  function to return more than 
one result. </li>
<li><strong>Multiple Assignment</strong>. Multiple assignments offer a 
convenient way to swap values. The statement x,y=y,x will swap x for y 
and vice versa. </li>
</ul>
  </div>
<div id="node-1194" class="section-2">
  <h1 class="book-heading">Animation</h1>
  <h2 id="header-1"> </h2>

<p>One of the most powerful things about the Corona SDK is that any 
display object can be animated. This is a testament to the flexible 
graphics model that Corona offers.</p>
<p>Animations allow you to create visually-rich and engaging user 
experiences. Animations are accomplished by generating a sequence of 
frames that evolve smoothly from frame to frame. The term <i>tween</i> 
(short for inbetween) is a term describing the process in which such 
intermediate frames are generated. It is often used as shorthand to 
indicate that a property of an object will change during the animation, 
as in tweening the position.</p>

<h3 id="Transitions">Transitions</h3>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">transition</code></span>
 library allows you to easily create animations with only a single line 
of code by allowing you to tween one or more properties of a display 
object. For example, you can fadeout a display object by tweening its 
alpha property (the alpha property transitions from 1.0 to 0). </p>
<p>The simplest way to do this is to use the <span class="geshifilter"><code
 class="lua geshifilter-lua">transition.to</code></span> method which 
takes a display object as its first argument and a table containing the 
control parameters as its second. The control parameters specify the 
duration of the animation, an optional delay for when to start the 
animation, and the final values of properties for the display object. 
The intermediate values for a property are determined by an easing 
function that is also specified as a control parameter. By default this 
is a linear function. </p>
<p>Below are some examples of how to animate a square (see Transition2 
in the sample code):</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> square <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">100</span>, <span class="nu0">100</span> <span class="br0">)</span>
square:setFillColor<span class="br0">(</span> <span class="nu0">255</span>,<span class="nu0">255</span>,<span class="nu0">255</span> <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> w,h <span class="sy0">=</span> display.stageWidth, display.stageHeight
&nbsp;
<span class="kw1">local</span> square <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">100</span>, <span class="nu0">100</span> <span class="br0">)</span>
square:setFillColor<span class="br0">(</span> <span class="nu0">255</span>,<span class="nu0">255</span>,<span class="nu0">255</span> <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> w,h <span class="sy0">=</span> display.stageWidth, display.stageHeight
&nbsp;
<span class="co1">-- (1) move square to bottom right corner; subtract half side-length</span>
<span class="co1">-- &nbsp; &nbsp; b/c the local origin is at the square's center; fade out square</span>
transition.to<span class="br0">(</span> square, <span class="br0">{</span> <span class="kw1">time</span><span class="sy0">=</span><span class="nu0">1500</span>, alpha<span class="sy0">=</span><span class="nu0">0</span>, x<span class="sy0">=</span><span class="br0">(</span>w-<span class="nu0">50</span><span class="br0">)</span>, y<span class="sy0">=</span><span class="br0">(</span>h-<span class="nu0">50</span><span class="br0">)</span> <span class="br0">}</span> <span class="br0">)</span>
&nbsp;
<span class="co1">-- (2) fade square back in after 2.5 seconds</span>
transition.to<span class="br0">(</span> square, <span class="br0">{</span> <span class="kw1">time</span><span class="sy0">=</span><span class="nu0">500</span>, delay<span class="sy0">=</span><span class="nu0">2500</span>, alpha<span class="sy0">=</span><span class="nu0">1.0</span> <span class="br0">}</span> <span class="br0">)</span></pre></td></tr></tbody></table></div>

<p>In the first tween, notice that multiple values are changing: 
position and alpha. That’s because in the control parameters we 
specified the final values for the x, y, and alpha properties. For each 
property specified in the control parameters, the library looks at the 
current property value and gradually changes that property to the final 
value over the time period specified (1.5 seconds in this case).  In the
 last tween, we use the delay control parameter to start the tween after
 the initial tween’s fadeout is complete.</p>
<p>Note that the transition library operates in a <strong>time-based</strong>
 manner.</p>

<h4 id="transition.to_target_params_">transition.to( target, params )</h4>

<p>Returns a tween that animates properties in the display object target
 over time. The final property values are specified in the params table.
 To customize the tween, you can optionally specify the following 
non-animating properties in params:</p>
<ul>
<li>	<strong>params.time</strong> specifies the duration of the 
transition in milliseconds. By default, the duration is 500 ms (0.5 
seconds).</li>
<li>	<strong>params.transition</strong> is by default easing.linear . 
See <a href="#Easing">Easing</a> for more functions.</li>
<li>	<strong>params.delay</strong> specifies the delay (none by default)
 before the tween begins. </li>
<li>	<strong>params.delta</strong> is a boolean specifying whether 
non-control parameters are interpreted as final ending values or as 
changes in value. The default is <strong>nil</strong> meaning <strong>false</strong>.</li>
<li>	<strong>params.onStart</strong> is a function or table listener 
called before the tween begins. Table listeners must have an onStart 
method. When invoked, the listener is given target instead of an event.</li>
<li>	<strong>params.onComplete</strong> is a function or table listener 
called after the tween completes.</li>
</ul>

<h4 id="transition.from_target_params_">transition.from( target, params )</h4>

<p>Similar to <span class="geshifilter"><code class="lua 
geshifilter-lua">transition.to</code></span> except the starting 
property values are specified in the params table and the final values 
are the corresponding property values in target prior to the call.</p>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">transition</code></span>
 library eliminates the need for manually animating objects. Compare the
 following code that causes a white rectangle to fade out in 1 second:</p>

<table align="center" width="90%" cellspacing="0" cellpadding="0" 
border="1">
<tbody><tr>
<th>Manual animation</th>
<th>Using transition</th>
</tr>
<tr>
<td><div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> rect <span class="sy0">=</span> display.newRect<span class="br0">(</span>
&nbsp; <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">100</span>, <span class="nu0">100</span> <span class="br0">)</span>
rect:setFillColor<span class="br0">(</span><span class="nu0">255</span>,<span class="nu0">255</span>,<span class="nu0">255</span><span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> tMax <span class="sy0">=</span><span class="nu0">1000</span>+system.getTimer<span class="br0">(</span><span class="br0">)</span>
<span class="kw1">local</span> <span class="kw1">function</span> fadeOut<span class="br0">(</span>event<span class="br0">)</span>
&nbsp; <span class="kw1">local</span> t <span class="sy0">=</span> event.<span class="kw1">time</span>
&nbsp; <span class="kw1">local</span> rect <span class="sy0">=</span> event.target
&nbsp; <span class="kw1">if</span> t <span class="sy0">&lt;</span> tMax <span class="kw1">then</span>
&nbsp; &nbsp; rect.alpha <span class="sy0">=</span> <span class="nu0">1</span> - t<span class="sy0">/</span>tMax
&nbsp; <span class="kw1">else</span>
&nbsp; &nbsp; rect.alpha <span class="sy0">=</span> <span class="nu0">0</span>
&nbsp; &nbsp; <span class="co1">-- done, so remove listener</span>
&nbsp; &nbsp; Runtime:removeEventListener<span class="br0">(</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="st0">"enterFrame"</span>, fadeOut <span class="br0">)</span>
&nbsp; <span class="kw1">end</span>
<span class="kw1">end</span>
&nbsp;
<span class="co1">-- Add listener to begin animation</span>
Runtime:addEventListener<span class="br0">(</span>
&nbsp; &nbsp;<span class="st0">"enterFrame"</span>, fadeOut <span class="br0">)</span></pre></div></div></td>
   
<td>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> rect <span class="sy0">=</span> display.newRect<span class="br0">(</span>
&nbsp; <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">100</span>, <span class="nu0">100</span> <span class="br0">)</span>
rect:setFillColor<span class="br0">(</span><span class="nu0">255</span>,<span class="nu0">255</span>,<span class="nu0">255</span><span class="br0">)</span>
&nbsp;
transition.to<span class="br0">(</span>
&nbsp; rect, <span class="br0">{</span><span class="kw1">time</span><span class="sy0">=</span><span class="nu0">1000</span>, alpha<span class="sy0">=</span><span class="nu0">0</span><span class="br0">}</span><span class="br0">)</span></pre></div></div>
</td>
</tr>
</tbody></table>

<dl>
<dt><strong>transition.cancel( tween )</strong></dt><dd>Cancels the 
tween.</dd>
<dt><strong>transition.dissolve( src, dst, duration, delayDuration )</strong></dt><dd></dd>
</dl>


<h3 id="Easing">Easing</h3>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">easing</code></span>
 library is a collection of interpolation functions used by the 
transition library:</p>

<dl>
<dt><h5 id="easing.linear_t_tMax_start_delta_">easing.linear( t, tMax, 
start, delta )</h5></dt><dd></dd>
<dt><h5 id="easing.inQuad_t_tMax_start_delta_">easing.inQuad( t, tMax, 
start, delta )</h5></dt><dd></dd>
<dt><h5 id="easing.outQuad_t_tMax_start_delta_">easing.outQuad( t, tMax,
 start, delta )</h5></dt><dd></dd>
<dt><h5 id="easing.inOutQuad_t_tMax_start_delta_">easing.inOutQuad( t, 
tMax, start, delta )</h5></dt><dd></dd>
<dt><h5 id="easing.inExpo_t_tMax_start_delta_">easing.inExpo( t, tMax, 
start, delta )</h5></dt><dd></dd>
<dt><h5 id="easing.outExpo_t_tMax_start_delta_">easing.outExpo( t, tMax,
 start, delta )</h5></dt><dd></dd>
<dt><h5 id="easing.inOutExpo_t_tMax_start_delta_">easing.inOutExpo( t, 
tMax, start, delta )</h5></dt><dd></dd>
</dl>
<p>You can create your own easing function to interpolate between a 
start and a final value. The arguments of the function are defined as:</p>
<dl>
<dt><strong>t</strong></dt><dd> is the time since the transition started</dd>
<dt><strong>tMax</strong></dt><dd> is the duration of the transition</dd>
<dt><strong>start</strong></dt><dd> is the starting value</dd>
<dt><strong>delta</strong></dt><dd> is the change in value (final value =
 start + delta)</dd>
</dl>

<h3 id="Movieclips">Movieclips</h3>

<p>The external <span class="geshifilter"><code class="lua 
geshifilter-lua">movieclip</code></span> library allows you to create 
animated sprites (sometimes called “movieclips”) from sequences of 
images, which can then be moved around the screen using the same 
techniques as any other Corona display object. Functions are available 
to play these animation frames, or partial sequences of these frames, in
 either the forward or reverse direction; to jump to specified frames; 
to skip to the next or previous frame; to automatically delete the 
animation on completion of a sequence; and to make the animation 
draggable, complete with press, drag, and release events. </p>
<p>This framework provides an quick and lightweight way to create 
animations, and also helps when porting existing Flash content to 
Corona.</p>
<p>The movieclip library is an external module, <span 
class="geshifilter"><code class="lua geshifilter-lua">movieclip.lua</code></span>,
 that can be included with your projects and loaded using the <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">require</span></code></span>
 command (see <a 
href="http://developer.anscamobile.com/lua-standard-libraries#Loading_external_libraries">Loading
 external libraries</a> for further details on require). </p>
<p>Note that while this library is based on the older <span 
class="geshifilter"><code class="lua geshifilter-lua">sprite</code></span>
 library, the library name has been changed to <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="st0">"movieclip"</span></code></span>,
 because the name <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"sprite"</span></code></span> is now 
reserved for the upcoming sprite-sheet feature in <strong>Corona Game 
Edition</strong>. A discussion of the differences is below.</p>
<p>For a sample project using the <span class="geshifilter"><code 
class="lua geshifilter-lua">movieclip</code></span> library, see the <strong>Graphics/Movieclip</strong>
 project in the Sample Code directory of the Corona SDK, or in the 
Sample Code section of the Ansca Mobile website.</p>

<h4 id="Movieclip_functions">Movieclip functions</h4>


<h5 id="movieclip.newAnim_frames_">movieclip.newAnim( frames )</h5>

<p>Creates an animated sprite using an array of image filenames provided
 in the frames table:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myAnim <span class="sy0">=</span> movieclip.newAnim<span class="br0">{</span> <span class="st0">"img1.png"</span>, <span class="st0">"img2.png"</span>, <span class="st0">"img3.png"</span>, <span class="st0">"img4.png"</span> <span class="br0">}</span></pre></div></div>

<h5 id="object:play">object:play()</h5>

<p>Starts the animated sprite playing in the forward direction. When the
 end of the image set is reached, it will cycle back to the first image 
and continue playing. If a specific frame sequence has already been 
constructed, calling <span class="geshifilter"><code class="lua 
geshifilter-lua">play<span class="br0">(</span><span class="br0">)</span></code></span>
 with no parameters will simply resume playing within that sequence.</p>

<h5 id="object:play_startFramea_endFrameb_loopc_removeshouldRemove_">object:play{
 startFrame=a, endFrame=b, loop=c, remove=shouldRemove }</h5>

<p>Starts the animated sprite playing in the forward direction. When the
 frame of number given by <span class="geshifilter"><code class="lua 
geshifilter-lua">endFrame</code></span> is reached, it will cycle back 
to the frame number given by <span class="geshifilter"><code class="lua 
geshifilter-lua">startFrame</code></span> and continue playing.</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myAnim:play<span class="br0">{</span> startFrame<span class="sy0">=</span><span class="nu0">1</span>, endFrame<span class="sy0">=</span><span class="nu0">6</span>, loop<span class="sy0">=</span><span class="nu0">3</span>, <span class="kw1">remove</span><span class="sy0">=</span><span class="kw1">true</span> <span class="br0">}</span></pre></div></div>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">loop</code></span>
 parameter accepts a number of times to loop the sequence, with zero 
(the default) indicating that it should loop forever.</p>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="kw1">remove</span></code></span> parameter is a boolean flag, 
and if set to <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">true</span></code></span>, the 
movieclip will automatically delete itself when the given sequence is 
complete. This is useful for things like animated explosions and other 
single-use cases. Note that the object will only be garbage-collected if
 there are no other remaining references to it in your Lua code. The 
default value is <strong>false</strong>.</p>

<p>All parameters are optional, but startFrame and endFrame will default
 to the first and last images provided in <span class="geshifilter"><code
 class="lua geshifilter-lua">newAnim<span class="br0">(</span><span 
class="br0">)</span></code></span>, so it is a good practice to provide 
both values explicitly to avoid unexpected behavior.</p>
<p>Passing any parameters to <span class="geshifilter"><code class="lua 
geshifilter-lua">play<span class="br0">(</span><span class="br0">)</span></code></span>
 indicates that a new sequence should be constructed, and any current 
sequence information will be reset. Call <span class="geshifilter"><code
 class="lua geshifilter-lua">play<span class="br0">(</span><span 
class="br0">)</span></code></span> with no parameters if you simply want
 to resume the current sequence.</p>

<h5 id="object:reverse">object:reverse()</h5>

<p>Starts the animated sprite playing in the reverse direction. When the
 beginning of the image set is reached, it will cycle back to the last 
image and continue playing backwards. If a specific frame sequence has 
already been constructed, calling <span class="geshifilter"><code 
class="lua geshifilter-lua">reverse<span class="br0">(</span><span 
class="br0">)</span></code></span> with no parameters will simply resume
 playing backwards within that sequence.</p>

<h5 id="object:reverse_startFramea_endFrameb_loopc_removeshouldRemove_">object:reverse{
 startFrame=a, endFrame=b, loop=c, remove=shouldRemove }</h5>

<p>Starts the animated sprite playing in the reverse direction. When the
 frame of number given by <span class="geshifilter"><code class="lua 
geshifilter-lua">endFrame</code></span> is reached, it will cycle back 
to the frame number given by <span class="geshifilter"><code class="lua 
geshifilter-lua">startFrame</code></span> and continue playing. </p>
<p>The <span class="geshifilter"><code class="lua geshifilter-lua">loop</code></span>
 parameter accepts a number of times to loop the sequence, with zero 
(the default) indicating that it should loop forever.</p>
<p>The <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="kw1">remove</span></code></span> parameter is a boolean flag, 
and if set to <strong>true</strong>, the movieclip will automatically 
delete itself when the given sequence is complete. This is useful for 
things like animated explosions and other single-use cases. Note that 
the object will only be garbage-collected if there are no other 
remaining references to it in your Lua code. The default value is <strong>false</strong>.</p>
<p>All parameters are optional, but startFrame and endFrame will default
 to the last and first images provided in <span class="geshifilter"><code
 class="lua geshifilter-lua">newAnim<span class="br0">(</span><span 
class="br0">)</span></code></span>, so it is a good practice to always 
provide both values explicitly to avoid unexpected behavior.</p>
<p>Passing any parameters to <span class="geshifilter"><code class="lua 
geshifilter-lua">reverse<span class="br0">(</span><span class="br0">)</span></code></span>
 indicates that a new sequence should be constructed, and any current 
sequence information will be reset. Call <span class="geshifilter"><code
 class="lua geshifilter-lua">reverse<span class="br0">(</span><span 
class="br0">)</span></code></span> with no parameters if you simply want
 to resume the current sequence.</p>

<h5 id="object:nextFrame">object:nextFrame()</h5>

<p>Resets any animation sequence in progress, moves the animation to the
 next image in the total sequence, and stops. This can be used with a 
two-frame movieclip to make an image toggle between two states</p>

<h5 id="object:previousFrame">object:previousFrame()</h5>

<p>Resets any animation sequence in progress, moves the animation to the
 previous image in the total sequence, and stops.</p>

<h5 id="object:stop">object:stop()</h5>

<p>Stops the animation of the sprite at its current frame.</p>

<h5 id="object:stopAtFrame_frame_">object:stopAtFrame( frame )</h5>

<p>Jumps the animation to the specified frame, given either as a frame 
number or by an optional frame label (see <span class="geshifilter"><code
 class="lua geshifilter-lua">setLabels</code></span> function below).</p>
<p>Note: to “go to and play” from a specified frame, simply issue a <span
 class="geshifilter"><code class="lua geshifilter-lua">stopAtFrame</code></span>
 command followed by a play or reverse command. Both commands will 
execute before the display updates again, and so the transition will be 
immediate:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myAnim:stopAtFrame<span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span>
myAnim:play<span class="br0">(</span><span class="br0">)</span>
&nbsp;
myAnim:stopAtFrame<span class="br0">(</span><span class="st0">"label"</span><span class="br0">)</span>
myAnim:reverse<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<h5 id="object:setLabels_labels_">object:setLabels( labels )</h5>

<p>Adds optional labels to an Anim object previously created, using a 
table to assign label names to selected frame numbers:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myAnim:setLabels<span class="br0">{</span> firstLabel<span class="sy0">=</span><span class="nu0">1</span>, anotherLabel<span class="sy0">=</span><span class="nu0">3</span> <span class="br0">}</span></pre></div></div>

<h5 id="object:setDrag">object:setDrag</h5>

<p>Turns any movieclip into a draggable object when <span 
class="geshifilter"><code class="lua geshifilter-lua">drag</code></span>
 is set as <strong>true</strong>. The <span class="geshifilter"><code 
class="lua geshifilter-lua">limitX</code></span> and <span 
class="geshifilter"><code class="lua geshifilter-lua">limitY</code></span>
 parameters limit the dragging to either the x or y axis, and the <span 
class="geshifilter"><code class="lua geshifilter-lua">bounds</code></span>
 parameter can be used to specify drag boundaries for the object as <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="br0">{</span>left,
 top, width, height<span class="br0">}</span></code></span>.</p>
<p>The <span class="geshifilter"><code class="lua geshifilter-lua">onPress</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">onDrag</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">onRelease</code></span>
 parameters take the names of functions to be called when those events 
occur. All parameters are optional.</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myAnim:setDrag<span class="br0">{</span> drag<span class="sy0">=</span><span class="kw1">true</span>, limitX<span class="sy0">=</span><span class="kw1">false</span>, limitY<span class="sy0">=</span><span class="kw1">false</span>, onPress<span class="sy0">=</span>myPressFunction, onDrag<span class="sy0">=</span>myDragFunction, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; onRelease<span class="sy0">=</span>myReleaseFunction, bounds<span class="sy0">=</span><span class="br0">{</span> <span class="nu0">10</span>, <span class="nu0">10</span>, <span class="nu0">200</span>, <span class="nu0">50</span> <span class="br0">}</span><span class="br0">}</span></pre></div></div>

<p>To turn off the draggable property again, set <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"drag"</span></code></span>
 to <strong>false</strong>:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myAnim:setDrag<span class="br0">{</span> drag<span class="sy0">=</span><span class="kw1">false</span> <span class="br0">}</span></pre></div></div>

<p>Note that the examples above with curly brackets are using the Lua 
“shorthand” notation for passing a table of named values directly to a 
function. In other words, the function is actually receiving a single 
value that happens to be a Lua table, like this: <strong>function( {<i>values</i>
 } )</strong>. The shorthand notation allows the outer parentheses to be
 eliminated, to make the code more readable.</p>

<h4 id="Differences_between_movieclips_and_sprite_sheets">Differences 
between movieclips and sprite sheets</h4>


<p>The upcoming Corona Game Edition will include a “sprite sheet” 
feature for constructing animated sprites by copying rectangular areas 
from a single large texture in memory.</p>

<p>Sprite sheets are a much more efficient use of texture memory, since 
OpenGL-ES allocates all textures in dimensions equal to the next 
power-of-two, no matter what the size of the source image is. For 
example, a single image with dimensions of 80x300 will require a texture
 memory allocation of 128x512 pixels.</p>

<p>Therefore, sprite sheets are recommended for complex character 
animation, or any case in which there are a large number of animation 
states.</p>

<p>However, sprite sheets will require more coding and are more complex 
to set up; for example, you must first construct a large sheet of 
animation frames. The movieclip library is easier to get started with, 
and can be more rapidly used to port Flash content, since movieclip 
frames can be exported from Flash as PNG sequences.</p>

<h3 id="CustomProgrammatic_Animations">Custom/Programmatic Animations</h3>

<p>Often you will need to create your own custom animations that are not
 feasible using the <span class="geshifilter"><code class="lua 
geshifilter-lua">transition</code></span> library. This is known as 
programmatic animation because you have to write custom code to produce 
the animation sequence. </p>

<p>To create such animations, you need to change the contents of the 
screen over time. In some environments, it’s natural to do this by 
changing properties of an object in loops such as a <strong>for</strong>
 or <strong>while</strong> loop. However, in Corona, you cannot produce 
animations using such loops because the screen is <strong>never</strong>
 updated within a block of code (see <a 
href="http://developer.anscamobile.com/app-programming-guide#ScreenUpdates">Screen
 Updates</a>).</p>

<p>Instead, animations are produced by repeatedly calling listeners. 
These listeners modify the display objects on the screen and then exit, 
thus allowing the screen to be updated. Such listeners are known as <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"enterFrame"</span></code></span>
 listeners because you register these listeners with the <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"enterFrame"</span></code></span>
 event.</p>
<p>In the drawing cycle, <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"enterFrame"</span></code></span> 
events are dispatched before the screen is updated providing your code 
the opportunity to modify the contents of the screen (see <a 
href="http://developer.anscamobile.com/app-programming-guide#DrawingCycle">Drawing
 Cycle</a>). With <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"enterFrame"</span></code></span> 
events, you can produce all kinds of animations. In fact, the transition
 library is built on top of these events.</p>
<p>Below is an example of how to animate a bouncing ball:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> xdirection,ydirection <span class="sy0">=</span> <span class="nu0">1</span>,<span class="nu0">1</span>
<span class="kw1">local</span> xpos,ypos <span class="sy0">=</span> display.stageWidth<span class="sy0">*</span><span class="nu0">0.5</span>,display.stageHeight<span class="sy0">*</span><span class="nu0">0.5</span>
<span class="kw1">local</span> circle <span class="sy0">=</span> display.newCircle<span class="br0">(</span> xpos, ypos, <span class="nu0">20</span> <span class="br0">)</span><span class="sy0">;</span>
circle:setFillColor<span class="br0">(</span><span class="nu0">255</span>,<span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">255</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">local</span> <span class="kw1">function</span> animate<span class="br0">(</span>event<span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; xpos <span class="sy0">=</span> xpos + <span class="br0">(</span> <span class="nu0">2.8</span> <span class="sy0">*</span> xdirection <span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; ypos <span class="sy0">=</span> ypos + <span class="br0">(</span> <span class="nu0">2.2</span> <span class="sy0">*</span> ydirection <span class="br0">)</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>xpos <span class="sy0">&gt;</span> display.stageWidth - <span class="nu0">20</span> <span class="kw1">or</span> xpos <span class="sy0">&lt;</span> <span class="nu0">20</span><span class="br0">)</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xdirection <span class="sy0">=</span> xdirection <span class="sy0">*</span> -<span class="nu0">1</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>ypos <span class="sy0">&gt;</span> display.stageHeight - <span class="nu0">20</span> <span class="kw1">or</span> ypos <span class="sy0">&lt;</span> <span class="nu0">20</span><span class="br0">)</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ydirection <span class="sy0">=</span> ydirection <span class="sy0">*</span> -<span class="nu0">1</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; circle:translate<span class="br0">(</span> xpos - circle.x, ypos - circle.y<span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"enterFrame"</span>, animate <span class="br0">)</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>

<p>The listener function <span class="geshifilter"><code class="lua 
geshifilter-lua">animate</code></span> is called every time an <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"enterFrame"</span></code></span>
 event occurs. It is responsible for changing the position of the ball 
and for ensuring that the ball “bounces” when it hits the edge of the 
screen.</p>
<p>Because <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"enterFrame"</span></code></span> events occur at the 
global level, you register listeners for those events with the global <span
 class="geshifilter"><code class="lua geshifilter-lua">Runtime</code></span>
 object.</p>


<h4 id="Frame_Rate">Frame Rate</h4>


<p>The <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"enterFrame"</span></code></span> event occurs at a regular
 interval known as the frame rate, so your listeners will be called at 
the frame rate. However, if your listeners take too long to exit, then 
the <i>actual</i> frame rate will be less than the desired frame rate. 

</p><h4 id="Time-based_vs_Frame-based">Time-based vs Frame-based</h4>

<p>In the above example, the animation was done in a frame-based manner.
 If the actual frame rate were to slow down, the ball would appear to 
move more slowly as each and every intermediate frame got rendered; no 
intermediate frames would be skipped. If you were trying to synchronize 
the animation with sound, then this behavior would be extremely 
problematic.</p>
<p>
The solution is time-based animation. We can transform the above example
 to be time-based by calculating how much time had passed between calls 
to our listener and changing the velocities appropriately. This would 
result in the following changes:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> xdirection,ydirection <span class="sy0">=</span> <span class="nu0">1</span>,<span class="nu0">1</span>
<span class="kw1">local</span> xpos,ypos <span class="sy0">=</span> display.stageWidth<span class="sy0">*</span><span class="nu0">0.5</span>,display.stageHeight<span class="sy0">*</span><span class="nu0">0.5</span>
<span class="kw1">local</span> circle <span class="sy0">=</span> display.newCircle<span class="br0">(</span> xpos, ypos, <span class="nu0">20</span> <span class="br0">)</span><span class="sy0">;</span>
circle:setFillColor<span class="br0">(</span><span class="nu0">255</span>,<span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">255</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">local</span> tPrevious <span class="sy0">=</span> system.getTimer<span class="br0">(</span><span class="br0">)</span>
<span class="kw1">local</span> <span class="kw1">function</span> animate<span class="br0">(</span>event<span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">local</span> tDelta <span class="sy0">=</span> event.<span class="kw1">time</span> - tPrevious
&nbsp; &nbsp; &nbsp; &nbsp; tPrevious <span class="sy0">=</span> event.<span class="kw1">time</span>
&nbsp; &nbsp; &nbsp; &nbsp; xpos <span class="sy0">=</span> xpos + <span class="br0">(</span> <span class="nu0">0.084</span><span class="sy0">*</span>xdirection<span class="sy0">*</span>tDelta <span class="br0">)</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; ypos <span class="sy0">=</span> ypos + <span class="br0">(</span> <span class="nu0">0.066</span><span class="sy0">*</span>ydirection<span class="sy0">*</span>tDelta <span class="br0">)</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>xpos <span class="sy0">&gt;</span> display.stageWidth - <span class="nu0">20</span> <span class="kw1">or</span> xpos <span class="sy0">&lt;</span> <span class="nu0">20</span><span class="br0">)</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xdirection <span class="sy0">=</span> xdirection <span class="sy0">*</span> -<span class="nu0">1</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>ypos <span class="sy0">&gt;</span> display.stageHeight - <span class="nu0">20</span> <span class="kw1">or</span> ypos <span class="sy0">&lt;</span> <span class="nu0">20</span><span class="br0">)</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ydirection <span class="sy0">=</span> ydirection <span class="sy0">*</span> -<span class="nu0">1</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; circle:translate<span class="br0">(</span> xpos - circle.x, ypos - circle.y<span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"enterFrame"</span>, animate <span class="br0">)</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>

<p>Notice how we leverage the fact that the <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="st0">"enterFrame"</span></code></span>
 event contains a property storing the time in milliseconds. We compare 
that with the previous time to determine how far the ball should travel.
 In addition, our old x,y velocities (2.8, 2.2) implicitly assumed that 
time was measured in frames. The equivalent time in milliseconds is 
simply the frame rate. By default, that’s set to 30 fps or 33.3 
milliseconds. So we can multiply the old velocities by (30/1000) to get 
the new time-based velocities. </p>

<h4 id="Lost_or_Missing_Time">Lost or Missing Time</h4>


<p>The one problem to watch out for when doing time-based animation is 
that when the device suspends the app, you need to account for the 
“lost” time. In the simulator, you can simulate a suspend by using the 
keyboard shortcut ⌘↓ (command-down arrow) which corresponds to the <strong>Suspend/Resume</strong>
 menu item under <strong>Hardware</strong>. (Note a known issue is that 
clicking on the menu causes the app to pause as if it were suspended but
 doesn’t generate a suspend event).</p>
<p>In the bouncing ball animation, if the app is suspended for half a 
second, the ball may appear to jump across the screen. In the example 
above, the solution is to adjust <span class="geshifilter"><code 
class="lua geshifilter-lua">tPrevious</code></span> to account for this 
missing time:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Add the following below the code in the previous example</span>
&nbsp;
<span class="kw1">local</span> tSuspend
<span class="kw1">local</span> <span class="kw1">function</span> onSuspendResume<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="st0">"applicationSuspend"</span> <span class="sy0">==</span> event.<span class="kw1">type</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tSuspend <span class="sy0">=</span> system.getTimer<span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">elseif</span> <span class="st0">"applicationResume"</span> <span class="sy0">==</span> event.<span class="kw1">type</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- add missing time to tPrevious</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tPrevious <span class="sy0">=</span> tPrevious + <span class="br0">(</span> system.getTimer<span class="br0">(</span><span class="br0">)</span> - tSuspend <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"system"</span>, onSuspendResume <span class="br0">)</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>
  </div>
<div id="node-1439" class="section-2">
  <h1 class="book-heading">Basic Functions</h1>
  <h2 id="header-1"> </h2>

<p>The following are basic global functions that are available in Lua. 
For security reasons, certain functions in the standard Lua distribution
 are not available, e.g. <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">dofile</span></code></span> and <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">pcall</span></code></span>.</p>

<h4 id="assert_v_message">assert (v [, message])</h4>
<p>Issues an error when the value of its argument v is false (i.e., nil 
or false); otherwise, returns all its arguments. message is an error 
message; when absent, it defaults to "assertion failed!"</p>

<h4 id="error_message_level">error (message [, level])</h4>
<p>Terminates the last protected function called and returns message as 
the error message. Function error never returns.</p>
<p>Usually, error adds some information about the error position at the 
beginning of the message. The level argument specifies how to get the 
error position. With level&nbsp;1 (the default), the error position is 
where the error function was called. Level&nbsp;2 points the error to 
where the function that called error was called; and so on. Passing a 
level&nbsp;0 avoids the addition of error position information to the 
message.</p>

<h4 id="G">_G</h4>
<p>A global variable (not a function) that holds the global environment 
(that is, _G._G = _G). Lua itself does not use this variable; changing 
its value does not affect any environment, nor vice-versa. (Use setfenv 
to change environments.)</p>

<h4 id="getfenv_f">getfenv ([f])</h4>
<p>Returns the current environment in use by the function. f can be a 
Lua function or a number that specifies the function at that stack 
level: Level&nbsp;1 is the function calling getfenv. If the given 
function is not a Lua function, or if f is 0, getfenv returns the global
 environment. The default for f is 1.</p>

<h4 id="getmetatable_object">getmetatable (object)</h4>
<p>If object does not have a metatable, returns nil. Otherwise, if the 
object's metatable has a "__metatable" field, returns the associated 
value. Otherwise, returns the metatable of the given object.</p>

<h4 id="ipairs_t">ipairs (t)</h4>
<p>Returns three values: an iterator function, the table t, and 0, so 
that the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> i,v <span class="kw1">in</span> <span class="kw1">ipairs</span><span class="br0">(</span>t<span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over the pairs (1,t[1]), (2,t[2]), ..., up to the first 
integer key absent from the table.</p>

<h4 id="next_table_index">next (table [, index])</h4>
<p>Allows a program to traverse all fields of a table. Its first 
argument is a table and its second argument is an index in this table. 
next returns the next index of the table and its associated value. When 
called with nil as its second argument, next returns an initial index 
and its associated value. When called with the last index, or with nil 
in an empty table, next returns nil. If the second argument is absent, 
then it is interpreted as nil. In particular, you can use next(t) to 
check whether a table is empty.</p>
<p>The order in which the indices are enumerated is not specified, even 
for numeric indices. (To traverse a table in numeric order, use a 
numerical for or the ipairs function.)</p>
<p>The behavior of next is undefined if, during the traversal, you 
assign any value to a non-existent field in the table. You may however 
modify existing fields. In particular, you may clear existing fields.</p>

<h4 id="pairs_t">pairs (t)</h4>
<p>Returns three values: the next function, the table t, and nil, so 
that the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> k,v <span class="kw1">in</span> <span class="kw1">pairs</span><span class="br0">(</span>t<span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all key–value pairs of table t.</p>
<p>See function next for the caveats of modifying the table during its 
traversal.</p>

<h4 id="pcall_f_arg1_...">pcall (f, arg1, ...)</h4>
<p>Calls function f with the given arguments in protected mode. This 
means that any error inside&nbsp;f is not propagated; instead, pcall 
catches the error and returns a status code. Its first result is the 
status code (a boolean), which is <strong>false</strong> if the call 
succeeds without errors. In such case, pcall also returns all results 
from the call, after this first result. In case of any error, pcall 
returns <strong>false</strong> plus the error message.</p>

<h4 id="print_...">print (...)</h4>
<p>Receives any number of arguments, and prints their values to stdout, 
using the tostring function to convert them to strings. print is not 
intended for formatted output, but only as a quick way to show a value, 
typically for debugging. For formatted output, use string.format.</p>

<h4 id="rawequal_v1_v2">rawequal (v1, v2)</h4>
<p>Checks whether v1 is equal to v2, without invoking any metamethod. 
Returns a boolean.</p>

<h4 id="rawget_table_index">rawget (table, index)</h4>
<p>Gets the real value of table[index], without invoking any metamethod.
 table must be a table; index may be any value.</p>

<h4 id="rawset_table_index_value">rawset (table, index, value)</h4>
<p>Sets the real value of table[index] to value, without invoking any 
metamethod. table must be a table, index any value different from nil, 
and value any Lua value.</p>
<p>This function returns table.</p>

<h4 id="select_index_...">select (index, ...)</h4>
<p>If index is a number, returns all arguments after argument number 
index. Otherwise, index must be the string "#", and select returns the 
total number of extra arguments it received.</p>

<h4 id="setfenv_f_table">setfenv (f, table)</h4>
<p>Sets the environment to be used by the given function. f can be a Lua
 function or a number that specifies the function at that stack level: 
Level&nbsp;1 is the function calling setfenv. setfenv returns the given 
function.</p>
<p>As a special case, when f is 0 setfenv changes the environment of the
 running thread. In this case, setfenv returns no values.</p>

<h4 id="setmetatable_table_metatable">setmetatable (table, metatable)</h4>
<p>Sets the metatable for the given table. (You cannot change the 
metatable of other types from Lua, only from&nbsp;C.) If metatable is 
nil, removes the metatable of the given table. If the original metatable
 has a "__metatable" field, raises an error.</p>
<p>This function returns table.</p>

<h4 id="tonumber_e_base">tonumber (e [, base])</h4>
<p>Tries to convert its argument to a number. If the argument is already
 a number or a string convertible to a number, then tonumber returns 
this number; otherwise, it returns nil.</p>
<p>An optional argument specifies the base to interpret the numeral. The
 base may be any integer between 2 and 36, inclusive. In bases 
above&nbsp;10, the letter 'A' (in either upper or lower case) 
represents&nbsp;10, 'B' represents&nbsp;11, and so forth, with 'Z' 
representing 35. In base 10 (the default), the number can have a decimal
 part, as well as an optional exponent part (see §2.1). In other bases, 
only unsigned integers are accepted.</p>

<h4 id="tostring_e">tostring (e)</h4>
<p>Receives an argument of any type and converts it to a string in a 
reasonable format. For complete control of how numbers are converted, 
use string.format.</p>
<p>If the metatable of e has a "__tostring" field, then tostring calls 
the corresponding value with e as argument, and uses the result of the 
call as its result.</p>

<h4 id="type_v">type (v)</h4>
<p>Returns the type of its only argument, coded as a string. The 
possible results of this function are "nil" (a string, not the value 
nil), "number", "string", "boolean", "table", "function", "thread", and 
"userdata".</p>

<h4 id="unpack_list_i_j">unpack (list [, i [, j]])</h4>
<p>Returns the elements from the given table. This function is 
equivalent to</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">return</span> list<span class="br0">[</span>i<span class="br0">]</span>, list<span class="br0">[</span>i+<span class="nu0">1</span><span class="br0">]</span>, ..., list<span class="br0">[</span>j<span class="br0">]</span></pre></td></tr></tbody></table></div>
<p>except that the above code can be written only for a fixed number of 
elements. By default, i is&nbsp;1 and j is the length of the list, as 
defined by the length operator (see §2.5.5).</p>
  </div>
<div id="node-1466" class="section-2">
  <h1 class="book-heading">Configuring Projects</h1>
  <p>Corona projects may be configured with two optional files: <span 
class="geshifilter"><code class="lua geshifilter-lua">config.lua</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">build.settings</code></span>,
 each of which use Lua table syntax and should be located in the project
 directory. The <span class="geshifilter"><code class="lua 
geshifilter-lua">build.settings</code></span> file contains instructions
 for the build process, and <span class="geshifilter"><code class="lua 
geshifilter-lua">config.lua</code></span> is compiled into your project 
and accessed at runtime.</p>

<h3 id="Runtime_Configuration:_config.lua">Runtime Configuration: 
config.lua</h3>
<p>Several runtime properties can be specified in a <span 
class="geshifilter"><code class="lua geshifilter-lua">config.lua</code></span>
 file, which can be included in the project directory. This section 
discusses the currently available options.</p>

<p>&nbsp;</p>

<h4 id="Dynamic_Content_Scaling">Dynamic Content Scaling</h4>
<hr>

<p>Content scaling features are useful for multi-screen development. For
 example, iPhone projects designed for a 320 pixel wide screen can be 
upscaled to the 480 pixel wide screen on Android devices, making porting
 much easier, since code and assets do not need to be revised.</p>
<p>The basic idea behind dynamic content scaling is that you can tell 
Corona that your content was originally authored for a particular screen
 size; we call this the virtual screen size. Then you can specify how 
your app should be scaled if it runs on a device whose physical screen 
size is different from the original.</p>
<p>To activate dynamic content scaling, create a config.lua file (see 
below) and use a scale other than "none"</p>
<p>Example:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp;
application <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; content <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width <span class="sy0">=</span> <span class="nu0">320</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height <span class="sy0">=</span> <span class="nu0">480</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scale <span class="sy0">=</span> <span class="st0">"zoomEven"</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span> </pre></div></div>

<p>The value of "content" should be a table containing the following 
key-value pairs:</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">width</code></span>
 (number) - the width in pixels</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">height</code></span>
 (number) - the height in pixels</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">scale</code></span>
 (string) - the type of auto-scaling, from one of:</p>
<ul>
<li>"none" - turns off dynamic content scaling</li>
<li>"zoomEven" - uniformly scales up content to fill screen preserving 
aspect ratio. Some content may appear offscreen</li>
<li>"zoomStretch" - non-uniformly scales up content to fill screen.</li>
<li>"letterbox" - uniformly scales up content as much as possible, but 
still showing all content on the screen.</li>
</ul>
  
<p>The content width and height allow you to choose a virtual screen 
size that is independent of the physical device screen size. You are 
then free to code as if you are positioning objects to the virtual 
screen. Touch events (and other hit events) will be remapped to the 
correct location on the virtual screen when dynamic content scaling is 
active.</p>
<p>These virtual (i.e., content) dimensions are accessible via <span 
class="geshifilter"><code class="lua geshifilter-lua">display.contentWidth</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">display.contentHeight</code></span>.
 Because of this, the concept of stage width and height, e.g., <span 
class="geshifilter"><code class="lua geshifilter-lua">display.stageWidth</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">display.stageHeight</code></span>,
 has been deprecated in favor of content width and height. You will 
receive a warning in Corona Terminal if you use these older properties.</p>
<p>By default, the content width and height will be the same as the 
physical screen width and height of the device. If you are specify a 
different content width and height in config.lua, the content width and 
height will take on those values.</p>
<p>When a scale is set in config.lua, the content will be rescaled to 
fit the screen. As far as your code is concerned, however, positions 
should still be specified in terms of the virtual screen coordinates.</p>
<p>For example, in the "Fishies" sample code 
(SampleCode/iPhone/Graphics/Fishies), there is a config.lua file in 
which the content width is 320, the height is 480, and the scale is 
"zoomEven". If you were to view this in iPad, all the content (including
 the background image and the images of the fish) would be scaled to fit
 the iPad's screen size (1024x768) even though the images were intended 
for the smaller iPhone screen (320x480).</p>
<p>Depending on which dynamic scaling mode is used, and the aspect ratio
 of the device used to view the content, some of the original content 
may be scaled in such a way that portions are offscreen. Therefore, <span
 class="geshifilter"><code class="lua geshifilter-lua">display.viewableContentWidth</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">display.viewableContentHeight</code></span>
 have also been provided. These properties give you the currently 
viewable area of the screen, within the coordinate system of the 
original content. The Fishies sample leverages this so that the fish 
continue to swim only on the visible portions of the virtual screen.</p>

<p>&nbsp;</p>

<h4 id="Frame_rate_control">Frame rate control</h4>
<hr>
<p>By default, the frame rate is 30 fps. We now allow you to optionally 
set the frame rate to 60 fps by adding the fps key to config.lua:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">application <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; content <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fps <span class="sy0">=</span> <span class="nu0">60</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>

<p><strong>Note:</strong> to avoid image tearing, the screen refresh 
rate in Corona is now locked to the hardware refresh rate on the iPhone,
 which is 60 fps. Therefore, the Corona framerate must be a number that 
divides evenly into 60. We are currently assuming that setting a rate 
below 30 fps is not a priority, which leaves two possible choices: 30 
fps and 60 fps. Values other than 60 in this setting will be ignored.</p>

<p>&nbsp;</p>

<h4 id="Anti-aliasing">Anti-aliasing</h4>
<hr>
<p>Corona uses software anti-aliasing for its vector objects. 
Previously, this anti-aliasing was on by default. It is now off by 
default, which will improve performance of vector objects, and should 
make little visual difference on new high-dpi devices.</p>
<p>To turn it on again, you must create a config.lua file and add an 
antialias key:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">application <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; content <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; antialias <span class="sy0">=</span> <span class="kw1">false</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>

<p>&nbsp;</p>

<h3 id="Build_Configuration:_build.settings">Build Configuration: 
build.settings</h3>
<p>Build-time properties can be provided in an optional <span 
class="geshifilter"><code class="lua geshifilter-lua">build.settings</code></span>
 file, which uses Lua syntax. An example of a build.settings file:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">settings <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; orientation <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default <span class="sy0">=</span> <span class="st0">"portrait"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; iphone <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; plist <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UIRequiredDeviceCapabilities <span class="sy0">=</span> <span class="st0">"magnetometer"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UIPrerenderedIcon <span class="sy0">=</span> <span class="kw1">true</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; build <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; custom <span class="sy0">=</span> <span class="st0">"a1234"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>

<p>The build.settings file is used to set application orientation and 
auto-rotation behavior, along with a variety of platform-specific build 
parameters.</p>
<p>In addition, there is a custom build parameter for creating device 
builds with specific test versions of Corona. Currently, the only 
publicly available option is the temporary Beta 3 compatibility setting 
(which will be deprecated in the future), but others may be announced in
 the future.</p>

<p>&nbsp;</p>

<h4 id="Info.plist_Values_iOS">Info.plist Values (iOS)</h4>
<hr>

<p>Within build.settings, the optional “plist” table, within the 
“iphone” table (as shown above), can be used to set values in the 
compiled application’s Info.plist file.</p>
<p>This has a number of uses, such as specifying device requirements or 
capabilities for the App Store. In the above example, the 
UIRequiredDeviceCapabilities key is set to “magnetometer”, which is 
required for apps using the Compass API to indicate to the App Store 
that they require devices with a compass. Also, the UIPrenderedIcon key 
is set to true, which prevents the iPhoneOS from adding the “shiny” 
highlight to the application icon.</p>
<p>For boolean values in Info.plist keys, use Lua-style booleans (<span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">true</span></code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="kw1">false</span></code></span>, without quotes) rather than 
Objective-C style booleans (“YES” and “NO”).</p>
<p>The table name “iphone” refers to the iOS platform, which also 
includes the iPad.</p>
<p>See the <a 
href="http://developer.apple.com/iphone/library/documentation/General/Reference/InfoPlistKeyReference/Articles/AboutInformationPropertyListFiles.html">Apple
 developer documentation</a> for more information on supported 
Info.plist values and what you can do with them.</p>

<p>&nbsp;</p>

<h4 id="Orientation_Support_iOS">Orientation Support (iOS)</h4>
<hr>

<p>The build.settings file can be used to set application orientation, 
including auto-orientation with the accelerometer.</p>
<p>On iPhone and iPad, it is important to understand that there are 
actually three different things that are subject to orientation:</p>
<ol>
<li>The splash screen image</li>
<li>The native UI elements, such as the keyboard and alert popups</li>
<li>The Corona canvas itself</li>
</ol>
<p>In many cases, you may want (2) and (3) to have the same orientation,
 but note that there are also cases in which you want to orient them 
separately.</p>
<p>For example, you might create an iPad game with no “correct” 
orientation, but still want the iPhoneOS notification dialogs to appear 
right side up from the current player’s point of view. Alternatively, 
you might want to lock the orientation of the Corona canvas, because you
 are performing your own orientation changes using Corona animation (as 
shown in the Fishies sample code), but you still want the native UI 
elements to appear in the current orientation.</p>
<p>To control these various possible scenarios, there are now three 
optional key/value pairs within the orientation table in build.settings:
 default, supported, and content. The following scenarios demonstrate 
usage by example.</p>

<p>&nbsp;</p>

<p><strong>Auto-rotation</strong></p>
<p>To auto-rotate to all four orientations, you could use the following 
build.settings file:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">settings <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; orientation <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default <span class="sy0">=</span> <span class="st0">"landscapeRight"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; supported <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">"landscapeLeft"</span>, <span class="st0">"landscapeRight"</span>, <span class="st0">"portrait"</span>, <span class="st0">"portraitUpsideDown"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>

<p>The default orientation setting determines the initial launch 
orientation on the iPhone, and also the initial orientation of the 
Corona simulator. </p>
<p>When you change the device or simulator orientation, the Corona view 
will auto-rotate, within the orientations supported. In addition, native
 UI (on the device) will auto-rotate.  The auto-rotation is such that to
 the user, the content appears "upright". Also, the position (0,0) 
within Corona will correspond to the upper left-hand corner of the 
current screen orientation.</p>
<p>Note that the iPad ignores the default setting, and attempts to 
launch in the current physical orientation of the device, assuming that 
orientation is found on the supported list. If you are writing an iPad 
app that supports multiple orientations, you should also provide a 
splash screen for each of the orientations, or the App Store reviewers 
may reject your app. The iPad supports the following naming conventions 
for orientation-specific splash screen files:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">Default-Portrait.png
Default-PortraitUpsideDown.png
Default-Landscape.png
Default-LandscapeLeft.png
Default-LandscapeRight.png</pre></div></div>

<p>Note that the "Portrait" and "Landscape" splash screens in the list 
above will automatically handle two types of orientation each, unless 
you decide to provide more specialized files, such as "LandscapeLeft". 
Also, all splash screen graphics provided should be internally upright 
-- one common misunderstanding is that the "PortraitUpsideDown" graphic 
should actually be <em>created</em> upside down, which is incorrect.</p>

<p>&nbsp;</p>

<p><strong>Landscape orientation</strong></p>
<p>To support a single orientation (for example, landscape-only), 
build.settings should look like this:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">settings <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; orientation <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default <span class="sy0">=</span> <span class="st0">"landscapeRight"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; supported <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">"landscapeLeft"</span>, <span class="st0">"landscapeRight"</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>

<p>In this sample, both of the equivalent landscape orientations are 
supported (landscapeRight and landscapeLeft). It has become fairly 
common for iPhone apps to only support one orientation, but Apple now 
encourages iPad developers to support all equivalent orientations: for 
example, a landscape app should support both landscapeLeft and 
landscapeRight, and a portrait app should support both portrait and 
portraitUpsideDown.</p>
<p>Again, the position (0,0) within Corona will correspond to the upper 
left-hand corner of each screen orientation.</p>

<p>&nbsp;</p>

<p><strong>Orientation of native UI only</strong></p>
<p>There are scenarios in which you want the native UI elements to 
auto-rotate, or to be oriented in a specific way, but you also want to 
maintain a fixed coordinate system within Corona (which matches the 
previous behavior in Corona SDK 1.x).</p>
<p>For example, you may have a multiplayer game where <em>any</em> 
orientation is equally valid, or you may want to manually define the 
animation that occurs on orientation change (e.g., animate a dissolve 
and/or rotation between the sideways and upright interface layouts).  
The only way to do this is through a fixed Corona coordinate system 
where you manage your own rotation behavior in Lua.  Because Corona 
renders its graphics to an OpenGL canvas that is separate from the other
 native elements, it is possible to control the rotation behavior of 
this canvas independently.</p>
<p>To lock Corona’s orientation while allowing native iPhone UI elements
 to rotate, add a <span class="geshifilter"><code class="lua 
geshifilter-lua">content</code></span> parameter in build.settings:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">settings <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; orientation <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default <span class="sy0">=</span> <span class="st0">"portrait"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content <span class="sy0">=</span> <span class="st0">"portrait"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; supported <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">"landscapeLeft"</span>, <span class="st0">"landscapeRight"</span>, <span class="st0">"portrait"</span>, <span class="st0">"portraitUpsideDown"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>
  
<p>Similarly, to lock Corona’s internal coordinate system to portrait 
orientation (e.g., for compatibility with your older Corona code) while 
locking iPhone UI elements to landscape orientation, you could do the 
following in build.settings:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">settings <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; orientation <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default <span class="sy0">=</span><span class="st0">"landscapeRight"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content <span class="sy0">=</span> <span class="st0">"portrait"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; supported <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">"landscapeRight"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>

<p>&nbsp;</p>

<p><strong>Orientation naming conventions</strong></p>
<p>Orientations follow the UIInterfaceOrientation conventions on the 
iPhone (not to be confused with UIDeviceOrientation). These are defined 
as follows:</p>

<ul>
<li><span class="geshifilter"><code class="lua geshifilter-lua">portrait</code></span>
 - device in the upright position with the Home button on the bottom</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua">landscapeRight</code></span>
 - device in the sideways position with the Home button on the right</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua">landscapeLeft</code></span>
 - device in the sideways position with the Home button on the left</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua">portraitUpsideDown</code></span>
 - device in the upside down position with the Home button on the top</li>
</ul>

<p>&nbsp;</p>

<h4 id="Detecting_current_device_orientation">Detecting current device 
orientation</h4>
<hr>

<p>The current device orientation can be read from <span 
class="geshifilter"><code class="lua geshifilter-lua">system.orientation</code></span>.
 This property will return one of six possible string values, from a set
 consisting of the four orientations above plus <span 
class="geshifilter"><code class="lua geshifilter-lua">faceUp</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">faceDown</code></span>.</p>
<p>To get more detailed information about the device’s specific  x, y, 
and z angle in space, see the section on accelerometer events in the API
 Reference.</p>

<p>&nbsp;</p>

<h4 id="Orientation_Support_Android">Orientation Support (Android)</h4>
<hr>

<p>The Android platform supports two orientations: <span 
class="geshifilter"><code class="lua geshifilter-lua">portrait</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">landscapeRight</code></span>
 (defined as above). The orientations “landscapeLeft” and 
“portraitUpsideDown” have no effect on Android. Also, auto-rotation is 
not currently supported on Android.</p>
<p>Here is an example of an Android-specific build.settings file (you 
may also combine Android and iPhone settings in the same file):</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">settings <span class="sy0">=</span>
<span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; android <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; versionCode <span class="sy0">=</span> <span class="st0">"3"</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; androidPermissions <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">"android.permission.ACCESS_FINE_LOCATION"</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="st0">"android.permission.INTERNET"</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; orientation <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default <span class="sy0">=</span> <span class="st0">"landscape"</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>,
<span class="br0">}</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Version_Code_Android">Version Code (Android)</h4>
<hr>
<p>The version code can be set within an optional “android” table in 
build.settings. See the code above for an example.</p>
<p>For more information, see android:versionCode on <a 
href="http://developer.android.com/guide/topics/manifest/manifest-element.html#vcode">this
 page</a>. Note that this version code is an <em>internal</em> number 
used to distinguish application releases for the Android Marketplace, 
and is different than the version given in the Corona build dialog. The 
latter determines the version number displayed to the end user, also 
known as android:versionName.</p>

<p>&nbsp;</p>

<h4 id="Application_Permissions_Android">Application Permissions 
(Android)</h4>
<hr>
<p>Finally, an optional “androidPermissions” table can be used to 
specify permissions, using string values as given in the Android 
Manifest Reference. For example, ACCESS_FINE_LOCATION and INTERNET 
permissions are specified in the code above.</p>
<p>Developers should choose the permissions that match what their 
application requires. In particular, set the INTERNET permission for any
 Android application that requries network access.</p>  </div>
<div id="node-1446" class="section-2">
  <h1 class="book-heading">Crypto</h1>
  <p>Corona provides routines for calculating common message digests 
(hashes) and hash-based message authentication codes (HMAC). </p>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">crypto</code></span>
 library is an external library pre-installed into Corona apps. To speed
 up launch time, it is not automatically loaded by default. In order to 
use this library, you must explicitly load the library to make the 
library's functions available to your code. To do this, you should use <u>require</u>,
 i.e. placing <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">local</span> crypto <span class="sy0">=</span>
 <span class="kw1">require</span><span class="br0">(</span><span 
class="st0">"crypto"</span><span class="br0">)</span></code></span> at 
the top of your Lua file.</p>

<h4 id="crypto.digest_algorithm_string_raw_">crypto.digest( algorithm, 
string [, raw] )</h4>
<p>This function generates the message digest of the input string and 
returns it. See <a 
href="http://developer.anscamobile.com/Algorithm_Constants">Algorithm 
Constants</a> for valid values for algorithm. The optional <span 
class="geshifilter"><code class="lua geshifilter-lua">raw</code></span> 
flag, defaulted to <strong>false</strong>, is a boolean indicating 
whether the output should be a direct binary equivalent of the message 
digest, or formatted as a hexadecimal string (the default).</p>

<h4 id="crypto.hmac_algorithm_string_key_raw_">crypto.hmac( algorithm, 
string, key [, raw] )</h4>
<p>This function returns HMAC of the string and returns it. See <a 
href="http://developer.anscamobile.com/Algorithm_Constants">Algorithm 
Constants</a> for valid values for algorithm. The parameter key is used 
as the seed for the HMAC generation. The optional <span 
class="geshifilter"><code class="lua geshifilter-lua">raw</code></span> 
flag, defaulted to <strong>false</strong>, is a boolean indicating 
whether the output should be a direct binary equivalent of the HMAC or 
formatted as a hexadecimal string (the default). </p>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">algorithm</code></span>
 parameter is a constant for a hashing algorithm:</p>

<ul><li><h5 id="crypto.md4">crypto.md4</h5> (Note: HMAC is not available
 for this algorithm)</li>
<li>	<h5 id="crypto.md5">crypto.md5</h5></li>
<li>	<h5 id="crypto.sha1">crypto.sha1</h5></li>
<li>	<h5 id="crypto.sha224">crypto.sha224</h5></li>
<li>	<h5 id="crypto.sha256">crypto.sha256</h5></li>
<li>	<h5 id="crypto.sha384">crypto.sha384</h5></li>
<li>	<h5 id="crypto.sha512">crypto.sha512</h5></li>
</ul>
  </div>
<div id="node-1196" class="section-2">
  <h1 class="book-heading">Database (SQLite)</h1>
  <p>Corona includes support for SQLite databases on all platforms. This
 is based on the built-in sqlite support on the iPhone, and a compiled 
version of SQLite on Android. Note that this increases the size of the 
Android binary by 300K.</p>
<p>SQLite should be available in Android 1.5, 2.0, iPhone, and iPad, as 
well as in the Corona Simulator. However, on Android, access to a 
prepopulated database inside the APK is not yet supported. Only memory 
databases and dbs on the local filesystem may be opened.</p>
<p>The Lua API is provided by luasqlite 3 v0.7, source available from <a
 href="http://luaforge.net/projects/luasqlite/">luaforge.net/projects/luasqlite/</a>.
 The documentation for luasqlite3 can be viewed at <a 
href="http://luasqlite.luaforge.net/lsqlite3.html">luasqlite.luaforge.net/lsqlite3.html</a>.
 This documentation also includes test and sample code.</p>

<p>Example code:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1"><span class="kw1">require</span> <span class="st0">"sqlite3"</span>
<span class="kw1">local</span> db <span class="sy0">=</span> sqlite3.open_memory<span class="br0">(</span><span class="br0">)</span>
&nbsp;
db:exec<span class="br0">[</span><span class="br0">[</span>
&nbsp; CREATE TABLE test <span class="br0">(</span>id INTEGER PRIMARY KEY, content<span class="br0">)</span><span class="sy0">;</span>
&nbsp; INSERT INTO test VALUES <span class="br0">(</span>NULL, <span class="st0">'Hello World'</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; INSERT INTO test VALUES <span class="br0">(</span>NULL, <span class="st0">'Hello Lua'</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp; INSERT INTO test VALUES <span class="br0">(</span>NULL, <span class="st0">'Hello Sqlite3'</span><span class="br0">)</span>
<span class="br0">]</span><span class="br0">]</span>
&nbsp;
<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"version "</span> .. sqlite3.version<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>
&nbsp;
<span class="kw1">for</span> row <span class="kw1">in</span> db:nrows<span class="br0">(</span><span class="st0">"SELECT * FROM test"</span><span class="br0">)</span> <span class="kw1">do</span>
&nbsp; <span class="kw1">local</span> t <span class="sy0">=</span> display.newText<span class="br0">(</span>row.content, <span class="nu0">20</span>, <span class="nu0">30</span> <span class="sy0">*</span> row.id, null, <span class="nu0">16</span><span class="br0">)</span>
&nbsp; t:setTextColor<span class="br0">(</span><span class="nu0">255</span>,<span class="nu0">0</span>,<span class="nu0">255</span><span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>
  </div>
<div id="node-1193" class="section-2">
  <h1 class="book-heading">Events and Listeners</h1>
  <p>Events are dispatched to listeners. Event listeners can be either 
functions or objects (see <a href="#Function_vs_Table_Listeners">Function
 vs Table Listeners</a> below). In both cases, when an event occurs, the
 listener will be invoked and be supplied with a table representing the 
event. All events will have a property name that identifies the kind of 
event.</p>

<p>&nbsp;</p>

<h3 id="Registering_for_Events">Registering for Events</h3>

<p>Certain objects you create using Ansca's libraries are event 
listeners. This includes both display objects and the global <span 
class="geshifilter"><code class="lua geshifilter-lua">Runtime</code></span>
 object. You can add and remove listeners for events using the following
 <i>object</i> methods:</p>

<p>&nbsp;</p>
<h4 id="object:addEventListener_">object:addEventListener( )</h4>
<p><strong>object:addEventListener( eventName, listener )</strong> Adds 
listener to the object’s list of listeners. When an event corresponding 
to the string <span class="geshifilter"><code class="lua 
geshifilter-lua">eventName</code></span> occurs is dispatched, the 
listener will be notified of the event. Listeners can be either a 
function or a table with a method called <span class="geshifilter"><code
 class="lua geshifilter-lua">eventName</code></span>. </p>

<p>&nbsp;</p>
<h4 id="object:removeEventListener_">object:removeEventListener( )</h4>
<p><strong>object:removeEventListener( eventName, listener )</strong> 
Removes listener from the global list so that it no longer is notified 
of global events corresponding to the string eventName.</p>

<p>&nbsp;</p>

<h3 id="Examples">Examples</h3>
<p>In the example below, an image display object registers to receive 
touch events. Touch events are not broadcast globally. Only objects that
 register for the event and lie underneath it will be candidates for 
receiving the touch. See <a href="#Touch_Events">Touch Events</a> for 
more information.</p>


<table>
<tbody><tr><th>Function Listeners</th>
<th>Table Listeners</th>
</tr>

<tr>
<td>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> button <span class="sy0">=</span> 
&nbsp; display.newImage<span class="br0">(</span><span class="st0">"button.png"</span><span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> listener <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span>
&nbsp; <span class="kw1">print</span><span class="br0">(</span>event.name..<span class="st0">"occurred"</span><span class="br0">)</span>
&nbsp; <span class="kw1">return</span> <span class="kw1">true</span>
<span class="kw1">end</span>
&nbsp;
button:addEventListener<span class="br0">(</span>
&nbsp; <span class="st0">"touch"</span>, listener <span class="br0">)</span></pre></div></div>
</td>
  
<td>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> button <span class="sy0">=</span> 
&nbsp; display.newImage<span class="br0">(</span><span class="st0">"button.png"</span><span class="br0">)</span> 
&nbsp;
<span class="kw1">function</span> button:touch<span class="br0">(</span>event<span class="br0">)</span>
&nbsp; <span class="kw1">print</span><span class="br0">(</span>event.name..<span class="st0">"occurred"</span><span class="br0">)</span>
&nbsp; <span class="kw1">return</span> <span class="kw1">true</span>
<span class="kw1">end</span>
&nbsp;
button:addEventListener<span class="br0">(</span>
&nbsp; <span class="st0">"touch"</span>, listener <span class="br0">)</span></pre></div></div>
</td></tr>
</tbody></table>


<p>In contrast, <span class="geshifilter"><code class="lua 
geshifilter-lua">Runtime</code></span> events are dispatched by the 
system. They are broadcast to all listeners. Below is an example of 
registering for an <span class="geshifilter"><code class="lua 
geshifilter-lua">enterFrame</code></span> event: </p>

<table>
<tbody><tr>
<th>Function Listeners</th>
<th>Table Listeners</th></tr>

<tr>
<td><div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> listener <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span>
&nbsp; <span class="kw1">print</span><span class="br0">(</span>event.name..<span class="st0">"occurred"</span><span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span>
&nbsp; <span class="st0">"enterFrame"</span>, listener <span class="br0">)</span></pre></div></div></td>
  
<td>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> listener <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>
<span class="kw1">function</span> listener:touch<span class="br0">(</span>event<span class="br0">)</span>
&nbsp; <span class="kw1">print</span><span class="br0">(</span>event.name..<span class="st0">"occurred"</span><span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span>
&nbsp; <span class="st0">"enterFrame"</span>, listener <span class="br0">)</span></pre></div></div>
</td></tr>
</tbody></table>

<p>&nbsp;</p>

<h3 id="Function_vs_Table_Listeners">Function vs Table Listeners</h3>

<p>Listeners can be either functions or table objects. </p>

<p>When a function listener is invoked, it is passed a table 
representing the event:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> myListener <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Listener called with event of type "</span> .. event.name <span class="br0">)</span>
<span class="kw1">end</span>
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"touch"</span>, myListener <span class="br0">)</span>
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"enterFrame"</span>, myListener <span class="br0">)</span></pre></td></tr></tbody></table></div>

<p>Sometimes a function listener is not convenient because certain 
variables are not in scope when the listener is triggered (invoked). In 
these situations, object listeners should be used. Object listeners must
 have an instance method with a name corresponding to the event name:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- assume MyClass and MyClass:new() already exist</span>
&nbsp;
<span class="kw1">function</span> MyClass:enterFrame<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"enterFrame called at time: "</span> .. event.<span class="kw1">time</span> <span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
<span class="kw1">function</span> MyClass:touch<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"touch occurred at ("</span>..event.x..<span class="st0">","</span>..event.y..<span class="st0">")"</span> <span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
<span class="kw1">local</span> myObject <span class="sy0">=</span> MyClass:new<span class="br0">(</span><span class="br0">)</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"touch"</span>, myObject <span class="br0">)</span>
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"enterFrame"</span>, myObject <span class="br0">)</span></pre></td></tr></tbody></table></div>

<p>&nbsp;</p>

<h3 id="Runtime_Events">Runtime Events</h3>

<p>Runtime events are only sent to the global <span class="geshifilter"><code
 class="lua geshifilter-lua">Runtime</code></span> object because there 
is no specific target. Instead, they are broadcast to <i>all</i> 
registered listeners. The events all have string names:</p>

<p>&nbsp;</p>
<h4 id="enterFrame">enterFrame</h4>

<p>Frame events occur at the frame interval of the application. They are
 only sent to the global <span class="geshifilter"><code class="lua 
geshifilter-lua">Runtime</code></span> object.</p>
<p>The following properties are available in this event:</p>

<h5 id="event.name">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"enterFrame"</span></code></span>.
<h5 id="event.time">event.time</h5><strong>event.time</strong> is the 
time in milliseconds since the start of the application.

<p>&nbsp;</p>
<h4 id="system">system</h4>

<p>System events are dispatched to notify the application of external 
events such as when the device needs to suspend the application because 
of an incoming phone call. These events are only sent to the global <span
 class="geshifilter"><code class="lua geshifilter-lua">Runtime</code></span>
 object.</p>

<p>The following properties are available in this event:</p>

<h5 id="event.name-1">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"system"</span></code></span>.
<h5 id="event.type">event.type</h5><strong>event.type</strong> is a 
string identifying the type of event. The string values could be: 
<ul>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"applicationStart"</span></code></span> occurs when the 
application is launched and all code in main.lua is executed.</li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"applicationExit"</span></code></span> occurs when the user
 quits the application.</li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"applicationSuspend"</span></code></span> occurs when the 
device needs to suspend the application such as during a phone call or 
if the phone goes to sleep from inactivity. In the simulator, this 
corresponds to the simulator running in the background. During 
suspension, no events (not even <span class="geshifilter"><code 
class="lua geshifilter-lua">enterFrame</code></span> events) are sent to
 the application while suspended, so if you have code that depends on 
time, you should account for the time lost to an application being 
suspended.</li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"applicationResume"</span></code></span> occurs when the 
application resumes after a suspend. On the phone, this occurs if the 
application was suspended because of a phone call. On the simulator, 
this occurs when the simulator was in the background and now is the 
foreground application.</li>
</ul>

<p>&nbsp;</p>
<h4 id="orientation">orientation</h4>

<p>Orientation events occur when the device orientation changes. They 
only occur on devices with accelerometer support. They are only sent to 
the global <span class="geshifilter"><code class="lua geshifilter-lua">Runtime</code></span>
 object.</p>
<p>The following properties are available in this event:</p>

<h5 id="event.name-2">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"orientation"</span></code></span>.
<h5 id="event.type-3">event.type</h5><strong>event.type</strong> is a 
string identifying the orientation:
<ul>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"portrait"</span></code></span></li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"landscapeLeft"</span></code></span></li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"portraitUpsideDown"</span></code></span></li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"landscapeRight"</span></code></span></li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"faceUp"</span></code></span></li>
    <li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"faceDown"</span></code></span></li>
</ul>
<h5 id="event.delta">event.delta</h5><strong>event.delta</strong> is the
 angular difference between the ending and starting orientation. 0 if 
the two orientations lie in different planes.

<p>&nbsp;</p>
<h4 id="accelerometer">accelerometer</h4>

<p>Accelerometer events let you detect sudden movements and determine 
the device's orientation relative to gravity. These events are only 
dispatched on devices that have support accelerometer. They are only 
sent to the global <span class="geshifilter"><code class="lua 
geshifilter-lua">Runtime</code></span> object.</p>
<p>The following properties are available in this event:</p>

<h5 id="event.name-4">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"accelerometer"</span></code></span>.
<h5 id="event.xGravity">event.xGravity</h5><strong>event.xGravity</strong>
 is the acceleration due to gravity in the x-direction
<h5 id="event.yGravity">event.yGravity</h5><strong>event.yGravity</strong>
 is the acceleration due to gravity in the y-direction
<h5 id="event.zGravity">event.zGravity</h5><strong>event.zGravity</strong>
 is the acceleration due to gravity in the z-direction
<h5 id="event.xInstant">event.xInstant</h5><strong>event.xInstant</strong>
 is the instantaneous acceleration in the x-direction
<h5 id="event.yInstant">event.yInstant</h5><strong>event.yInstant</strong>
 is the instantaneous acceleration in the y-direction
<h5 id="event.zInstant">event.zInstant</h5><strong>event.zInstant</strong>
 is the instantaneous acceleration in the z-direction
<h5 id="event.isShake">event.isShake</h5><strong>event.isShake</strong> 
is <strong>true</strong> when the user shakes the device

<p>&nbsp;</p>
<h4 id="location_GPS">location (GPS)</h4>

<p>Location events. Note: this event is not available on all devices. 
They are only sent to the global <span class="geshifilter"><code 
class="lua geshifilter-lua">Runtime</code></span> object.</p>

<h5 id="event.name-5">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"location"</span></code></span>.
<h5 id="event.latitude">event.latitude</h5><strong>event.latitude</strong>
 is the latitude in degrees.
<h5 id="event.longitude">event.longitude</h5><strong>event.longitude</strong>
 is the longitude in degrees.
<h5 id="event.altitude">event.altitude</h5><strong>event.altitude</strong>
 is the altitude in meters.
<h5 id="event.accuracy">event.accuracy</h5><strong>event.accuracy</strong>
 is the accuracy of the location in meters. If negative, then the 
latitude and longitude are not valid.
<h5 id="event.speed">event.speed</h5><strong>event.speed</strong> is the
 instantaneous speed of the device in meters per second.
<h5 id="event.direction">event.direction</h5><strong>event.direction</strong>
 is the direction the device is travelling in degrees clockwise from 
true North. If negative, the direction is invalid.
<h5 id="event.time-6">event.time</h5><strong>event.time</strong> is the 
UTC timestamp of the location event.

<p>When an error occurs, the following properties will be non-nil:</p>

<h5 id="event.errorMessage">event.errorMessage</h5><strong>event.errorMessage</strong>
 is a string with an error description. This property only exists when 
an error occurs. It may be localized so it may vary depending on the 
user’s language setting.
<h5 id="event.errorCode">event.errorCode</h5><strong>event.errorCode</strong>
 is a platform-specific integer for the error which is not language 
dependent. This property only exists when an error occurs.

<p>&nbsp;</p>
<h4 id="heading_compass">heading (compass)</h4>

<p>Heading events. Note: this event is not available on all devices. 
They are only sent to the global <span class="geshifilter"><code 
class="lua geshifilter-lua">Runtime</code></span> object.</p>
<p>The following properties are available in this event:</p>

<h5 id="event.name-7">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"heading"</span></code></span>.
<h5 id="event.geographic">event.geographic</h5><strong>event.geographic</strong>
 represents a heading in degrees (clockwise) relative to the geographic 
North Pole, sometimes known as true North. 
<h5 id="event.magnetic">event.magnetic</h5><strong>event.magnetic</strong>
 represents a heading in degrees (clockwise) relative to the magnetic 
North Pole.

<p>&nbsp;</p>
<h3 id="Targeted_Events">Targeted Events</h3>

<p>Targeted events are not broadcast. They are sent to a <i>single</i> 
target (a function or table listener).</p>

<p>&nbsp;</p>
<h4 id="completion">completion</h4>

<p>Completion events signal the end of an interaction. Typically these 
are dispatched at the end of a modal interaction such as using the 
camera or throwing up a native alert.</p>
<p>The following are common properties of this event:</p>
<h5 id="event.name-8">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"completion"</span></code></span>.

<p>Additional properties are given depending on the modal interaction 
(see <a 
href="http://developer.anscamobile.com/multimedia-features#media.playVideo_path_baseSource_showControls_listener_">media.playVideo</a>,
 <a 
href="http://developer.anscamobile.com/multimedia-features#media.show_imageSource_listener_">media.show</a>,
 and <a 
href="http://developer.anscamobile.com/native-ui-features#native.showAlert_title_message_buttonLabels_listener_">native.showAlert</a>).</p>

<p>&nbsp;</p>
<h4 id="timer">timer</h4>

<p>Timer events are used in conjunction with the timer library.</p>
<p>The following properties are available in this event:</p>

<h5 id="event.name-9">event.name</h5><strong>event.name</strong> is the 
string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"timer"</span></code></span>.
<h5 id="event.source">event.source</h5><strong>event.source</strong> 
corresponds to the timer registered to send the event.
<h5 id="event.count">event.count</h5><strong>event.count</strong> is the
 number of times that the timer has fired the listener. This is useful 
if you registered the timer to fire multiple times.
<h5 id="event.time-10">event.time</h5><strong>event.time</strong> is the
 time in milliseconds since the start of the application.

<p>&nbsp;</p>
<h4 id="urlRequest">urlRequest</h4>

<p>URL request events are dispatched to the listener registered with the
 <span class="geshifilter"><code class="lua geshifilter-lua">native.webPopup<span
 class="br0">(</span><span class="br0">)</span></code></span> function. 
They are sent when the web popup is about to request a url and also when
 a url fails to load. </p>

<p>The following properties are available in this event:</p>
<h5 id="event.name-11">event.name</h5><strong>event.name</strong> is the
 string <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"urlRequest"</span></code></span>.
<h5 id="event.url">event.url</h5><strong>event.url</strong> is the 
absolute URL of the request.
<h5 id="event.errorMessage-12">event.errorMessage</h5><strong>event.errorMessage</strong>
 is a string with an error description. This property only exists when 
an error occurs. It may be localized so it may vary depending on the 
user’s language setting. 
<h5 id="event.errorCode-13">event.errorCode</h5><strong>event.errorCode</strong>
 is a platform-specific integer for the error which is not language 
dependent. This property only exists when an error occurs.

<p>&nbsp;</p>
<h3 id="Touch_Events">Touch Events</h3>
<p>When the user’s finger touches the screen, a hit event is generated 
and dispatched to display objects in the display hierarchy. Only those 
objects that intersect the hit location (the location of the finger on 
the screen) will be candidates for receiving the event. </p>
<p>The events propagate through these objects in a particular order. The
 first object in the display hierarchy to receive the event is the 
top-most display object that intersects the hit location; the next 
object is the next top-most object intersecting the hit location; and so
 on. </p>
<p>Hit events propagate until they are <i>handled</i>. You can stop 
propagation to the next <i>object</i> (all listeners of the current 
object still get the event) by telling the system that the event was 
handled. This boils down to making a listener return <strong>true</strong>.
 If at least one of the listeners of the current object returns <strong>true</strong>,
 event propagation ends; the next object will not get the event.  If the
 event is still unhandled at the end of this traversal, it is broadcast 
as a global event to the global <span class="geshifilter"><code 
class="lua geshifilter-lua">Runtime</code></span> object.</p>
<p>Hit events are a hybrid of local and global events. They are 
dispatched to a <i>single</i> display object at a time, but <i>any</i> 
listener registered with that display object will receive the event.</p>
<p>In some situations, it is convenient to have subsequent events target
 the same object that handled the initial touch event (a user’s finger 
initially touching the screen). To accomplish this, you can use a 
special method <span class="geshifilter"><code class="lua 
geshifilter-lua">display.getCurrentStage<span class="br0">(</span><span 
class="br0">)</span>:setFocus<span class="br0">(</span> object <span 
class="br0">)</span></code></span>. When the user’s finger is lifted, 
you can call the method again and pass <strong>nil</strong> to restore 
the default behavior.</p>

<p>&nbsp;</p>
<h4 id="touch_single_touch">touch (single touch)</h4>

<p>Touch events are a special kind of hit event. When a user’s finger 
touches the screen, they are starting a sequence of touch events, each 
with different phases.</p>
<dl>
<dt><strong>event.name</strong></dt> <dd>is the string <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"touch"</span></code></span>.
</dd><dt><strong>event.x</strong></dt> <dd>is the x-position in screen 
coordinates of the touch.</dd>
<dt><strong>event.y</strong></dt> <dd> is the y-position in screen 
coordinates of the touch.</dd>
<dt><strong>event.xStart</strong></dt> <dd> is the x-position of the 
touch from the "began" phase of the touch sequence.</dd>
<dt><strong>event.yStart</strong></dt> <dd> is the y-position of the 
touch from the "began" phase of the touch sequence.</dd>
<dt><strong>event.phase</strong></dt> <dd> is a string identifying where
 in the touch sequence the event occurred:
    <ul><li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"began"</span></code></span> a finger touched the screen.</li>
    <li>	<span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"moved"</span></code></span> a finger moved on the screen.</li>
    <li>	<span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"stationary"</span></code></span> a finger is touching the 
screen but hasn’t moved from the previous event.</li>
    <li>	<span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"ended"</span></code></span> a finger was lifted from the 
screen.</li>
    <li>	<span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"cancelled"</span></code></span> the system cancelled 
tracking of the touch.</li>
    </ul>
</dd>
</dl>

<p>&nbsp;</p>
<h4 id="touch_multitouch">touch (multitouch)</h4>

<p>To illustrate the documentation below, we have provided two new 
sample projects:</p>
<ul>
<li>"FollowMeMultitouch" (under "GettingStarted")</li>
<li>"MultitouchButton" (under "Interface")</li>
</ul>
In addition, we have made minor revisions to <span class="geshifilter"><code
 class="lua geshifilter-lua">ui.lua</code></span> to support multitouch.
 If you activate multitouch and plan to use ui.lua, you should include 
this new version in your project. The new library should also be 
compatible with non-multitouch cases.<p></p>

<p>&nbsp;</p>
<h4 style="color: rgb(255, 0, 0);" id="Changes_in_multitouch_for_Beta_6">Changes
 in multitouch for Beta 6</h4>
<hr>

<p>Starting in SDK Beta 6, we have revised how multitouch events are 
delivered in Corona. Previously, we grouped multiple simultaneous 
touches of the same phase into the same event. However, this design did 
not scale well for apps that wanted to allow multiple simultaneous 
button presses, because only one of the multiple touches would be used 
for hit-testing.</p>
<p>The primary change is to deliver multiple touches as individual touch
 events, each of which will now behave like single touches even when 
happening simultaneously. We have also added a <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">time</span></code></span>
 property so that you can detect simultaneous touch events when writing 
gesture-recognition code. Finally, we have added an <span 
class="geshifilter"><code class="lua geshifilter-lua">id</code></span> 
property which allows you to track which touch events came from the same
 finger.</p>
<p>Whether or not multitouch is enabled, touch events will have the 
following standard properties:</p>
<h5 id="event.x">event.x</h5><strong>event.x</strong> is the x-position 
in screen coordinates of the touch.
<h5 id="event.y">event.y</h5><strong>event.y</strong> is the y-position 
in screen coordinates of the touch.
<h5 id="event.xStart">event.xStart</h5><strong>event.xStart</strong> is 
the x-position of the touch from the "began" phase of the touch 
sequence.
<h5 id="event.yStart">event.yStart</h5><strong>event.yStart</strong> is 
the y-position of the touch from the "began" phase of the touch 
sequence.
<h5 id="event.phase">event.phase</h5><strong>event.phase</strong> is a 
string identifying where in the touch sequence the event occurred:
<ul>
  <li><strong>"began"</strong> a finger touched the screen.</li>
  <li><strong>"moved"</strong> a finger moved on the screen.</li>
  <li><strong>"stationary"</strong> a finger is touching the screen but 
hasn’t moved from the previous event.</li>
  <li><strong>"ended"</strong> a finger was lifted from the screen.</li>
  <li><strong>"cancelled"</strong> the system cancelled tracking of the 
touch.</li>
</ul>
<h5 id="event.id">event.id</h5><strong>event.id</strong> is a unique 
identifier of the chosen touch so that you can distinguish between 
multiple touches across events (i.e. the different events sent across 
multiple listener calls). The id uniquely identifies a given finger 
touching the screen as that touch changes state, generating new touch 
events.
<h5 id="event.time-14">event.time</h5><strong>event.time</strong> is a 
timestamp. It is in the same units as returned by <span 
class="geshifilter"><code class="lua geshifilter-lua">system.getTimer<span
 class="br0">(</span><span class="br0">)</span></code></span>.

<p>&nbsp;</p>
<h4 id="Using_multitouch">Using multitouch</h4>
<hr>
As before, you must explicitly activate multitouch before you will 
receive multiple touch events:<p></p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">system.activate<span class="br0">(</span> <span class="st0">"multitouch"</span> <span class="br0">)</span></pre></div></div>

<p>Once this call is made, you will get multiple touch events delivered 
as individual single touch events. For example, if two fingers moved 
simultaneously, Corona will hit-test each touch separately, delivering 
them to the respective listeners; both events will have the same 
timestamp.</p>

<p>&nbsp;</p>
<h4 id="Multiple_Focus_Buttons_and_Delivery_Precedence">Multiple Focus, 
Buttons and Delivery Precedence</h4>
<hr>
<p>In the single-touch world, we provided the ability to have touch 
events target a particular object via the <span class="geshifilter"><code
 class="lua geshifilter-lua">stage:setFocus<span class="br0">(</span>object<span
 class="br0">)</span></code></span> method, which caused all future 
touch events to be sent directly to the touch listener for that object. 
This made behaviors like button rollovers possible. The typical flow, as
 seen in the previous <span class="geshifilter"><code class="lua 
geshifilter-lua">ui.lua</code></span> library, was:<br>
</p><ul>
<li>The initial touch hit-tests the object, so the touch event is 
dispatched to object's touch listener</li>
<li>Hit-testing for all future touches is (globally) disabled by the 
object's touch listener, which calls stage:setFocus(object). This causes
 future touch events to be forwarded to that object, rather than go 
through hit-testing against other objects.</li>
<li>When the touch ends (or is cancelled), normal hit-testing is 
restored via <span class="geshifilter"><code class="lua geshifilter-lua">stage:setFocus<span
 class="br0">(</span> <span class="kw1">nil</span> <span class="br0">)</span></code></span>.</li>
</ul>

<p>In a multitouch world, this model breaks down, because it assumes 
there will only be one unique touch at a time. As a result, two buttons 
couldn't be pressed simultaneously.</p>
<p>Therefore, we had to add the ability to forward a touch event on a <em>per-object</em>
 basis. To do this, we extended the event with a parameter that uniquely
 identifies the event associated with a given finger touching the 
screen:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">stage:setFocus<span class="br0">(</span> object <span class="br0">[</span>,touchID<span class="br0">]</span> <span class="br0">)</span></pre></div></div>

<p>Calling the above with only one parameter (the object) is the same as
 the old global focus behavior: all touches will be forwarded to the 
same object.</p>
<p>Calling the above method with the optional parameter (the touchID) 
means that the specified touch has focus on that object, but other 
touches do not. Using this API, it is possible to create an object that 
will “own” the first touch it gets, for the lifetime of that touch, and 
for multiple objects to obtain their own focused touches at the same 
time. See the “GettingStarted/FollowMeMultitouch” sample code for a 
demonstration of this behavior.</p>

<p>To turn off per-object focus, you specify the object and pass nil for
 the touchID:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">stage:setFocus<span class="br0">(</span> object, <span class="kw1">nil</span> <span class="br0">)</span></pre></div></div>

<p>Note: for backwards compatibility, stage:setFocus() reverts to the 
old setFocus behavior when multitouch is off:</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">stage:setFocus<span
 class="br0">(</span> obj, <span class="kw1">nil</span> <span 
class="br0">)</span></code></span> behaves like <span 
class="geshifilter"><code class="lua geshifilter-lua">stage:setFocus<span
 class="br0">(</span> <span class="kw1">nil</span> <span class="br0">)</span></code></span></p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">stage:setFocus<span
 class="br0">(</span> obj, id <span class="br0">)</span></code></span> 
behaves like <span class="geshifilter"><code class="lua geshifilter-lua">stage:setFocus<span
 class="br0">(</span> obj <span class="br0">)</span></code></span></p>
<p>As a result, the latest <span class="geshifilter"><code class="lua 
geshifilter-lua">ui.lua</code></span> library code, distributed with 
Beta 6 or later, should work as expected in both multitouch and 
non-multitouch modes.</p>

<p>&nbsp;</p>
<h4 id="Gesture_support">Gesture support</h4>
<hr>

<p>See the "Multitouch" sample code in the iPad sample code directory 
for an example of how to implement a pinch/zoom gesture.</p>
<p>We intend to provide additional framework libraries to make gesture 
recognition easier, but we encourage you to experiment with multitouch 
in the meantime.</p>

<p>&nbsp;</p>
<h4 id="Custom_Events">Custom Events</h4>
<hr>

<p>In Corona, you can register custom events with both display objects 
and the global <span class="geshifilter"><code class="lua 
geshifilter-lua">Runtime</code></span> object. In both cases, you will 
have to manually dispatch the event yourself using the following <i>object</i>
 method:</p>

<p>&nbsp;</p>
<h4 id="object:dispatchEvent_event_">object:dispatchEvent( event )</h4>
<p>Dispatches <span class="geshifilter"><code class="lua 
geshifilter-lua">event</code></span> to <span class="geshifilter"><code 
class="lua geshifilter-lua">object</code></span>. The <span 
class="geshifilter"><code class="lua geshifilter-lua">event</code></span>
 parameter must be a table with a name property which is a string 
identifying the type of event. The <span class="geshifilter"><code 
class="lua geshifilter-lua">object</code></span> parameter must be 
either a display object or the global <span class="geshifilter"><code 
class="lua geshifilter-lua">Runtime</code></span> object. If object has a
 listener registered to receive name events. We recommend you also 
include a <span class="geshifilter"><code class="lua geshifilter-lua">target</code></span>
 property to the event so that your listener can know which object 
received the event.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="co1">-- Create an object that listens to events</span>
<span class="kw1">local</span> image <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"image.png"</span> <span class="br0">)</span>
&nbsp;
<span class="co1">-- Setup listener</span>
<span class="kw1">local</span> myListener <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Event "</span> .. event.name <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Target has width: "</span> .. event.target.stageWidth <span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
image:addEventListener<span class="br0">(</span> <span class="st0">"myEventType"</span>, myListener <span class="br0">)</span>
&nbsp;
<span class="co1">-- Sometime later, create an event and dispatch it</span>
<span class="kw1">local</span> event <span class="sy0">=</span> <span class="br0">{</span> name<span class="sy0">=</span><span class="st0">"myEventType"</span>, target<span class="sy0">=</span>image <span class="br0">}</span>
image:dispatchEvent<span class="br0">(</span> event <span class="br0">)</span></pre></div></div>
  </div>
<div id="node-1197" class="section-2">
  <h1 class="book-heading">Files</h1>
  <p>Applications are sandboxed meaning your files (e.g. application 
images, data, preferences) are stored in a location that no other 
application can access. Your files will reside in an app-specific 
directory for documents, resources, or temporary files.</p>
<br>

<h3 id="Getting_Paths_to_Files">Getting Paths to Files</h3>

<p>The paths to these files are unique to your application. To create 
file paths, you use the <span class="geshifilter"><code class="lua 
geshifilter-lua">system.pathForFile <span class="kw1">function</span></code></span>.
 The following generates an <em>absolute path</em> to the icon file for 
your application using the application’s resource directory as the base 
directory for <span class="geshifilter"><code class="lua 
geshifilter-lua">Icon.png</code></span>:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"Icon.png"</span>, system.ResourceDirectory <span class="br0">)</span></pre></div></div>

<p>In general, your files must reside in one of 3 possible base 
directories:</p>
<ul><li>	<span class="geshifilter"><code class="lua geshifilter-lua">system.DocumentsDirectory</code></span>
 should be used for files that need to persist between application 
sessions. </li>
<li>	<span class="geshifilter"><code class="lua geshifilter-lua">system.TemporaryDirectory</code></span>
 is a temporary directory. Files written to this directory are not 
guaranteed to exist in subsequent application sessions. They may or may 
not exist.</li>
<li>	<span class="geshifilter"><code class="lua geshifilter-lua">system.ResourceDirectory</code></span>
 is the directory where all application assets exist. Note: you should <strong>never</strong>
 create, modify, or add files to this directory (see <a 
href="http://developer.anscamobile.com/Beware_Security_Violations">Beware
 Security Violations</a>).</li>
</ul>
<br>

<h3 id="Reading_Files">Reading Files</h3>

<p>To read files, you use the <span class="geshifilter"><code class="lua
 geshifilter-lua"><span class="kw1">io</span></code></span> library 
provided by Lua. That library allows you to open files given an absolute
 path. Here’s an example of how to open a file and read all its 
contents.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"data.txt"</span>, system.DocumentsDirectory <span class="br0">)</span>
<span class="kw1">local</span> file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"r"</span> <span class="br0">)</span>
<span class="kw1">if</span> file <span class="kw1">then</span> <span class="co1">-- nil if no file found</span>
&nbsp; &nbsp;<span class="kw1">local</span> contents <span class="sy0">=</span> file:<span class="kw1">read</span><span class="br0">(</span> <span class="st0">"*a"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Contents of "</span> .. path .. <span class="st0">"<span class="es0">\n</span>"</span> .. contents <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>

<p>In this example, we assume that a file “data.txt” exists in the 
documents directory. The function <span class="geshifilter"><code 
class="lua geshifilter-lua"><span class="kw1">io.open</span></code></span>
 creates a file object in which several object methods are available. We
 use the object method <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">read</span></code></span> to obtain 
the contents of the file as a string. At the end, we tell Lua that we 
are done with the file using the function <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">io.open</span></code></span>
 to close the file. After that point, the variable file is no longer a 
valid file object.</p>
<br>

<h3 id="Writing_Files">Writing Files</h3>

<p>To write files, you follow many of the same steps as reading a file. 
Instead of using a read method, you write data (strings or numbers) to a
 file. Here’s an example that builds on the previous. It looks for the 
file <span class="geshifilter"><code class="lua geshifilter-lua">data.txt</code></span>
 and reads it as before; however if it does not exist, then a file is 
created. Note the addition of hard line breaks (paragraph breaks) using 
the special  <span class="geshifilter"><code class="lua geshifilter-lua">\n</code></span>
 character.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"data.txt"</span>, system.DocumentsDirectory <span class="br0">)</span>
&nbsp;
<span class="co1">-- io.open opens a file at path. returns nil if no file found</span>
<span class="kw1">local</span> file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"r"</span> <span class="br0">)</span>
<span class="kw1">if</span> file <span class="kw1">then</span>
&nbsp; &nbsp;<span class="co1">-- read all contents of file into a string</span>
&nbsp; &nbsp;<span class="kw1">local</span> contents <span class="sy0">=</span> file:<span class="kw1">read</span><span class="br0">(</span> <span class="st0">"*a"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Contents of "</span> .. path .. <span class="st0">"<span class="es0">\n</span>"</span> .. contents <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">else</span>
&nbsp; &nbsp;<span class="co1">-- create file b/c it doesn't exist yet</span>
&nbsp; &nbsp;file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"w"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">local</span> numbers <span class="sy0">=</span> <span class="br0">{</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span>,<span class="nu0">5</span>,<span class="nu0">6</span>,<span class="nu0">7</span>,<span class="nu0">8</span>,<span class="nu0">9</span><span class="br0">}</span>
&nbsp; &nbsp;file:<span class="kw1">write</span><span class="br0">(</span> <span class="st0">"Feed me data!<span class="es0">\n</span>"</span>, numbers<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>, numbers<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>, <span class="st0">"<span class="es0">\n</span>"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">for</span> _,v <span class="kw1">in</span> <span class="kw1">ipairs</span><span class="br0">(</span> numbers <span class="br0">)</span> <span class="kw1">do</span> file:<span class="kw1">write</span><span class="br0">(</span> v, <span class="st0">" "</span> <span class="br0">)</span> <span class="kw1">end</span>
&nbsp; &nbsp;file:<span class="kw1">write</span><span class="br0">(</span> <span class="st0">"<span class="es0">\n</span>No more data<span class="es0">\n</span>"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<br>

<h3 id="Beware_Security_Violations">Beware Security Violations</h3>

<p>Every time your application is launched, the integrity of the 
application is verified. It must be the same as the original file that 
was installed. If the integrity check fails, your app will not launch. 
Therefore, you should <strong>never</strong> create, modify, or write to
 files in the resources directory (see <span class="geshifilter"><code 
class="lua geshifilter-lua">system.ResourceDirectory</code></span> in <a
 
href="http://developer.anscamobile.com/system-library#System-defined_directories">System-Defined
 Directories</a>). </p>
<br>

<h3 id="Input_and_Output_Syntax">Input and Output Syntax</h3>

<p>The I/O library provides two different styles for file manipulation. 
The first one implicitly operates on a default file object; that is, 
there are operations to set a default input file and a default output 
file, and all input/output operations are over these default files. The 
second style uses explicit file objects.</p>
<p>When using implicit file descriptors, all operations are supplied by 
table io. When using explicit file descriptors, the operation <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">io.open</span></code></span>
 returns a file descriptor and then all operations are supplied as 
methods of the file descriptor.</p>
<p>The table io also provides three predefined file descriptors with 
their usual meanings from C: <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">io.stdin</span></code></span>, <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">io.stdout</span></code></span>,
 and <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="kw1">io.stderr</span></code></span>. The I/O library never closes
 these files.</p>
<p>Unless otherwise stated, all I/O functions return nil on failure 
(plus an error message as a second result and a system-dependent error 
code as a third result) and some value different from nil on success.</p>
<br>

<h3 id="File_paths">File paths</h3>
<p>For security reasons, you can only open files in your application's 
sandbox. The io library requires you to supply paths to these files. To 
do so, you use <span class="geshifilter"><code class="lua 
geshifilter-lua">system.pathForFile</code></span>.</p>
<p>Here's an example of how to open an existing file or create one if it
 does not already exist:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"data.txt"</span>, system.DocumentsDirectory <span class="br0">)</span>
&nbsp;
<span class="co1">-- io.open opens a file at path. returns nil if no file found</span>
<span class="kw1">local</span> file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"r"</span> <span class="br0">)</span>
<span class="kw1">if</span> file <span class="kw1">then</span>
&nbsp; &nbsp;<span class="co1">-- read all contents of file into a string</span>
&nbsp; &nbsp;<span class="kw1">local</span> contents <span class="sy0">=</span> file:<span class="kw1">read</span><span class="br0">(</span> <span class="st0">"*a"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Contents of "</span> .. path .. <span class="st0">"<span class="es0">\n</span>"</span> .. contents <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">else</span>
&nbsp; &nbsp;<span class="co1">-- create file b/c it doesn't exist yet</span>
&nbsp; &nbsp;file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"w"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">local</span> numbers <span class="sy0">=</span> <span class="br0">{</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span>,<span class="nu0">5</span>,<span class="nu0">6</span>,<span class="nu0">7</span>,<span class="nu0">8</span>,<span class="nu0">9</span><span class="br0">}</span>
&nbsp; &nbsp;file:<span class="kw1">write</span><span class="br0">(</span> <span class="st0">"Feed me data!<span class="es0">\n</span>"</span>, numbers<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>, numbers<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>, <span class="st0">"<span class="es0">\n</span>"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">for</span> _,v <span class="kw1">in</span> <span class="kw1">ipairs</span><span class="br0">(</span> numbers <span class="br0">)</span> <span class="kw1">do</span> file:<span class="kw1">write</span><span class="br0">(</span> v, <span class="st0">" "</span> <span class="br0">)</span> <span class="kw1">end</span>
&nbsp; &nbsp;file:<span class="kw1">write</span><span class="br0">(</span> <span class="st0">"<span class="es0">\n</span>No more data<span class="es0">\n</span>"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<br>

<h3 id="Implicit_default_file_manipulation">Implicit (default) file 
manipulation</h3>

<h4 id="io.close_file">io.close ([file])</h4>
<p>Equivalent to file:close(). Without a file, closes the default output
 file.</p>

<h4 id="io.flush_">io.flush ()</h4>
<p>Equivalent to file:flush over the default output file.</p>

<h4 id="io.input_file">io.input ([file])</h4>
<p>When called with a file name, it opens the named file (in text mode),
 and sets its handle as the default input file. When called with a file 
handle, it simply sets this file handle as the default input file. When 
called without parameters, it returns the current default input file.</p>
<p>In case of errors this function raises the error, instead of 
returning an error code.</p>

<h4 id="io.lines_filename">io.lines ([filename])</h4>
<p>Opens the given file name in read mode and returns an iterator 
function that, each time it is called, returns a new line from the file.
 Therefore, the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> line <span class="kw1">in</span> <span class="kw1">io.lines</span><span class="br0">(</span>filename<span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all lines of the file. When the iterator function 
detects the end of file, it returns nil (to finish the loop) and 
automatically closes the file.</p>
<p>The call io.lines() (with no file name) is equivalent to 
io.input():lines(); that is, it iterates over the lines of the default 
input file. In this case it does not close the file when the loop ends.</p>

<h4 id="io.open_filename_mode">io.open (filename [, mode])</h4>
<p>This function opens a file, in the mode specified in the string mode.
 It returns a new file handle, or, in case of errors, nil plus an error 
message.</p>
<p>The mode string can be any of the following:</p>
<p>"r": read mode (the default);</p>
<p>"w": write mode;</p>
<p>"a": append mode;</p>
<p>"r+": update mode, all previous data is preserved;</p>
<p>"w+": update mode, all previous data is erased;</p>
<p>"a+": append update mode, previous data is preserved, writing is only
 allowed at the end of file.</p>
<p>The mode string can also have a 'b' at the end, which is needed in 
some systems to open the file in binary mode. This string is exactly 
what is used in the standard&nbsp;C function fopen.</p>

<h4 id="io.output_file">io.output ([file])</h4>
<p>Similar to <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">io.input</span></code></span>, but 
operates over the default output file.</p>

<h4 id="io.popen_prog_mode">io.popen (prog [, mode])</h4>
<p>Starts program prog in a separated process and returns a file handle 
that you can use to read data from this program (if mode is "r", the 
default) or to write data to this program (if mode is "w").</p>
<p>This function is system dependent and is not available on all 
platforms.</p>

<h4 id="io.read_...">io.read (...)</h4>
<p>Equivalent to io.input():read.</p>

<h4 id="io.tmpfile_">io.tmpfile ()</h4>
<p>Returns a handle for a temporary file. This file is opened in update 
mode and it is automatically removed when the program ends.</p>

<h4 id="io.type_obj">io.type (obj)</h4>
<p>Checks whether obj is a valid file handle. Returns the string "file" 
if obj is an open file handle, "closed file" if obj is a closed file 
handle, or nil if obj is not a file handle.</p>

<h4 id="io.write_...">io.write (...)</h4>
<p>Equivalent to io.output():write.</p>
<br>

<h3 id="Explicit_file_manipulation">Explicit file manipulation</h3>

<p>You create a file object using the object returned by the function 
io.open. Note the use of colon ':' indicating that all operations are on
 the object (see Object Methods).</p>

<h4 id="file:close_">file:close ()</h4>
<p>Closes file. Note that files are automatically closed when their 
handles are garbage collected, but that takes an unpredictable amount of
 time to happen.</p>

<h4 id="file:flush_">file:flush ()</h4>
<p>Saves any written data to file.</p>

<h4 id="file:lines_">file:lines ()</h4>
<p>Returns an iterator function that, each time it is called, returns a 
new line from the file. Therefore, the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> line <span class="kw1">in</span> file:lines<span class="br0">(</span><span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all lines of the file. (Unlike io.lines, this 
function does not close the file when the loop ends.)</p>

<h4 id="file:read_...">file:read (...)</h4>
<p>Reads the file file, according to the given formats, which specify 
what to read. For each format, the function returns a string (or a 
number) with the characters read, or nil if it cannot read data with the
 specified format. When called without formats, it uses a default format
 that reads the entire next line (see below).</p>
<p>The available formats are</p>
<p>"*n": reads a number; this is the only format that returns a number 
instead of a string.</p>
<p>"*a": reads the whole file, starting at the current position. On end 
of file, it returns the empty string.</p>
<p>"*l": reads the next line (skipping the end of line), returning nil 
on end of file. This is the default format.</p>
<p>number: reads a string with up to this number of characters, 
returning nil on end of file. If number is zero, it reads nothing and 
returns an empty string, or nil on end of file.</p>

<h4 id="file:seek_whence_offset">file:seek ([whence] [, offset])</h4>
<p>Sets and gets the file position, measured from the beginning of the 
file, to the position given by offset plus a base specified by the 
string whence, as follows:</p>
<p>"set": base is position 0 (beginning of the file);</p>
<p>"cur": base is current position;</p>
<p>"end": base is end of file;</p>
<p>In case of success, function seek returns the final file position, 
measured in bytes from the beginning of the file. If this function 
fails, it returns nil, plus a string describing the error.</p>
<p>The default value for whence is "cur", and for offset is 0. 
Therefore, the call file:seek() returns the current file position, 
without changing it; the call file:seek("set") sets the position to the 
beginning of the file (and returns 0); and the call file:seek("end") 
sets the position to the end of the file, and returns its size.</p>

<h4 id="file:setvbuf_mode_size">file:setvbuf (mode [, size])</h4>
<p>Sets the buffering mode for an output file. There are three available
 modes:</p>
<p>"no": no buffering; the result of any output operation appears 
immediately.</p>
<p>"full": full buffering; output operation is performed only when the 
buffer is full (or when you explicitly flush the file (see io.flush)).</p>
<p>"line": line buffering; output is buffered until a newline is output 
or there is any input from some special files (such as a terminal 
device).</p>
<p>For the last two cases, size specifies the size of the buffer, in 
bytes. The default is an appropriate size.</p>

<h4 id="file:write_...">file:write (...)</h4>
<p>Writes the value of each of its arguments to the file. The arguments 
must be strings or numbers. To write other values, use tostring or 
string.format before write.</p>
  </div>
<div id="node-936" class="section-2">
  <h1 class="book-heading">Graphics (Images, Shapes, and Text)</h1>
  <p>All drawing that occurs on the screen is accomplished by creating <span
 class="geshifilter"><code class="lua geshifilter-lua">DisplayObjects</code></span>.
 Anything that appears on the screen is an instance of a <span 
class="geshifilter"><code class="lua geshifilter-lua">DisplayObject</code></span>.
 You don’t actually create these objects directly. Instead, you create 
special kinds of <span class="geshifilter"><code class="lua 
geshifilter-lua">DisplayObject</code></span> such as rectangles, 
circles, images, text, etc.</p>
<p>These objects are all first-class citizens. You can animate them, 
turn them into buttons, etc. </p>
<p>You create a <span class="geshifilter"><code class="lua 
geshifilter-lua">DisplayObject</code></span> by calling a special kind 
of function called a constructor. This implicitly adds the object above 
all other objects you have created. <span class="geshifilter"><code 
class="lua geshifilter-lua">DisplayObjects</code></span> are designed to
 organize common functionality, but you never create a <span 
class="geshifilter"><code class="lua geshifilter-lua">DisplayObject</code></span>
 explicitly. </p>
<p>Instead, there are constructors for each specific kind of <span 
class="geshifilter"><code class="lua geshifilter-lua">DisplayObject</code></span>,
 e.g. <span class="geshifilter"><code class="lua geshifilter-lua">display.newRect<span
 class="br0">(</span><span class="br0">)</span></code></span> creates a 
VectorObject. </p>
<p> All display object constructors implicitly set the parent of the new
 objects to be the current stage object.</p>
<p>All instances of <span class="geshifilter"><code class="lua 
geshifilter-lua">DisplayObject</code></span> behave like normal Lua 
tables. This means you can add your own properties to the object as long
 as they don’t conflict with the properties and method names below. 
Group objects (and stage objects) have some slight quirks as discussed 
below.</p>
<p>In addition, all display objects have the following properties and 
object methods in <strong>common</strong>:</p>
<h3 id="Common_Properties">Common Properties</h3>
<p>Properties are accessed via the dot operator. For example, if we have
 a <span class="geshifilter"><code class="lua geshifilter-lua">DisplayObject</code></span>
 represented by the variable <span class="geshifilter"><code class="lua 
geshifilter-lua">object</code></span>, we can change its alpha to 50%: <span
 class="geshifilter"><code class="lua geshifilter-lua">object.alpha<span
 class="sy0">=</span><span class="nu0">0.5</span></code></span>.</p>
<p>Below are the common properties shared by all display objects.</p>
<h5 id="object.alpha">object.alpha</h5>
<p><strong>object.alpha</strong> is the object's opacity. A value of 0 
is transparent and 1.0 is opaque.</p>
<p>Note that this is a different alpha property than the optional 
"alpha" component found in each color specification of the form (r, g, b
 [, a]). In the latter case, the alpha range is 0-255, just like the 
red, green and blue ranges, because the resulting value set specifies a 
32-bit color with 8 bits per channel.</p>
<h5 id="object.height">object.height</h5>
<p><strong>object.height</strong> is in local coordinates</p>
<h5 id="object.isVisible_">object.isVisible </h5>
<p><strong>object.isVisible </strong>controls whether the object is 
visible on the screen.</p>
<h5 id="object.isHitTestable">object.isHitTestable</h5>
<p><strong>object.isHitTestable</strong> allows an object to continue to
 receive <u>hit events</u> even if it is not visible. If <strong>true</strong>,
 objects will receive hit events regardless of visibility; if <strong>false</strong>,
 events are only sent to visible objects.</p>
<h5 id="object.length">object.length</h5>
<p><strong>object.length</strong> [read-only] is deprecated in favor of <span
 class="geshifilter"><code class="lua geshifilter-lua">group.numChildren</code></span>.
 For Group Objects, this is the number of children; 0 otherwise. </p>
<h5 id="object.parent">object.parent</h5>
<p><strong>object.parent</strong> [read-only]</p>
<h5 id="object.rotation">object.rotation</h5>
<p><strong>object.rotation</strong> is in local coordinates</p>
<h5 id="object.stageBounds">object.stageBounds</h5>
<p><strong>object.stageBounds</strong> is a table with properties <span 
class="geshifilter"><code class="lua geshifilter-lua">xMin</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">xMax</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">yMin</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">yMax</code></span>
 in screen coordinates.</p>
<h5 id="object.stageHeight">object.stageHeight</h5>
<p><strong>object.stageHeight</strong> is the height in screen 
coordinates.</p>
<h5 id="object.stageWidth">object.stageWidth</h5>
<p><strong>object.stageWidth</strong> is the width in screen 
coordinates.</p>
<h5 id="object.width">object.width</h5>
<p><strong>object.width</strong> is in local coordinates</p>
<h5 id="object.x">object.x</h5>
<p><strong>object.x</strong> specifies the x-position (in local 
coordinates) of the object relative to the parent — the parent’s origin 
to be precise. Specifically, it provides the x-position of the object’s 
reference point relative to the parent. Changing the value of this will 
move the object in the x-direction.</p>
<h5 id="object.xOrigin">object.xOrigin</h5>
<p><strong>object.xOrigin</strong> specifies the x-position of the 
object’s origin relative to the parent’s origin. It is in the object’s 
local coordinates. Changing the value of this will move the object in 
the x-direction.</p>
<h5 id="object.xReference">object.xReference</h5>
<p><strong>object.xReference</strong> defines the x-position of the 
reference point relative to the object’s local origin. It is relative to
 another point in the object, not to its parent. Conceptually, the 
reference point is the location about which scaling and rotations occur.
 Sometimes this is referred to as the registration point. For most 
display objects, this value defaults to 0, meaning the x-position of the
 origin and the reference point are the same. This merely defines the 
reference point, so changing the value of this property does not change 
the position of the object.</p>
<h5 id="object.xScale">object.xScale</h5>
<p><strong>object.xScale</strong> affects the local transform.</p>
<h5 id="object.y">object.y</h5>
<p><strong>object.y</strong> specifies the y-position (in local 
coordinates) of the object relative to the parent — the parent’s origin 
to be precise. Specifically, it provides the x-position of the object’s 
reference point relative to the parent. Changing the value of this will 
move the object in the y-direction.</p>
<h5 id="object.yOrigin">object.yOrigin</h5>
<p><strong>object.yOrigin</strong> specifies the y-position of the 
object’s origin relative to the parent’s origin. It is in the object’s 
local coordinates. Changing the value of this will move the object in 
the y-direction.</p>
<h5 id="object.yReference">object.yReference</h5>
<p><strong>object.yReference</strong> defines the y-position of the 
reference point relative to the object’s local origin. It is relative to
 another point in the object, not to its parent. Conceptually, the 
reference point is the location about which scaling and rotations occur.
 Sometimes this is referred to as the registration point. For most 
display objects, this value defaults to 0, meaning the y-position of the
 origin and the reference point are the same. This merely defines the 
reference point, so changing the value of this property does not change 
the position of the object.</p>
<h5 id="object.yScale">object.yScale</h5>
<p><strong>object.yScale</strong> affects the local transform.</p>
<h3 id="Common_Object_Methods">Common Object Methods</h3>
<p>Object methods are accessed via the colon operator. For example, if 
we have a <span class="geshifilter"><code class="lua geshifilter-lua">DisplayObject</code></span>
 represented by the variable object, we can translate the object 10 
pixels to the right: <span class="geshifilter"><code class="lua 
geshifilter-lua">object:translate<span class="br0">(</span> <span 
class="nu0">10</span>, <span class="nu0">0</span> <span class="br0">)</span></code></span>.
 </p>
<p>Below are the common methods shared by all display objects:</p>
<h5 id="object:getParent">object:getParent()</h5>
<p><strong>object:getParent()</strong> is deprecated in favor or 
object.parent. (Yes, you should ignore the fact that sample code 
continues to use this API).</p>
<h5 id="object:rotate_">object:rotate(  )</h5>
<p><strong>object:rotate( deltaAngle )</strong> effectively adds 
deltaAngle to the rotation property.</p>
<h5 id="object:scale_">object:scale(  )</h5>
<p><strong>object:scale( sx, sy )</strong> effectively multiplies xScale
 and yScale properties by sx and sy respectively.</p>
<h5 id="object:setReferencePoint_">object:setReferencePoint(  )</h5>
<p><strong>object:setReferencePoint( referencePoint )</strong> sets the 
reference point either to the center of the object (default) or to one 
of several convenient points along the bounding box of the object. The 
argument <span class="geshifilter"><code class="lua geshifilter-lua">referencePoint</code></span>
 should be one of: </p>
<ul>
  <li> display.CenterReferencePoint</li>
  <li> display.TopLeftReferencePoint</li>
  <li> display.TopCenterReferencePoint</li>
  <li> display.TopRightReferencePoint</li>
  <li> display.CenterRightReferencePoint</li>
  <li> display.BottomRightReferencePoint</li>
  <li> display.BottomCenterReferencePoint</li>
  <li> display.BottomLeftReferencePoint</li>
  <li> display.CenterLeftReferencePoint</li>
</ul>
<h5 id="object:translate_deltaX_deltaY_">object:translate( deltaX, 
deltaY ) </h5>
<p><strong>object:translate( deltaX, deltaY )</strong> effectively adds <span
 class="geshifilter"><code class="lua geshifilter-lua">deltaX</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">deltaY</code></span>
 to the x and y properties respectively.</p>
<h3 id="Images">Images</h3>
<p>Image objects are a type of <span class="geshifilter"><code 
class="lua geshifilter-lua">DisplayObject</code></span>.</p>
<h4 id="Constructor">Constructor</h4>
<h5 id="display.newImage_">display.newImage(  )</h5>
<p><strong>display.newImage( filename [, baseDirectory] [, left, top] ) </strong>Returns
 an image object. It loads the image data from filename and by default 
looks in the <span class="geshifilter"><code class="lua geshifilter-lua">system.ResourceDirectory</code></span>
 for that file. If you specify the argument <span class="geshifilter"><code
 class="lua geshifilter-lua">baseDirectory</code></span> it will look in
 that directory instead (see <a 
href="http://developer.anscamobile.com/system-library#system.pathForFile_filename_baseDirectory_">system.pathForFile</a>
 for valid values of baseDirectory). </p>
<p>You can specify that the image’s top-left corner be located at the 
coordinate <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="br0">(</span>left, top<span class="br0">)</span></code></span>; 
if you don’t supply both coordinates, the image will be centered about 
its local origin. </p>
<p>The local origin is at the center of the image; the reference point 
is initialized to this point.</p>
<h4 id="Image_Autoscaling">Image Autoscaling</h4>
<p>The default behavior of <span class="geshifilter"><code class="lua 
geshifilter-lua">display.newImage<span class="br0">(</span><span 
class="br0">)</span></code></span> is to auto-scale large images. This 
is to conserve texture memory. However, there are times when you do not 
want to have images auto-scaled, and there is an optional boolean flag 
in the parameter list to control this manually.</p>
<p>To override autoscaling and show the image at its full-resolution, 
use the optional <span class="geshifilter"><code class="lua 
geshifilter-lua">isFullResolution</code></span> parameter. By default, 
it is false, but if you specify true, then the new image is loaded at 
its full resolution:</p>
<p><strong>display.newImage( [parentGroup,] filename [, baseDirectory] 
[, x, y] [,isFullResolution] )</strong></p>
<span class="geshifilter"><code class="lua geshifilter-lua">&nbsp;myImage
 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span
 class="st0">"image.png"</span>, <span class="nu0">10</span>, <span 
class="nu0">20</span>, <span class="kw1">true</span> <span class="br0">)</span>
 </code></span>
<p>Limitations:</p>
<ul>
  <li> Images will still be autoscaled if they are larger than the 
maximum possible texture dimensions of the device. This is usually 
1024x1024 (iPhone 3G) or 2048x2048 (iPhone 3GS, iPad).</li>
  <li> If you reload the same image multiple times, the subsequent calls
 to display.newImage ignore the isFullResolution parameter and take on 
the value passed the first time. In other words, the way you load an 
image file the first time affects the auto-scaling setting the next time
 you load that same file. This is because Corona conserves texture 
memory by automatically re-using a texture that has already been loaded.
 As a result, you can use the same images as many times as you want 
without consuming additional texture memory.</li>
</ul>
<h3 id="Vector_Objects">Vector Objects</h3>
<p>Vector objects are a special type of <span class="geshifilter"><code 
class="lua geshifilter-lua">DisplayObject</code></span>. In addition to 
the properties and methods of Display Object</p>
<h4 id="Constructor-1">Constructor</h4>
<p>The following return Lua tables representing rectangle, rounded 
rectangle, and circle, respectively:</p>
<h5 id="display.newRect_">display.newRect( ) </h5>
<p><strong>display.newRect( left, top, width, height )</strong> creates a
 width by height rectangle with the top-left corner at <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="br0">(</span>left,
 top<span class="br0">)</span></code></span>. The local origin is at the
 center of the rectangle; the reference point is initialized to this 
local origin. By default, there is no fill or stroke color.</p>
<h5 id="display.newRoundedRect_">display.newRoundedRect(  )</h5>
<p><strong>display.newRoundedRect( left, top, width, height, 
cornerRadius )</strong> creates a <span class="geshifilter"><code 
class="lua geshifilter-lua">width</code></span> by <span 
class="geshifilter"><code class="lua geshifilter-lua">height</code></span>
 rounded rectangle with the top-left corner at <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="br0">(</span>left, top<span 
class="br0">)</span></code></span>. The corners are rounded by quarter 
circles of radius <span class="geshifilter"><code class="lua 
geshifilter-lua">cornerRadius</code></span>. The local origin is at the 
center of the rectangle; the reference point is initialized to this 
local origin. By default, there is no fill or stroke color.</p>
<h5 id="display.newCircle_">display.newCircle( ) </h5>
<p><strong>display.newCircle( xCenter, yCenter, radius )</strong> 
creates a circle with radius <span class="geshifilter"><code class="lua 
geshifilter-lua">radius</code></span> centered at <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="br0">(</span>xCenter,
 yCenter<span class="br0">)</span></code></span>. The local origin is at
 the center of the circle; the reference point is initialized to this 
local origin. By default, there is no fill or stroke color.</p>
<h4 id="Properties">Properties</h4>
<h5 id="object.strokeWidth">object.strokeWidth</h5>
<p>Sets the stroke width in pixels. Note that stroke widths are broken 
up to inner and outer parts.  The stroke is centered on the boundaries 
of the object, but when the stroke width is odd, Corona does an integer 
divide by 2 (e.g. 3 / 2 = 1; 1 / 2 = 0) and set the inner width to that;
 the remainder is the outer width. This avoids blurring around the edges
 of the stroke. For example, a stroke width of 3 results in an inner 
width of 1 and an outer width of 2.</p>
<p>One specific consequence is that if a rectangle fills the screen, a 
stroke width of 1 will be drawn entirely offscreen. Also, adding a 
stroke increases the width and height of the object by twice the amount 
of the outer stroke.</p>
<h4 id="Object_Methods">Object Methods</h4>
<p>Vector objects have the following additional methods:</p>
<h5 id="object:setFillColor_">object:setFillColor(  )</h5>
<p><strong>object:setFillColor( r, g, b [, a] )</strong> All components 
must be between 0 and 255. Alpha is optional and is 255 (opaque) by 
default.</p>
<h5 id="object:setStrokeColor_">object:setStrokeColor( ) </h5>
<p><strong>object:setStrokeColor( r, g, b [, a] )</strong> All 
components must be between 0 and 255. Alpha is optional and is 255 
(opaque) by default.</p>
<h3 id="Polylines">Polylines</h3>
<h5 id="display.newLine_">display.newLine( )</h5>
<img src="api-reference_files/polylines.png" alt="Polylines">
<p>The Polylines API draws connected line segments, with any color and 
stroke width, using the Corona vector engine. The resulting object is a 
standard Corona display object, and can be independently moved and 
scaled like any other display object. The stroke and color properties 
can also be changed after the object has been drawn.</p>
<p>Polylines are a series of vertices specifying endpoints of line 
segments. The lines have a stroke width, specified in a "width" 
parameter. Currently, multiple line segments have miter joins. In other 
words, an angle joint comes to a point, as opposed to being rounded. The
 start and end have butt caps.</p>
<p><i>(This API is under development, and may evolve.)</i></p>
<p>The current API is as follows:</p>
<p><strong>local a = display.newLine( [parent,] x1,y1, x2,y2 )
  a:setColor( r, g, b, a )
  a:append( x, y [,... ] )
  a.width = strokeWidth </strong></p>
<p>Code example:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp;<span class="kw1">local</span> star <span class="sy0">=</span> display.newLine<span class="br0">(</span> <span class="nu0">0</span>,-<span class="nu0">110</span>, <span class="nu0">27</span>,-<span class="nu0">35</span> <span class="br0">)</span>
&nbsp; star:append<span class="br0">(</span> <span class="nu0">105</span>,-<span class="nu0">35</span>, <span class="nu0">43</span>,<span class="nu0">16</span>, <span class="nu0">65</span>,<span class="nu0">90</span>, <span class="nu0">0</span>,<span class="nu0">45</span>, -<span class="nu0">65</span>,<span class="nu0">90</span>, -<span class="nu0">43</span>,<span class="nu0">15</span>, -<span class="nu0">105</span>,-<span class="nu0">35</span>, -<span class="nu0">27</span>,-<span class="nu0">35</span>, <span class="nu0">0</span>,-<span class="nu0">110</span> <span class="br0">)</span>
&nbsp; star:setColor<span class="br0">(</span> <span class="nu0">255</span>, <span class="nu0">102</span>, <span class="nu0">102</span>, <span class="nu0">255</span> <span class="br0">)</span>
&nbsp; star.width <span class="sy0">=</span> <span class="nu0">3</span> </pre></div></div>
<p>See the <strong>Graphics/PolyLines</strong> sample code for an 
animated demo that runs on iPhone and iPad.</p>
<h3 id="Text">Text</h3>
<h4 id="Constructor-2">Constructor</h4>
<h5 id="display.newText_">display.newText( )</h5>
<p><strong>display.newText( string, x, y, font, size )</strong> creates a
 text object with its top-left corner at (x, y). The local origin is at 
the center of the text; the reference point is initialized to this local
 origin. By default, there is no text color.</p>
<p>The <span class="geshifilter"><code class="lua geshifilter-lua">font</code></span>
 parameter is a string that names the font. You can obtain an array of 
available fonts via <span class="geshifilter"><code class="lua 
geshifilter-lua">native.getFontNames<span class="br0">(</span><span 
class="br0">)</span> </code></span>. Alternatively, you can also pass 
the following constants instead of a string:</p>
<ul>
  <li> <strong>native.systemFont</strong>
  </li><li> <strong>native.systemFontBold</strong>
</li></ul>
<h4 id="Properties-3">Properties</h4>
<h5 id="object.text">object.text</h5>
<p><strong>object.text</strong> is a string that contains the text of 
the textfield</p>
<h5 id="object.size">object.size</h5>
<p><strong>object.size</strong> is the size of the text</p>
<h4 id="Object_Methods-4">Object Methods</h4>
<p>Text objects have the following additional methods:</p>
<h5 id="object:setTextColor_">object:setTextColor( )</h5>
<p><strong>object:setTextColor( r, g, b [, a] )</strong> All components 
must be between 0 and 255. Alpha is optional and is 255 (opaque) by 
default.</p>
<h3 id="Groups">Groups</h3>
<p>Group objects are a special type of <span class="geshifilter"><code 
class="lua geshifilter-lua">DisplayObject</code></span>. You can add 
other display objects as children of a group object. You can also remove
 them. Even if an object is not visible, it remains in the group object 
until explicitly removed. Thus, to minimize memory consumption, you 
should explicitly remove any object that will no longer be used.</p>
<p>All objects are implicitly added to the current stage which itself is
 a kind of group object.</p>
<p>The children of group objects are simply other display objects 
(vector, groups, etc.). They are accessed by integer index. The first 
child is at index 1. Note that the Lua <span class="geshifilter"><code 
class="lua geshifilter-lua"><span class="kw1">table</span></code></span>
 library functions such as <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="br0">(</span><span class="kw1">table.insert</span><span
 class="br0">)</span></code></span> are <strong>incompatible</strong> 
with groups.</p>
<h4 id="Constructor-5">Constructor</h4>
<h5 id="display.newGroup">display.newGroup()</h5>
<p><strong>display.newGroup()</strong> creates a group in which you can 
add and remove child display objects. Initially, there are no children 
in a group. The local origin is at the parent’s origin; the reference 
point is initialized to this local origin. </p>
<h4 id="Properties-6">Properties</h4>
<h5 id="group.numChildren">group.numChildren</h5>
<p><strong>group.numChildren</strong> returns the number of children. 
You access the children by integer index:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp;<span class="kw1">local</span> group <span class="sy0">=</span> display.newGroup<span class="br0">(</span><span class="br0">)</span>
&nbsp; group:insert<span class="br0">(</span> rect1 <span class="br0">)</span> <span class="co1">-- assume rect1 is an existing display object</span>
&nbsp; group:insert<span class="br0">(</span> rect2 <span class="br0">)</span> <span class="co1">-- assume rect2 is an existing display object</span>
&nbsp; 
&nbsp; <span class="kw1">for</span> i<span class="sy0">=</span><span class="nu0">1</span>,group.numChildren <span class="kw1">do</span>
&nbsp; <span class="kw1">local</span> child <span class="sy0">=</span> group<span class="br0">[</span>i<span class="br0">]</span>
&nbsp; <span class="kw1">local</span> description <span class="sy0">=</span> <span class="br0">(</span>child.isVisible <span class="kw1">and</span> <span class="st0">"visible"</span><span class="br0">)</span> <span class="kw1">or</span> <span class="st0">"not visible"</span>
&nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"child["</span>..i..<span class="st0">"] is "</span> .. description <span class="br0">)</span>
&nbsp; <span class="kw1">end</span> </pre></div></div>
<h4 id="Object_Methods-7">Object Methods</h4>
<p>Group objects have the following additional methods:</p>
<h5 id="group:insert_">group:insert(  ) </h5>
<p><strong>group:insert( [index,] child, [, resetTransform] )</strong> 
Inserts <span class="geshifilter"><code class="lua geshifilter-lua">child</code></span>
 at index into group, shifting up other elements as necessary. The 
default value index is <span class="geshifilter"><code class="lua 
geshifilter-lua">n+<span class="nu0">1</span></code></span> where <span 
class="geshifilter"><code class="lua geshifilter-lua">n</code></span> is
 the number of children in the group. The <span class="geshifilter"><code
 class="lua geshifilter-lua">resetTransform</code></span> parameter 
determines what happens to <span class="geshifilter"><code class="lua 
geshifilter-lua">child</code></span>’s transform. When <strong>false</strong>,
 <span class="geshifilter"><code class="lua geshifilter-lua">child</code></span>’s
 local position, rotation, and scale properties are preserved, except 
the local origin is now relative to the new parent group, not its former
 parent; when <strong>true</strong>, <span class="geshifilter"><code 
class="lua geshifilter-lua">child</code></span>’s transform is reset 
(i.e. the x, y, rotation, xScale, and yScale properties of <span 
class="geshifilter"><code class="lua geshifilter-lua">child</code></span>
 are reset to 0, 0, 0, 1, and 1, respectively). The default value for 
resetTransform is <strong>false</strong>. An easy way to move an object 
above its siblings is to re-insert it: <span class="geshifilter"><code 
class="lua geshifilter-lua">object.parent:insert<span class="br0">(</span>
 object <span class="br0">)</span></code></span>. </p>
<h5 id="group:remove_">group:remove(  )</h5>
<p><strong>group:remove( indexOrChild )</strong> Removes from group the 
display object specified by <span class="geshifilter"><code class="lua 
geshifilter-lua">indexOrChild</code></span>, shifting down other 
elements as needed. The argument indexOrChild is either the index 
position of the child within group or the child display object itself. 
In either case, it returns the removed display object. </p>
<h3 id="Stage">Stage</h3>
<p>Stage objects are a special type of GroupObject, so all methods and 
properties of group objects are available in stage objects. You access 
the current stage object using <span class="geshifilter"><code 
class="lua geshifilter-lua">display.getCurrentStage<span class="br0">(</span><span
 class="br0">)</span></code></span>. </p>
<p>All objects are implicitly added to the current stage which itself is
 a kind of group object.</p>
<h4 id="Object_Methods-8">Object Methods</h4>
<h5 id="stage:setFocus_">stage:setFocus(  )</h5>
<p><strong>stage:setFocus( displayObject )</strong> sets <span 
class="geshifilter"><code class="lua geshifilter-lua">displayObject</code></span>
 as the target for all future hit events. Pass <strong>nil</strong> to 
restore default behavior for hit event dispatches. This is typically 
used to implement buttons that change appearance when a user initially 
presses them.</p>
<h3 id="Other_Display_Functions">Other Display Functions</h3>
<h5 id="display.captureScreen_saveToAlbum_">display.captureScreen( 
saveToAlbum ) </h5>
<p>Captures the contents of the screen and returns it as an image object
 positioned so that the top-left of the screen is at the origin. If <span
 class="geshifilter"><code class="lua geshifilter-lua">saveToAlbum</code></span>
 is <strong>true</strong>, then it adds the image to your device’s 
album; on the simulator, it saves to the desktop.</p>
<h5 id="display.save_displayObject_filename_baseDirectory_">display.save(
 displayObject, filename [, baseDirectory] ) </h5>
<p>Renders the display object referenced by <span class="geshifilter"><code
 class="lua geshifilter-lua">displayObject</code></span> into a JPEG 
image and saves it in <span class="geshifilter"><code class="lua 
geshifilter-lua">filename</code></span>. The display object must 
currently be in the display hierarchy; otherwise no image is saved. If 
the display object is a group object, then all children are rendered. 
The argument <span class="geshifilter"><code class="lua geshifilter-lua">baseDirectory</code></span>
 is optional. It can be either <span class="geshifilter"><code 
class="lua geshifilter-lua">system.DocumentsDirectory</code></span> (the
 default) or <span class="geshifilter"><code class="lua geshifilter-lua">system.TemporaryDirectory</code></span>.</p>
<h5 id="display.setStatusBar_mode_">display.setStatusBar( mode ) </h5>
<p>Hides or changes the appearance of the status bar. The argument mode 
should be one of: </p>
<ul>
  <li> display.HiddenStatusBar</li>
  <li> display.DefaultStatusBar</li>
  <li> display.TranslucentStatusBar</li>
  <li> display.DarkStatusBar</li>
</ul>
<h4 id="Content_Size_Properties">Content Size Properties</h4>
<h5 id="display.contentWidth">display.contentWidth</h5>
<p>A read-only property representing the original width of the content 
in pixels.This will default to the screen width, but may be another 
value if you are using content scaling in <span class="geshifilter"><code
 class="lua geshifilter-lua">config.lua</code></span>.</p>
<h5 id="display.contentHeight">display.contentHeight</h5>
<p>A read-only property representing the original height of the content 
in pixels. This will default to the screen height, but may be another 
value if you are using content scaling in <span class="geshifilter"><code
 class="lua geshifilter-lua">config.lua</code></span>.</p>
<h5 id="display.statusBarHeight_">display.statusBarHeight </h5>
<p>A read-only property representing the height of the status bar in 
pixels</p>
  </div>
<div id="node-1443" class="section-2">
  <h1 class="book-heading">Math</h1>
  <p>This library is an interface to the standard C&nbsp;math library. 
It provides all its functions inside the table <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">math</span></code></span>.</p>

<h4 id="math.abs_x">math.abs (x)</h4>
<p>Returns the absolute value of x.</p>

<h4 id="math.acos_x">math.acos (x)</h4>
<p>Returns the arc cosine of x (in radians).</p>

<h4 id="math.asin_x">math.asin (x)</h4>
<p>Returns the arc sine of x (in radians).</p>

<h4 id="math.atan_x">math.atan (x)</h4>
<p>Returns the arc tangent of x (in radians).</p>

<h4 id="math.atan2_y_x">math.atan2 (y, x)</h4>
<p>Returns the arc tangent of y/x (in radians), but uses the signs of 
both parameters to find the quadrant of the result. (It also handles 
correctly the case of x being zero.)</p>

<h4 id="math.ceil_x">math.ceil (x)</h4>
<p>Returns the smallest integer larger than or equal to x.</p>

<h4 id="math.cos_x">math.cos (x)</h4>
<p>Returns the cosine of x (assumed to be in radians).</p>

<h4 id="math.cosh_x">math.cosh (x)</h4>
<p>Returns the hyperbolic cosine of x.</p>

<h4 id="math.deg_x">math.deg (x)</h4>
<p>Returns the angle x (given in radians) in degrees.</p>

<h4 id="math.exp_x">math.exp (x)</h4>
<p>Returns the value ex.</p>

<h4 id="math.floor_x">math.floor (x)</h4>
<p>Returns the largest integer smaller than or equal to x.</p>

<h4 id="math.fmod_x_y">math.fmod (x, y)</h4>
<p>Returns the remainder of the division of x by y that rounds the 
quotient towards zero.</p>

<h4 id="math.frexp_x">math.frexp (x)</h4>
<p>Returns m and e such that x = m2e, e is an integer and the absolute 
value of m is in the range [0.5, 1) (or zero when x is zero).</p>

<h4 id="math.huge">math.huge</h4>
<p>The value HUGE_VAL, a value larger than or equal to any other 
numerical value.</p>

<h4 id="math.ldexp_m_e">math.ldexp (m, e)</h4>
<p>Returns m2e (e should be an integer).</p>

<h4 id="math.log_x">math.log (x)</h4>
<p>Returns the natural logarithm of x.</p>

<h4 id="math.log10_x">math.log10 (x)</h4>
<p>Returns the base-10 logarithm of x.</p>

<h4 id="math.max_x_...">math.max (x, ...)</h4>
<p>Returns the maximum value among its arguments.</p>

<h4 id="math.min_x_...">math.min (x, ...)</h4>
<p>Returns the minimum value among its arguments.</p>

<h4 id="math.modf_x">math.modf (x)</h4>
<p>Returns two numbers, the integral part of x and the fractional part 
of x.</p>

<h4 id="math.pi">math.pi</h4>
<p>The value of pi.</p>

<h4 id="math.pow_x_y">math.pow (x, y)</h4>
<p>Returns xy. (You can also use the expression x^y to compute this 
value.)</p>

<h4 id="math.rad_x">math.rad (x)</h4>
<p>Returns the angle x (given in degrees) in radians.</p>

<h4 id="math.random_m_n">math.random ([m [, n]])</h4>
<p>This function is an interface to the simple pseudo-random generator 
function rand provided by ANSI&nbsp;C. (No guarantees can be given for 
its statistical properties.)</p>
<p>When called without arguments, returns a uniform pseudo-random real 
number in the range [0,1). When called with an integer number m, 
math.random returns a uniform pseudo-random integer in the range [1, m].
 When called with two integer numbers m and n, math.random returns a 
uniform pseudo-random integer in the range [m, n].</p>

<h4 id="math.randomseed_x">math.randomseed (x)</h4>
<p>Sets x as the "seed" for the pseudo-random generator: equal seeds 
produce equal sequences of numbers.</p>

<h4 id="math.sin_x">math.sin (x)</h4>
<p>Returns the sine of x (assumed to be in radians).</p>
<h4 id="math.sinh_x">math.sinh (x)</h4>
<p>Returns the hyperbolic sine of x.</p>
<h4 id="math.sqrt_x">math.sqrt (x)</h4>
<p>Returns the square root of x. (You can also use the expression x^0.5 
to compute this value.)</p>
<h4 id="math.tan_x">math.tan (x)</h4>
<p>Returns the tangent of x (assumed to be in radians).</p>
<h4 id="math.tanh_x">math.tanh (x)</h4>
<p>Returns the hyperbolic tangent of x.</p>
  </div>
<div id="node-1440" class="section-2">
  <h1 class="book-heading">Modules and Packages</h1>
  <p>Corona supports Lua’s module functionality for creating and loading
 external libraries. Currently, two example libraries are shipped with 
the SDK: “ui.lua” (for creating rollover buttons) and “sprite.lua” (for 
creating animated sprites, or “movieclips”).  </p>
<p>These libraries can be found in the sample projects “Button” and 
“Movieclip”, located in the Sample Code directory of the SDK. To use 
them in your own projects, copy them to your project directory.</p>
<p>You can also create Lua modules of your own, which is helpful for 
organizing large projects into multiple files, or creating reusable code
 libraries for future projects.</p>
<h3 id="Creating_external_libraries">Creating external libraries</h3>
<p>The easiest way to create a module is to use the following format, 
and save it to the same directory as your project’s main.lua file:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1">module<span class="br0">(</span>..., package.seeall<span class="br0">)</span>
&nbsp;
<span class="co1">-- Declare the functions you want in your module</span>
<span class="kw1">function</span> hello<span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span> <span class="br0">(</span><span class="st0">"Hello, module"</span><span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>The first line should be entered as shown here, including the three 
dots. Modules should be saved with a “.lua” file extension: for example,
 “testlib.lua”. </p>
<h3 id="Loading_external_libraries">Loading external libraries</h3>
<p>To load a module from your project directory, use <strong>require 
(modname)</strong> at the beginning of your main.lua file. The functions
 within the module will then be available using the format <strong>modname.functionname().</strong></p>
<p>You can optimize your main.lua by caching library functions as local 
variables:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Load external library (should be in the same folder as main.lua)</span>
<span class="kw1">local</span> testlib <span class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span class="st0">"testlib"</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- Now the functions in "testlib.lua" are available here:</span>
&nbsp;
<span class="co1">-- call the testlib library function hello(). The "slow" way</span>
testlib.hello<span class="br0">(</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- cache same function, if you call more than once</span>
<span class="kw1">local</span> hello <span class="sy0">=</span> testlib.hello
&nbsp;
<span class="co1">-- now all future invocations are "fast"</span>
hello<span class="br0">(</span><span class="br0">)</span></pre></td></tr></tbody></table></div>

<h3 id="Syntax">Syntax</h3>

<h4 id="module_name_">module (name [, ···])</h4>
<p>Creates a module. If there is a table in package.loaded[name], this 
table is the module. Otherwise, if there is a global table t with the 
given name, this table is the module. Otherwise creates a new table t 
and sets it as the value of the global name and the value of 
package.loaded[name]. This function also initializes t._NAME with the 
given name, t._M with the module (t itself), and t._PACKAGE with the 
package name (the full module name minus last component; see below). 
Finally, module sets t as the new environment of the current function 
and the new value of package.loaded[name], so that require returns t.</p>
<p>This function may receive optional options after the module name, 
where each option is a function to be applied over the module.</p>

<h4 id="require_modname">require (modname)</h4>
<p>Loads the given module. The function starts by looking into the 
package.loaded table to determine whether modname is already loaded. If 
it is, then require returns the value stored at package.loaded[modname].
 Otherwise, it tries to find a loader for the module.</p>
<p>To find a loader, require is guided by the package.loaders array. By 
changing this array, we can change how require looks for a module. The 
following explanation is based on the default configuration for 
package.loaders.</p>
<p>First, require queries package.preload[modname]. If it has a value, 
this value (which should be a function) is the loader. Otherwise require
 searches for a Lua loader using the path stored in package.path. If 
that also fails, it tries an all-in-one loader (see package.loaders).</p>
<p>Once a loader is found, require calls the loader with a single 
argument, modname. If the loader returns any value, require assigns the 
returned value to package.loaded[modname]. If the loader returns no 
value and has not assigned any value to package.loaded[modname], then 
require assigns true to this entry. In any case, require returns the 
final value of package.loaded[modname].</p>
<p>If there is any error loading or running the module, or if it cannot 
find any loader for the module, then require signals an error.</p>

<h4 id="package.loaded">package.loaded</h4>
<p>A table used by require to control which modules are already loaded. 
When you require a module modname and package.loaded[modname] is not 
false, require simply returns the value stored there.</p>

<h4 id="package.loaders">package.loaders</h4>
<p>A table used by require to control how to load modules.</p>
<p>Each entry in this table is a searcher function. When looking for a 
module, require calls each of these searchers in ascending order, with 
the module name (the argument given to require) as its sole parameter. 
The function may return another function (the module loader) or a string
 explaining why it did not find that module (or nil if it has nothing to
 say). </p>
<p>When running in the simulator, the searcher looks for Lua files that 
can serve as Lua libraries. These Lua files must be in the same 
directory as your main.lua file. As long as they are in the same 
directory as your main.lua file, they will be packaged for you during 
device builds.</p>
<h4 id="package.seeall_module">package.seeall (module)</h4>
<p>Sets a metatable for module with its __index field referring to the 
global environment, so that this module inherits values from the global 
environment. To be used as an option to function module.</p>
  </div>
<div id="node-1189" class="section-2">
  <h1 class="book-heading">Multimedia</h1>
  <p>The media library provides access to the multimedia features of the
 device.</p>

<h3 id="Audio">Audio</h3>
<p>The media library provides support for controlling playback of </p>
<ul><li><strong>event sounds</strong> are short sounds that are played 
in entirety</li>
<li><strong>extended sounds</strong> may be longer and can be paused 
during playback, but only one may be open at at time</li>
</ul>

<h3 id="Event_Sounds">Event Sounds</h3>

<p>If you have short sounds that are roughly 1-3 seconds in duration, 
you should use the event sound APIs. The following is an example of a 
metronome that plays a beep every second.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> soundID <span class="sy0">=</span> media.newEventSound<span class="br0">(</span> <span class="st0">"beep.caf"</span> <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> playBeep <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; media.playEventSound<span class="br0">(</span> soundID <span class="br0">)</span>
<span class="kw1">end</span>
timer.performWithDelay<span class="br0">(</span> <span class="nu0">1000</span>, playBeep, <span class="nu0">0</span> <span class="br0">)</span></pre></div></div>

<p>The above example demonstrates best practices when you play the same 
event sound repeatedly by only loading the event sound file once using <span
 class="geshifilter"><code class="lua geshifilter-lua">media.newEventSound</code></span>
 to load the sound file. The result of that function is a sound id that 
is passed as an argument to <span class="geshifilter"><code class="lua 
geshifilter-lua">media.playEventSound</code></span> in the <span 
class="geshifilter"><code class="lua geshifilter-lua">playBeep</code></span>
 function.</p>
<p>We could have just used <span class="geshifilter"><code class="lua 
geshifilter-lua">media.playEventSound</code></span> and always pass the 
sound file, but that would have been wasteful, because every time <span 
class="geshifilter"><code class="lua geshifilter-lua">playBeep</code></span>
 was called, we would have to load the same sound file from disk.</p>

<h4 id="media.newEventSound_soundFile_">media.newEventSound( soundFile )</h4>
<p>Loads the event sound (1-3 seconds) from <span class="geshifilter"><code
 class="lua geshifilter-lua">soundFile</code></span> and returns an 
event sound id that can be passed to media.playEventSound. Currently, 
the sound file must be in the application resources directory (see <a 
href="http://developer.anscamobile.com/system-library#System-defined_directories">System-defined
 directories</a>).</p>

<h4 id="media.playEventSound_sound_">media.playEventSound( sound )</h4>
<p>Plays an event sound (1-3 seconds). The argument <span 
class="geshifilter"><code class="lua geshifilter-lua">sound</code></span>
 can be either an event sound id or a filename for the event sound. 
Recommended for short sounds, especially to avoid animation “hiccups.” 
Returns the same thing as <span class="geshifilter"><code class="lua 
geshifilter-lua">media.newEventSound</code></span>. </p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> soundID <span class="sy0">=</span> media.newEventSound<span class="br0">(</span> <span class="st0">"beep.caf"</span> <span class="br0">)</span>
<span class="kw1">local</span> playBeep <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; media.playEventSound<span class="br0">(</span> soundID <span class="br0">)</span>
<span class="kw1">end</span>
timer.performWithDelay<span class="br0">(</span> <span class="nu0">7500</span>, playBeep, <span class="nu0">0</span> <span class="br0">)</span></pre></div></div>

<p>NOTE: On Android, there is a delay between loading a sound and when 
it is ready. <span class="geshifilter"><code class="lua geshifilter-lua">playEventSound</code></span>
 with a filename parameter is therefore not recommended and most often 
results in failure to play. Preload them with <span class="geshifilter"><code
 class="lua geshifilter-lua">newEventSound</code></span>.</p>

<h4 id="Completion_Listener">Completion Listener</h4>
<p>To call a completion listener each time the event sound is played, 
you can specify the listener in playEventSound:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp;media.playEventSound<span class="br0">(</span> <span class="st0">"beep.caf"</span>, onComplete <span class="br0">)</span></pre></div></div>


<h3 id="Extended_Sounds">Extended Sounds</h3>

<p>For longer sounds (which are generally in MP3 format on iPhoneOS, and
 often used to play background music), there are several functions that 
allow you to play, pause, and stop playing a sound. However, you can 
only have one such long sound file open at a time. These functions all 
operate on the sound that is opened by the previous call to <span 
class="geshifilter"><code class="lua geshifilter-lua">media.playSound</code></span>.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">media.playSound<span class="br0">(</span> <span class="st0">"song.mp3"</span> <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> stopAfter10Seconds <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; media.stopSound<span class="br0">(</span><span class="br0">)</span>
<span class="kw1">end</span>
timer.performWithDelay<span class="br0">(</span> <span class="nu0">10000</span>, stopAfter10Seconds <span class="br0">)</span></pre></div></div>

<p>The following functions should be used to play longer duration sound.
 You can only have one sound file open at a time.</p>

<h4 id="media.playSound_soundFile_">media.playSound( soundFile )</h4>
<h4 id="media.pauseSound">media.pauseSound()</h4>
<h4 id="media.stopSound">media.stopSound()</h4>


<h3 id="Completion_Listener-1">Completion Listener</h3>

<p>These longer sounds may also have a completion listener. This is an 
optional parameter to <span class="geshifilter"><code class="lua 
geshifilter-lua">playSound</code></span>.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> onComplete
onComplete <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"sound play ended"</span> <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; media.playSound<span class="br0">(</span> <span class="st0">"note2.mp3"</span>, onComplete <span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
media.playSound<span class="br0">(</span> <span class="st0">"note2.mp3"</span>, onComplete <span class="br0">)</span></pre></td></tr></tbody></table></div>

<p>In this example, the onComplete routine is called when <span 
class="geshifilter"><code class="lua geshifilter-lua">note2.mp3</code></span>
 finishes. This immediately goes back and re-queues the playSound, so 
this is a form of looping; however, there is a small gap between the 
playback of the sounds. </p>

<p>Also, in this example the declaration of onComplete occurs before the
 function creation, because it needs to exist to be referenced inside 
the function (otherwise Lua interprets it as a local variable, which 
isn't set, and so it doesn't do anything).</p>

<h3 id="Loop_Parameter">Loop Parameter</h3>

<p>Setting the final parameter to true causes the extended sound to 
loop:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">media.playSound<span class="br0">(</span> <span class="st0">"note2.mp3"</span>, <span class="kw1">true</span> <span class="br0">)</span></pre></div></div>

<p>It will loop until you stop it. This has less overhead than the 
onComplete method of looping, so there will be less of an audible gap 
between the end of the sound and the beginning of the next loop.</p>

<h3 id="Volume_Control">Volume Control</h3>

<p>The volume of extended sounds can now be set and accessed, with 
values ranging from 0 to 1.0. For example:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp;media.setSoundVolume<span class="br0">(</span> <span class="nu0">0.5</span> <span class="br0">)</span>
&nbsp;
&nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"volume = "</span> .. media.getSoundVolume<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span></pre></div></div>

<p>This setting can be adjusted at any time before or during the 
extended sound playback. Note that setting the <i>global</i> volume is a
 different feature, and is not currently supported.</p>
<p>Also note that event sounds do not have volume control. This is a 
limitation of the event sound API for iPhone.</p>

<h3 id="Supported_Audio_Formats">Supported Audio Formats</h3>

<p>For the iPhone:</p>

<ul>
<li>	Event sound files should be:
	<ul><li>	Short (several seconds)</li>
        <li>	In linear PCM or IMA4 (IMA/ADPCM) format</li>
        <li>	Packaged in a <span class="geshifilter"><code class="lua 
geshifilter-lua">.caf</code></span> or <span class="geshifilter"><code 
class="lua geshifilter-lua">.aif</code></span> file.</li>
        </ul>
</li>
<li>For the highest quality event sounds, use 16-bit, little endian, 
linear PCM audio data packaged in the Core Audio Format (<span 
class="geshifilter"><code class="lua geshifilter-lua">.caf</code></span>).
 On Mac OS X use the afconvert command:<p></p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>afconvert -f caff -d LEI16 <span class="br0">{</span>INPUT<span class="br0">}</span><span class="br0">{</span>OUTPUT<span class="br0">}</span></pre></div></div>
</li>
<li>	For more compact event sound files, use IMA4 format:

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>afconvert -f caff -d ima4 <span class="br0">{</span>INPUT<span class="br0">}</span><span class="br0">{</span>OUTPUT<span class="br0">}</span></pre></div></div>
</li>
<li>	For longer sounds, use <span class="geshifilter"><code class="lua 
geshifilter-lua">media.playSound<span class="br0">(</span><span 
class="br0">)</span></code></span> to play <span class="geshifilter"><code
 class="lua geshifilter-lua">.mp3</code></span> files.
</li>
</ul>


<h3 id="Video">Video</h3>

<p>Video playback relies on a device-specific popup media player. During
 video playback, the media player interface takes over. </p>
<p>An important thing to note is that <span class="geshifilter"><code 
class="lua geshifilter-lua">media.playVideo</code></span> is 
asynchronous. Once the code block is exited, the application will be 
suspended until the video playback is complete. </p>
<p>Therefore, if you want to be notified when the media player is exited
 (e.g. video finished playing or the user cancelled video playback), you
 should register a listener:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> onComplete <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"video session ended"</span> <span class="br0">)</span>
<span class="kw1">end</span>
media.playVideo<span class="br0">(</span> <span class="st0">"Movie.m4v"</span>, <span class="kw1">true</span>, onComplete <span class="br0">)</span></pre></div></div>

<p>You can also specify a remote URL for the video, rather than a local 
filename.</p>

<h4 id="media.playVideo_path_baseSource_showControls_listener_">media.playVideo(
 path [, baseSource ], showControls, listener )</h4>
<p>Plays the path in a device-specific popup media player. The optional 
parameter <span class="geshifilter"><code class="lua geshifilter-lua">baseSource</code></span>
 controls how <span class="geshifilter"><code class="lua 
geshifilter-lua">path</code></span> is interpreted and can be one of the
 <a 
href="http://developer.anscamobile.com/system-library#System-defined_directories">system-defined
 directory constants</a> or <span class="geshifilter"><code class="lua 
geshifilter-lua">media.RemoteSource</code></span>. In the former, the 
path is treated relative to the source base directory; in the latter, 
the path is treated as an absolute URL to a remote file. By default it 
is <span class="geshifilter"><code class="lua geshifilter-lua">system.ResourceDirectory</code></span>.
 </p>
<p>During video playback, the media player interface takes over. If 
showControls is <b>false</b>, then the user can adjust playback, e.g. 
start, stop, seek, etc. Pass a listener to get notified when the video 
has ended. Note this function is asynchronous. Any code that follows 
will be executed. After that, the application will be suspended until 
the video playback is complete.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> onComplete <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"video session ended"</span> <span class="br0">)</span>
<span class="kw1">end</span>
media.playVideo<span class="br0">(</span> <span class="st0">"Movie.m4v"</span>, <span class="kw1">true</span>, onComplete <span class="br0">)</span></pre></div></div>

<p>The listener can be either a function listener or a table listener. 
If listener is a table, it must have a completion method. The event 
dispatched to the listener will be a <a 
href="http://developer.anscamobile.com/events-and-listeners#completion">completion</a>
 event. </p>

<h3 id="Supported_Video_Formats">Supported Video Formats</h3>
<p>For the iPhone:</p>
<ul><li>	The video player supports playback of movie files with the <span
 class="geshifilter"><code class="lua geshifilter-lua">.mov</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">.mp4</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">.m4v</code></span>,
 and <span class="geshifilter"><code class="lua geshifilter-lua">.3gp</code></span>
 filename extensions and using the following compression standards:
	<ul><li>	H.264 Baseline Profile Level 3.0 video, up to 640 x 480 at 30 
fps. Note: B frames are not supported in the Baseline profile.</li>
    <li>	MPEG-4 Part 2 video (Simple Profile)</li>
    </ul>
</li></ul>

<h3 id="Camera_and_Photo_Library">Camera and Photo Library</h3>

<h4 id="media.show_imageSource_listener_">media.show( imageSource, 
listener )</h4>
<p>Opens a platform-specific interface. This function returns 
immediately so the calling code will continue to execute until the end 
of its scope. By default, it is added at the top of the current stage. A
 listener is required. <span class="geshifilter"><code class="lua 
geshifilter-lua">imageSource</code></span> can be one of:</p>
<ul><li>	<strong>media.PhotoLibrary</strong></li>
    <li>	<strong>media.Camera</strong></li>
    <li>	<strong>media.SavedPhotosAlbum</strong></li>
</ul>

<p>Note this function is asynchronous. Any code that follows will be 
executed. After that, the application will be suspended until the 
session is complete.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> onComplete <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">local</span> photo <span class="sy0">=</span> event.target
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"photo w,h = "</span> .. photo.width .. <span class="st0">","</span> .. photo.height <span class="br0">)</span>
<span class="kw1">end</span>
media.show<span class="br0">(</span> media.Camera, onComplete <span class="br0">)</span></pre></div></div>

<p>The listener can be either a function listener or a table listener. 
If <span class="geshifilter"><code class="lua geshifilter-lua">listener</code></span>
 is a table, it must have a completion method. The event dispatched to 
the listener will be a <u>completion</u> event with the following 
additional properties:</p>
<p><strong>event.target</strong> is a display image object based on the <span
 class="geshifilter"><code class="lua geshifilter-lua">imageSource</code></span>
 parameter.</p>
  </div>
<div id="node-1190" class="section-2">
  <h1 class="book-heading">Native UI</h1>
  <p>The native library provides access to various native UI features on
 the device.</p>

<h3 id="Activity_Indicator">Activity Indicator</h3>

<h5 id="native.setActivityIndicator_">native.setActivityIndicator(  )</h5>

<p><strong>native.setActivityIndicator( visible ) </strong>displays or 
hides a platform-specific activity indicator. Touch events are ignored 
while the indicator is shown.</p>
<p>Note: the indicator will not show until the end of the Lua code block
 has completed execution.</p>
<p>Below are examples of how the activity indicator varies across 
platforms using the same code. Pictured on the left is the Corona 
Simulator on Mac OS X. Pictured on the right is the same app running on 
the iPhone.</p>

<img src="api-reference_files/indicatorComparison.png" alt="comparison">

<h3 id="Alert">Alert</h3>

<h5 id="native.showAlert_">native.showAlert( )</h5>
<p><strong>native.showAlert( title, message [, buttonLabels [, 
listener]] ) </strong>Displays a popup alert box with one or more 
buttons, using a native alert control. Program activity, including 
animation, will continue in the background, but all other user 
interactivity will be blocked until the user selects a button or cancels
 the dialog.</p>
<p>The strings <span class="geshifilter"><code class="lua 
geshifilter-lua">title</code></span> and <span class="geshifilter"><code
 class="lua geshifilter-lua">message</code></span> are the title and 
message text displayed in the alert. <span class="geshifilter"><code 
class="lua geshifilter-lua">buttonLabels</code></span> is a table of 
strings, each of which will create a button with the corresponding 
label. You should include at least one <span class="geshifilter"><code 
class="lua geshifilter-lua">buttonLabel</code></span>, or the dialog 
will not have any buttons. The first button will have a unique color to 
suggest that the user should choose it by default.</p>
<p>The maximum number of buttons in an alert box is six. The most common
 format is one or two buttons, for example “OK” and “Cancel”.</p>

<p>The listener is notified when a user presses any button in the alert 
box, and it can assign an action to each button according to its 
numerical index: the first button is index 1, the second is index 2, and
 so on. The listener can be either a function listener or a table 
listener. If listener is a table, it must have a completion method. The 
event dispatched to the listener will be a <u>completion</u> event. It 
will contain the following additional properties:</p>

<h5 id="event.action">event.action</h5>
<p><strong>event.action</strong> indicates how the alert was dismissed:</p>
<ul><li>	<span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"cancelled"</span></code></span> indicates that <span 
class="geshifilter"><code class="lua geshifilter-lua">native.cancelAlert<span
 class="br0">(</span><span class="br0">)</span></code></span> was called
 to close the alert. </li>
<li>	<span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"clicked"</span></code></span> indicates that the user 
clicked on a button to close the alert.</li>
</ul>

<h5 id="event.index">event.index</h5>
<p><strong>event.index</strong> is the index of the button pressed. It 
corresponds to the index in the <span class="geshifilter"><code 
class="lua geshifilter-lua">buttonLabels</code></span> parameter.</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Handler that gets notified when the alert closes</span>
<span class="kw1">local</span> <span class="kw1">function</span> onComplete<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="st0">"clicked"</span> <span class="sy0">==</span> event.action <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">local</span> i <span class="sy0">=</span> event.index
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="nu0">1</span> <span class="sy0">==</span> i <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- Do nothing; dialog will simply dismiss</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">elseif</span> <span class="nu0">2</span> <span class="sy0">==</span> i <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- Open URL if "Learn More" (the 2nd button) was clicked</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; system.openURL<span class="br0">(</span> <span class="st0">"http://developer.anscamobile.com"</span> <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
<span class="kw1">end</span>
&nbsp;
<span class="co1">-- Show alert with five buttons</span>
<span class="kw1">local</span> alert <span class="sy0">=</span> native.showAlert<span class="br0">(</span> <span class="st0">"Corona"</span>, <span class="st0">"Dream. Build. Ship."</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">{</span> <span class="st0">"OK"</span>, <span class="st0">"Learn More"</span> <span class="br0">}</span>, onComplete <span class="br0">)</span></pre></td></tr></tbody></table></div>
<p>Note: When running in the Corona Simulator, the alert box displayed 
will be a native Mac OS X alert sheet rather than an iPhone alert box 
(shown at left). On the iPhone, the alerts will function the same as 
native alerts (right):
</p>

<h5 id="native.cancelAlert_">native.cancelAlert(  )</h5>
<p><strong>native.cancelAlert( alert ) </strong>Dismisses the alert box 
programmatically. For example, you may wish to have a popup alert that 
automatically disappears after ten seconds even if the user doesn’t 
click it. In that case, you could call this function at the end of a 
ten-second timer.</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Dismisses "alert" from previous code sample after 10 seconds</span>
<span class="kw1">local</span> <span class="kw1">function</span> cancelMyAlert<span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; native.cancelAlert<span class="br0">(</span> alert <span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
timer.performWithDelay<span class="br0">(</span> <span class="nu0">10000</span>, cancelMyAlert <span class="br0">)</span></pre></td></tr></tbody></table></div>

<h4 id="Examples">Examples</h4>

<p>For further examples of how to use native alerts, see the <strong>Alert</strong>
 project in the Sample Code folder of the Corona SDK.</p>


<h3 id="Fonts">Fonts</h3>

<h5 id="native.newFont_">native.newFont(  )</h5>
<p><strong>native.newFont( name [, size] ) </strong>Creates a font 
object that you can use to specify fonts in native text fields and text 
boxes. You can also pass it as a parameter to the display text objects 
in the <span class="geshifilter"><code class="lua geshifilter-lua">display.newText<span
 class="br0">(</span><span class="br0">)</span></code></span> function.</p>
<p>The <span class="geshifilter"><code class="lua geshifilter-lua">name</code></span>
 parameter is a string that names the font. You can obtain an array of 
available fonts via <span class="geshifilter"><code class="lua 
geshifilter-lua">native.getFontNames<span class="br0">(</span><span 
class="br0">)</span></code></span>. Alternatively, you can also pass the
 following constants instead of a string:</p>
<ul>
<li>    <strong>native.systemFont</strong></li>
<li>	<strong>native.systemFontBold</strong></li>
</ul>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">size</code></span>
 parameter is optional. You can use it to specify the point size of the 
font. By default, it will be the standard system font size of the 
device.</p>

<h5 id="native.getFontNames">native.getFontNames()</h5>
<p>Returns an array of the available native fonts.</p>
<p>Note: on the simulator, the available fonts may not correspond to the
 fonts actually available on the device. In general, iPhone device fonts
 can be accessed from the simulator within MacOS, but additional Mac 
fonts will also be available that may not work on the iPhone. If you 
encounter a problem of fonts appearing in the simulator but not on your 
device, this is the most likely cause. When in doubt, check the 
available device font names using <span class="geshifilter"><code 
class="lua geshifilter-lua">native.getFontNames<span class="br0">(</span><span
 class="br0">)</span></code></span>.</p>

<h3 id="Text_Input">Text Input</h3>

<h5 id="native.newTextField_">native.newTextField( )</h5>
<p><strong>native.newTextField( left, top, width, height [, listener] )</strong>
 Creates a single-line textfield for text input.
</p><h4 id="Properties">Properties</h4>
<h5 id="object.align">object.align</h5>
<p><strong>object.align </strong>can be a string <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"left"</span></code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"center"</span></code></span>, or <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="st0">"right"</span></code></span>.
 </p>
<h5 id="object.font">object.font</h5>
<p><strong>object.font </strong>is a font object returned by <span 
class="geshifilter"><code class="lua geshifilter-lua">native.newFont<span
 class="br0">(</span><span class="br0">)</span></code></span>. </p>
<h5 id="object.isSecure">object.isSecure</h5>
<p><strong>object.isSecure </strong>is controls whether text is hidden, 
e.g. passwords, or not. Default is <strong>false</strong>. </p>
<h5 id="object.size">object.size</h5>
<p><strong>object.size </strong>is the size of the text </p>
<h5 id="object.text">object.text</h5>
<p><strong>object.text </strong>is a string of the contents of the text 
box. </p>
<p>Methods:</p>
<h5 id="object:setTextColor_"><strong>object:setTextColor(  )</strong></h5>
<p><strong>object:setTextColor( r, g, b [, a] )</strong> sets the color 
of the text.</p>

<p>Note: native textfields are only available on device builds.</p>

<p>Because native textfields are not part of the OpenGL canvas, they do 
not obey the Corona display object hierarchy. For example, while they 
can be manipulated using display object methods, they always appear 
above normal display objects.</p>

<p>Also, they do not inherit display group properties like <span 
class="geshifilter"><code class="lua geshifilter-lua">isVisible</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">x</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">y</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">alpha</code></span>.
 If you need to set display properties on native objects, apply them to 
the objects directly.</p>

<p>To remove a native textfield from the display, use <span 
class="geshifilter"><code class="lua geshifilter-lua">object:removeSelf<span
 class="br0">(</span><span class="br0">)</span></code></span>.


</p><h4 id="Listening_for_Keyboard_Events">Listening for Keyboard Events</h4>

<p>You may optionally provide a listener function to respond to keyboard
 events. These events come with a “phase” attribute, as follows:</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">event.phase
 <span class="sy0">=</span> <span class="st0">"began"</span></code></span>
 -- this is the “keyboard has appeared” event. Depending on your 
interface design, you may want to adjust the screen contents when the 
keyboard is onscreen.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">event.phase
 <span class="sy0">=</span> <span class="st0">"ended"</span></code></span>
 -- this event is called when the user stops editing a field: for 
example, when they touch a different field.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">event.phase
 <span class="sy0">=</span> <span class="st0">"submitted"</span></code></span>
 -- this event occurs when the user presses the “"return"” key (if 
available) on the onscreen keyboard.</p>

<p>If you choose to handle this event with a table listener, the event 
name is "userInput".</p>

<h5 id="native.setKeyboardFocus_">native.setKeyboardFocus(  )</h5>
<p><strong>native.setKeyboardFocus( textField ) </strong>Sets keyboard 
focus on a textField and (where appropriate) shows the keyboard. Pass <strong>nil</strong>
 to remove focus and dismiss the keyboard.</p>


<h3 id="Supported_Keyboard_Types">Supported Keyboard Types</h3>
<p>Five keyboard types are supported in the input textfield, using a 
property named <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"inputType"</span></code></span>. 
This property is optional. See the <strong>Interface/NativeKeyboard</strong>
 sample code for a demo of the various available types.</p>

<p>Example:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">numericField <span class="sy0">=</span> native.newTextField<span class="br0">(</span> <span class="nu0">50</span>, <span class="nu0">150</span>, <span class="nu0">220</span>, <span class="nu0">36</span>, handlerFunction <span class="br0">)</span>
numericField.inputType <span class="sy0">=</span> <span class="st0">"number"</span></pre></div></div>

<p>The five possible values for the <span class="geshifilter"><code 
class="lua geshifilter-lua">inputType</code></span> property are:</p>
<ul>
<li><strong>"default"</strong> - the default keyboard, supporting 
general text, numbers and punctuation</li>
<li><strong>"number"</strong> - a numeric keypad</li>
<li><strong>"phone"</strong> - a keypad for entering phone numbers</li>
<li><strong>"url"</strong> - a keyboard for entering website URLs</li>
<li><strong>"email"</strong> - a keyboard for entering email addresses</li>
</ul>

<p>As before, you can set the <span class="geshifilter"><code class="lua
 geshifilter-lua">isSecure</code></span> boolean to create a 
password-entry field:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">passwordField.isSecure <span class="sy0">=</span> <span class="kw1">true</span></pre></div></div>

<h3 id="Multiline_Textfields">Multiline Textfields</h3>

<h4 id="native.newTextBox_">native.newTextBox(  )</h4>
<p><strong>native.newTextBox( left, top, width, height )</strong> 
Creates a scrollable, multi-line text box</p>
<p>Properties:</p>
<h5 id="object.align_"><strong>object.align</strong> </h5>
<p><strong>object.align</strong> can be a string "left", "center", or 
"right".</p>
<h5 id="object.font_"><strong>object.font</strong> </h5>
<p><strong>object.font</strong> is a font object returned by 
native.newFont().</p>
<h5 id="object.hasBackground"><strong>object.hasBackground</strong></h5>
<p><strong>object.hasBackground</strong> is <strong>true</strong> when 
there is background and <strong>false</strong> when the background is 
transparent.</p>
<h5 id="object.size-1"><strong>object.size</strong></h5>
<p><strong>object.size</strong> is the size of the text</p>
<h5 id="object.text_"><strong>object.text</strong> </h5>
<p><strong>object.text</strong> is a string of the contents of the text 
box.</p>
<p>Methods:</p>
<h5 id="object:setTextColor_-2"><strong>object:setTextColor(  )</strong></h5>
<p><strong>object:setTextColor( r, g, b [, a] )</strong></p>
<p><strong>Note:</strong> this feature is only available on device 
builds.</p>
<p>Because native textboxes are not part of the OpenGL canvas, they do 
not obey the Corona display object hierarchy. For example, while they 
can be manipulated using display object methods, they always appear 
above normal display objects.</p>
<p>Also, they do not inherit display group properties like <span 
class="geshifilter"><code class="lua geshifilter-lua">isVisible</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">x</code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua">y</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">alpha</code></span>.
 If you need to set display properties on native objects, apply them to 
the objects directly.</p>

<p>To remove a native textbox from the display, use <span 
class="geshifilter"><code class="lua geshifilter-lua">object:removeSelf<span
 class="br0">(</span><span class="br0">)</span></code></span>.

</p><h3 id="Web_Popups">Web Popups</h3>
<h5 id="native.showWebPopup_">native.showWebPopup( )</h5>
<p><strong>native.showWebPopup( url [, options] ) </strong>Creates a 
fullscreen web popup that loads a local or remote web page specified by 
url. By default, the url is assumed to be an absolute url to a remote 
server.</p>
<p>The options parameter is optional. You can customize certain features
 by creating a table with the following properties:</p>
<h5 id="object.baseUrl_"><strong>object.baseUrl</strong> </h5>
<p><strong>object.baseUrl</strong> determines whether url is interpreted
 as a relative or absolute url. The default (<strong>nil</strong>) 
implies that the url is absolute. To load a local file, set the base url
 to one of the <u>base directory constants</u>, e.g. <span 
class="geshifilter"><code class="lua geshifilter-lua">system.ResourceDirectory</code></span>.
 Then the url parameter is relative to that base directory. For remote 
files, you can also specify a remote base, and the url parameter will be
 relative to the remote base.</p>
<h5 id="object.hasBackground_"><strong>object.hasBackground</strong> </h5>
<p><strong>object.hasBackground</strong> controls whether the popup has a
 an opaque background or not. It not specified, the background will be 
opaque.</p>
<h5 id="object.urlRequest"><strong>object.urlRequest</strong></h5>
<p><strong>object.urlRequest</strong> is a function or table listener to
 <u>urlRequest</u> events.</p>
<p>Note: Only available on device builds.</p>
<p>Web popups can optionally be limited to part of the screen, as 
opposed to the default full-screen mode. The boundaries of the webpopup 
are given in four optional numerical parameters:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">native.showWebPopup<span class="br0">(</span> <span class="nu0">10</span>, <span class="nu0">10</span>, <span class="nu0">300</span>, <span class="nu0">300</span>, <span class="st0">"http://www.anscamobile.com"</span>, <span class="br0">{</span>urlRequest<span class="sy0">=</span>listener<span class="br0">}</span> <span class="br0">)</span></pre></td></tr></tbody></table></div>

<p>The optional <span class="geshifilter"><code class="lua 
geshifilter-lua">urlRequest</code></span> parameter designates a 
function that will intercept all URL requests coming from the webpopup. 
This also provides a standard method for passing information back from 
the web using pseudo-URLs. For example, the <strong>Social/Facebook</strong>
 sample code retrieves a successful Facebook Connect event by detecting a
 pseudo-URL request of <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"fbconnect:success"</span></code></span>
 from Facebook’s server.</p>

<h5 id="native.cancelWebPopup">native.cancelWebPopup()</h5>
<p>Dismisses the web popup. Returns <strong>true</strong> if web popup 
was displaying prior to the call; <strong>false</strong> otherwise. </p>
<p>Note: Only available on device builds.</p>
  </div>
<div id="node-1447" class="section-2">
  <h1 class="book-heading">Network</h1>
  <h2 id="Network">Network</h2>
<hr>
<p>Corona includes the latest version (v2.02) of the <strong>LuaSocket</strong>
 libraries. These Lua modules implement common network protocols such as
 SMTP (sending e-mails), HTTP (WWW access) and FTP (uploading and 
downloading files). Also included are features to support MIME (common 
encodings), URL manipulation and LTN12 (transferring and filtering 
data). </p>

<p>Note: as of SDK Beta 6, networking support is also available for 
Android. However, you will need to set the Android INTERNET permission 
in build.settings (see the "Configuring Projects" section for more 
information).</p>

<p>Luasocket is a collection of external libraries that are 
pre-installed into Corona apps. To speed up launch time, they are not 
automatically loaded by default. In order to use them, you must 
explicitly load each one to make that library's functions available to 
your code. To do this, you should use <u>require</u>, e.g. placing <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">local</span>
 socket <span class="sy0">=</span> <span class="kw1">require</span><span
 class="br0">(</span><span class="st0">"socket"</span><span class="br0">)</span></code></span>
 or <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="kw1">local</span> http <span class="sy0">=</span> <span 
class="kw1">require</span><span class="br0">(</span><span class="st0">"http"</span><span
 class="br0">)</span></code></span>at the top of your Lua file.</p>

<p>Full LuaSocket documentation can be found here: </p>
<p><a 
href="http://www.tecgraf.puc-rio.br/%7Ediego/professional/luasocket/reference.html">http://www.tecgraf.puc-rio.br/~diego/professional/luasocket/reference.html</a></p>
<p>Although these libraries are built into Corona, you need to use the 
Lua require syntax to make the functions available to your code. This is
 demonstrated in the example below, and in other online code samples 
available from the global Lua community.</p>

<h4 id="Simple_image_downloading">Simple image downloading</h4>
<p>This example uses the <strong>http.request</strong> function to 
download a PNG file, save it to a local directory, and then display it 
as an image. JPEG files can also be downloaded and displayed in this 
manner.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Load the relevant LuaSocket modules</span>
<span class="kw1">local</span> http <span class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span class="st0">"socket.http"</span><span class="br0">)</span>
<span class="kw1">local</span> ltn12 <span class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span class="st0">"ltn12"</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- Create local file for saving data</span>
<span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"hello.png"</span>, system.DocumentsDirectory <span class="br0">)</span>
myFile <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"w+b"</span> <span class="br0">)</span> 
&nbsp;
<span class="co1">-- Request remote file and save data to local file</span>
http.request<span class="br0">{</span>
&nbsp; &nbsp; url <span class="sy0">=</span> <span class="st0">"http://developer.anscamobile.com/demo/hello.png"</span>, 
&nbsp; &nbsp; sink <span class="sy0">=</span> ltn12.sink.file<span class="br0">(</span>myFile<span class="br0">)</span>,
<span class="br0">}</span>
&nbsp;
<span class="co1">-- Display local file</span>
testImage <span class="sy0">=</span> display.newImage<span class="br0">(</span><span class="st0">"hello.png"</span>,system.DocumentsDirectory,<span class="nu0">60</span>,<span class="nu0">50</span><span class="br0">)</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>

<p>When testing this code in the Corona Simulator, the Documents 
directory on your Mac stands in for the application’s local directory on
 the iPhone. As a result, you will see the downloaded PNG file being 
stored in your Documents directory.</p>

<h4 id="Examples">Examples</h4>
<p>For an example of how to use this library, see the <strong>SimpleImageDownload</strong>
 project in the Sample Code folder of the Corona SDK.</p>
  </div>
<div id="node-1441" class="section-2">
  <h1 class="book-heading">Strings</h1>
  <h2 id="String_Manipulation">String Manipulation</h2>
<p>This library provides generic functions for string manipulation, such
 as finding and extracting substrings, and pattern matching. When 
indexing a string in Lua, the first character is at position&nbsp;1 (not
 at&nbsp;0, as in C). Indices are allowed to be negative and are 
interpreted as indexing backwards, from the end of the string. Thus, the
 last character is at position -1, and so on.</p>
<p>The string library provides all its functions inside the table 
string. It also sets a metatable for strings where the __index field 
points to the string table. Therefore, you can use the string functions 
in object-oriented style. For instance, string.byte(s, i) can be written
 as s:byte(i).</p>
<p>The string library assumes one-byte character encodings.</p>

<h4 id="string.byte_s_i_j">string.byte (s [, i [, j]])</h4>
<p>Returns the internal numerical codes of the characters s[i], s[i+1], 
..., s[j]. The default value for i is&nbsp;1; the default value for j 
is&nbsp;i.</p>
<p>Note that numerical codes are not necessarily portable across 
platforms.</p>

<h4 id="string.char_...">string.char (...)</h4>
<p>Receives zero or more integers. Returns a string with length equal to
 the number of arguments, in which each character has the internal 
numerical code equal to its corresponding argument.</p>
<p>Note that numerical codes are not necessarily portable across 
platforms.</p>

<h4 id="string.find_s_pattern_init_plain">string.find (s, pattern [, 
init [, plain]])</h4>
<p>Looks for the first match of pattern in the string s. If it finds a 
match, then find returns the indices of&nbsp;s where this occurrence 
starts and ends; otherwise, it returns nil. A third, optional numerical 
argument init specifies where to start the search; its default value 
is&nbsp;1 and can be negative. A value of false as a fourth, optional 
argument plain turns off the pattern matching facilities, so the 
function does a plain "find substring" operation, with no characters in 
pattern being considered "magic". Note that if plain is given, then init
 must be given as well.</p>
<p>If the pattern has captures, then in a successful match the captured 
values are also returned, after the two indices.</p>

<h4 id="string.format_formatstring_...">string.format (formatstring, 
...)</h4>
<p>Returns a formatted version of its variable number of arguments 
following the description given in its first argument (which must be a 
string). The format string follows the same rules as the printf family 
of standard C&nbsp;functions. The only differences are that the 
options/modifiers *, l, L, n, p, and h are not supported and that there 
is an extra option, q. The q option formats a string in a form suitable 
to be safely read back by the Lua interpreter: the string is written 
between double quotes, and all double quotes, newlines, embedded zeros, 
and backslashes in the string are correctly escaped when written. For 
instance, the call</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">string.format</span><span class="br0">(</span><span class="st0">'%q'</span>, <span class="st0">'a string with "quotes" and <span class="es0">\n</span> new line'</span><span class="br0">)</span></pre></td></tr></tbody></table></div>
<p>will produce the string:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="st0">"a string with <span class="es0">\"</span>quotes<span class="es0">\"</span> and <span class="es0">\</span></span>
<span class="st0"> &nbsp; &nbsp; &nbsp;new line"</span></pre></td></tr></tbody></table></div>
<p>The options c, d, E, e, f, g, G, i, o, u, X, and x all expect a 
number as argument, whereas q and s expect a string.</p>
<p>This function does not accept string values containing embedded 
zeros, except as arguments to the q option.</p>

<h4 id="string.gmatch_s_pattern">string.gmatch (s, pattern)</h4>
<p>Returns an iterator function that, each time it is called, returns 
the next captures from pattern over string s. If pattern specifies no 
captures, then the whole match is produced in each call.</p>
<p>As an example, the following loop</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;s <span class="sy0">=</span> <span class="st0">"hello world from Lua"</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> w <span class="kw1">in</span> <span class="kw1">string</span>.gmatch<span class="br0">(</span>s, <span class="st0">"%a+"</span><span class="br0">)</span> <span class="kw1">do</span>
&nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span>w<span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all the words from string s, printing one per line.
 The next example collects all pairs key=value from the given string 
into a table:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;t <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp; &nbsp; &nbsp;s <span class="sy0">=</span> <span class="st0">"from=world, to=Lua"</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> k, v <span class="kw1">in</span> <span class="kw1">string</span>.gmatch<span class="br0">(</span>s, <span class="st0">"(%w+)=(%w+)"</span><span class="br0">)</span> <span class="kw1">do</span>
&nbsp; &nbsp; &nbsp; &nbsp;t<span class="br0">[</span>k<span class="br0">]</span> <span class="sy0">=</span> v
&nbsp; &nbsp; &nbsp;<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>For this function, a '^' at the start of a pattern does not work as 
an anchor, as this would prevent the iteration.</p>

<h4 id="string.gsub_s_pattern_repl_n">string.gsub (s, pattern, repl [, 
n])</h4>
<p>Returns a copy of s in which all (or the first n, if given) 
occurrences of the pattern have been replaced by a replacement string 
specified by repl, which can be a string, a table, or a function. gsub 
also returns, as its second value, the total number of matches that 
occurred.</p>
<p>If repl is a string, then its value is used for replacement. The 
character&nbsp;% works as an escape character: any sequence in repl of 
the form %n, with n between 1 and 9, stands for the value of the n-th 
captured substring (see below). The sequence %0 stands for the whole 
match. The sequence %% stands for a single&nbsp;%.</p>
<p>If repl is a table, then the table is queried for every match, using 
the first capture as the key; if the pattern specifies no captures, then
 the whole match is used as the key.</p>
<p>If repl is a function, then this function is called every time a 
match occurs, with all captured substrings passed as arguments, in 
order; if the pattern specifies no captures, then the whole match is 
passed as a sole argument.</p>
<p>If the value returned by the table query or by the function call is a
 string or a number, then it is used as the replacement string; 
otherwise, if it is false or nil, then there is no replacement (that is,
 the original match is kept in the string).</p>
<p>Here are some examples:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"hello world"</span>, <span class="st0">"(%w+)"</span>, <span class="st0">"%1 %1"</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="hello hello world world"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"hello world"</span>, <span class="st0">"%w+"</span>, <span class="st0">"%0 %0"</span>, <span class="nu0">1</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="hello hello world"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"hello world from Lua"</span>, <span class="st0">"(%w+)%s*(%w+)"</span>, <span class="st0">"%2 %1"</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="world hello Lua from"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"home = $HOME, user = $USER"</span>, <span class="st0">"%$(%w+)"</span>, <span class="kw1">os.getenv</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="home = /home/roberto, user = roberto"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"4+5 = $return 4+5$"</span>, <span class="st0">"%$(.-)%$"</span>, <span class="kw1">function</span> <span class="br0">(</span>s<span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">return</span> <span class="kw1">loadstring</span><span class="br0">(</span>s<span class="br0">)</span><span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">end</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="4+5 = 9"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;<span class="kw1">local</span> t <span class="sy0">=</span> <span class="br0">{</span>name<span class="sy0">=</span><span class="st0">"lua"</span>, version<span class="sy0">=</span><span class="st0">"5.1"</span><span class="br0">}</span>
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"$name-$version.tar.gz"</span>, <span class="st0">"%$(%w+)"</span>, t<span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="lua-5.1.tar.gz"</span></pre></td></tr></tbody></table></div>

<h4 id="string.len_s">string.len (s)</h4>
<p>Receives a string and returns its length. The empty string "" has 
length 0. Embedded zeros are counted, so "a\000bc\000" has length 5.</p>

<h4 id="string.lower_s">string.lower (s)</h4>
<p>Receives a string and returns a copy of this string with all 
uppercase letters changed to lowercase. All other characters are left 
unchanged. The definition of what an uppercase letter is depends on the 
current locale.</p>

<h4 id="string.match_s_pattern_init">string.match (s, pattern [, init])</h4>
<p>Looks for the first match of pattern in the string s. If it finds 
one, then match returns the captures from the pattern; otherwise it 
returns nil. If pattern specifies no captures, then the whole match is 
returned. A third, optional numerical argument init specifies where to 
start the search; its default value is&nbsp;1 and can be negative.</p>

<h4 id="string.rep_s_n">string.rep (s, n)</h4>
<p>Returns a string that is the concatenation of n copies of the string 
s.</p>

<h4 id="string.reverse_s">string.reverse (s)</h4>
<p>Returns a string that is the string s reversed.</p>

<h4 id="string.sub_s_i_j">string.sub (s, i [, j])</h4>
<p>Returns the substring of s that starts at i and continues until j; i 
and j can be negative. If j is absent, then it is assumed to be equal to
 -1 (which is the same as the string length). In particular, the call 
string.sub(s,1,j) returns a prefix of s with length j, and string.sub(s,
 -i) returns a suffix of s with length i.</p>

<h4 id="string.upper_s">string.upper (s)</h4>
<p>Receives a string and returns a copy of this string with all 
lowercase letters changed to uppercase. All other characters are left 
unchanged. The definition of what a lowercase letter is depends on the 
current locale.</p>

<h3 id="Patterns">Patterns</h3>

<h4 id="Character_Class:">Character Class:</h4>

<p>A character class is used to represent a set of characters. The 
following combinations are allowed in describing a character class:
x: (where x is not one of the magic characters ^$()%.[]*+-?) represents 
the character x itself.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">.</code></span>:
 (a dot) represents all characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>a</code></span>: represents all letters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>c</code></span>: represents all control characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>d</code></span>: represents all digits.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>l</code></span>: represents all lowercase letters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>p</code></span>: represents all punctuation 
characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>s</code></span>: represents all space characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>u</code></span>: represents all uppercase letters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>w</code></span>: represents all alphanumeric 
characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>x</code></span>: represents all hexadecimal digits.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>z</code></span>: represents the character with 
representation 0.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>x</code></span>: (where x is any non-alphanumeric 
character) represents the character x. This is the standard way to 
escape the magic characters. Any punctuation character (even the non 
magic) can be preceded by a '%' when used to represent itself in a 
pattern.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="br0">[</span>set<span class="br0">]</span></code></span>: 
represents the class which is the union of all characters in set. A 
range of characters can be specified by separating the end characters of
 the range with a '-'. All classes %x described above can also be used 
as components in set. All other characters in set represent themselves. 
For example, [%w_] (or [_%w]) represents all alphanumeric characters 
plus the underscore, [0-7] represents the octal digits, and [0-7%l%-] 
represents the octal digits plus the lowercase letters plus the '-' 
character. The interaction between ranges and classes is not defined. 
Therefore, patterns like [%a-z] or [a-%%] have no meaning. </p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="br0">[</span>^set<span class="br0">]</span></code></span>: 
represents the complement of set, where set is interpreted as above.</p>
<p>For all classes represented by single letters (%a, %c, etc.), the 
corresponding uppercase letter represents the complement of the class. 
For instance, %S represents all non-space characters.</p>
<p>The definitions of letter, space, and other character groups depend 
on the current locale. In particular, the class [a-z] may not be 
equivalent to %l.</p>

<h4 id="Pattern_Item:">Pattern Item:</h4>
<p>A pattern item can be</p>
<ul>
<li>a single character class, which matches any single character in the 
class;</li>
<li>a single character class followed by '*', which matches 0 or more 
repetitions of characters in the class. These repetition items will 
always match the longest possible sequence;</li>
<li>a single character class followed by '+', which matches 1 or more 
repetitions of characters in the class. These repetition items will 
always match the longest possible sequence;</li>
<li>a single character class followed by '-', which also matches 0 or 
more repetitions of characters in the class. Unlike '*', these 
repetition items will always match the shortest possible sequence;</li>
<li>a single character class followed by '?', which matches 0 or 1 
occurrence of a character in the class;</li>
<li>%n, for n between 1 and 9; such item matches a substring equal to 
the n-th captured string (see below);</li>
<li>%bxy, where x and y are two distinct characters; such item matches 
strings that start with&nbsp;x, end with&nbsp;y, and where the x and y 
are balanced. This means that, if one reads the string from left to 
right, counting +1 for an x and -1 for a y, the ending y is the first y 
where the count reaches 0. For instance, the item %b() matches 
expressions with balanced parentheses.</li>
</ul>

<h4 id="Pattern:">Pattern:</h4>
<p>A pattern is a sequence of pattern items. A '^' at the beginning of a
 pattern anchors the match at the beginning of the subject string. A '$'
 at the end of a pattern anchors the match at the end of the subject 
string. At other positions, '^' and '$' have no special meaning and 
represent themselves.</p>

<h4 id="Captures:">Captures:</h4>
<p>A pattern can contain sub-patterns enclosed in parentheses; they 
describe captures. When a match succeeds, the substrings of the subject 
string that match captures are stored (captured) for future use. 
Captures are numbered according to their left parentheses. For instance,
 in the pattern "(a*(.)%w(%s*))", the part of the string matching 
"a*(.)%w(%s*)" is stored as the first capture (and therefore has 
number&nbsp;1); the character matching "." is captured with 
number&nbsp;2, and the part matching "%s*" has number&nbsp;3.</p>
<p>As a special case, the empty capture () captures the current string 
position (a number). For instance, if we apply the pattern "()aa()" on 
the string "flaaap", there will be two captures: 3&nbsp;and&nbsp;5.</p>
<p>A pattern cannot contain embedded zeros. Use %z instead.</p>
  </div>
<div id="node-1191" class="section-2">
  <h1 class="book-heading">System and OS</h1>
  <h3 id="System_Library">System Library</h3>

<h4 id="system.getInfo_param_">system.getInfo( param )</h4>
<p>The first argument <span class="geshifilter"><code class="lua 
geshifilter-lua">param</code></span> is a 
string that determines what is returned. Here are the valid values for <span
 class="geshifilter"><code class="lua geshifilter-lua">param</code></span>:</p>

<ul>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"name"</span></code></span>
 returns the name of the device. On Android, it returns <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"unknown"</span></code></span>.</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"model"</span></code></span>
 returns the human readable model name. On iPhone, this would be the 
name of the phone as it appears in iTunes, e.g. <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"Steve's
 iPhone"</span></code></span>.</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"deviceID"</span></code></span>
 returns the unique id of the device, e.g. IMEI or similar number</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"environment"</span></code></span>
 returns the environment that the app is running in. These include:</li>

<ul>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"simulator"</span></code></span> the Corona Simulator<br></li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"device"</span></code></span> the device or 
platform-specific simulator (e.g. Xcode simulator)</li>
</ul>

<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"platformName"</span></code></span>
 returns the platform name, e.g. the OS name:</li>

<ul><li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"Mac OS X"</span></code></span></li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"iPhone OS"</span></code></span></li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"Android"</span></code></span></li>
</ul>

<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"platformVersion"</span></code></span>
 returns a string representation of the platform version.</li>

<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"version"</span></code></span>
 returns the version of Corona used as it appears in the About box of 
the Corona Simulator.</li>

<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"build"</span></code></span> 
returns the Corona build string as it appears in the About box of the 
Corona Simulator.</li>
</ul>


<p>&nbsp;</p>


<h4 id="system.getPreference_category_name_">system.getPreference( 
category, name )</h4>
<p>Returns a preference value as a string. Valid values of <span 
class="geshifilter"><code class="lua geshifilter-lua">category</code></span>
 are:</p>
<ul><li><span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="st0">"ui"</span></code></span> for general application-level 
preferences. In this category, pass <span class="geshifilter"><code 
class="lua geshifilter-lua"><span class="st0">"language"</span></code></span>
 for the name parameter to get the preferred language.</li>
<li><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"locale"</span></code></span> for locale preferences. In 
this category, valid name parameters include <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="st0">"country"</span></code></span>,
 <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"identifier"</span></code></span>, and<span 
class="geshifilter"><code class="lua geshifilter-lua">&nbsp;<span 
class="st0">"language"</span></code></span>.</li>
</ul>

<p>&nbsp;</p>

<h4 id="system.getTimer_">system.getTimer() </h4>
<p>Returns time in milliseconds since application launch.</p>

<p>&nbsp;</p>

<h4 id="system.openURL_url_">system.openURL( url )</h4>
<p>Opens url. NOTE: we may change this slightly. </p>
<p>Supported url formats for the iPhone:</p>

<ul><li>	Mail links: <u>mailto:nobody@mycompany.com</u></li>
<li>	Phone links: <u>tel:415-867-5309</u></li>
<li>Web links: <u>http://www.anscamobile.com</u></li>
</ul>

<p>&nbsp;</p>

<h4 id="system.pathForFile_filename_baseDirectory_">system.pathForFile( 
filename [, baseDirectory] )</h4>
<p>Generates an absolute path using system-defined directories as the 
base (see <u>System-defined directories</u> below). A second, optional 
parameter baseDirectory specifies which base directory is used to 
construct the full path; its default values is <span class="geshifilter"><code
 class="lua geshifilter-lua">system.ResourceDirectory</code></span>. If 
the base directory is <span class="geshifilter"><code class="lua 
geshifilter-lua">system.ResourceDirectory</code></span> and the 
generated path points to a non-existent file, <strong>nil</strong> is 
returned.</p>

<p>&nbsp;</p>

<h4 id="system.setAccelerometerInterval_frequency_">system.setAccelerometerInterval(
 frequency )</h4>
<p>Sets the frequency of <u>accelerometer</u> events. The min frequency 
is 10 Hz and the max is 100 Hz on the iPhone. Accelerometer events are a
 significant drain on battery, so only increase the frequency when you 
need faster responses as in games. Always try to lower the frequency 
whenever possible to conserve battery life.</p>

<p>&nbsp;</p>

<h4 id="system.setIdleTimer_enabled_">system.setIdleTimer( enabled )</h4>
<p>Controls whether the idle timer is enabled. If enabled is <strong>true</strong>,
 the timer will be active (default); inactive if <strong>false</strong>.
 When active, the idle timer dims the screen and eventually puts the 
device to sleep when no user activity occurs (e.g. screen
touches).</p>

<p>&nbsp;</p>

<h4 id="system.setLocationAccuracy_distance_">system.setLocationAccuracy(
 distance )</h4>
<p>Sets the desired accuracy of <u>location</u> events to distance 
meters. Note: the actual accuracy depends on the capabilities of the 
device and/or platform. On the iPhone, accuracy is limited to discrete 
distances: &lt;10, 10, 100, 1000, and 3000. Higher accuracy (smaller 
distances) requires more battery life, so use larger distance to 
preserve battery life.</p>

<p>&nbsp;</p>

<h4 id="system.setLocationThreshold_distance_">system.setLocationThreshold(
 distance )</h4>
<p>Sets how much distance in meters must be travelled until the next <u>location</u>
 event is sent. Because location events involve hardware that can drain 
the battery, using larger threshold distances preserve battery life.</p>

<p>&nbsp;</p>

<h4 id="system.vibrate">system.vibrate()</h4>
<p>Vibrates the phone.</p>

<p>&nbsp;</p>

<h3 id="System-defined_directories">System-defined directories</h3>
<p>The following are constants for base directories to be used with <span
 class="geshifilter"><code class="lua geshifilter-lua">system.pathForFile<span
 class="br0">(</span><span class="br0">)</span></code></span>.</p>
<dl>
<dt>
<h4 id="system.DocumentsDirectory">system.DocumentsDirectory</h4></dt> <dd>should
 be used for files that need to persist between application sessions. 
Under the simulator, the user's documents directory is used, e.g. 
"~/Documents"</dd>
<dt><h4 id="system.TemporaryDirectory">system.TemporaryDirectory</h4></dt>
 <dd>is a temporary directory. Files written to this directory are not 
guaranteed to exist in subsequent application sessions. They might exist
 or they might not.</dd>
<dt><h4 id="system.ResourceDirectory">system.ResourceDirectory</h4></dt>
 <dd>is the directory where all application assets exist. On the 
simulator, this corresponds to files located in the assets folder of 
your project. For example, this is the default location where <span 
class="geshifilter"><code class="lua geshifilter-lua">display.newImage<span
 class="br0">(</span><span class="br0">)</span></code></span> looks for 
image files. Note: you should <strong>never</strong> create, modify, or 
add files to this directory. Doing so will prevent the device from 
verifying the integrity of your application; in some cases, the device 
will treat your application as malware and refuse to launch your 
application. </dd>
</dl>

<p>&nbsp;</p>

<h3 id="OS_Library">OS Library</h3>

<p>This library is implemented through the table <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">os</span></code></span>.</p>

<p>&nbsp;</p>

<h4 id="os.clock_">os.clock ()</h4>
<p>Returns an approximation of the amount in seconds of CPU time used by
 the program.</p>

<p>&nbsp;</p>

<h4 id="os.date_format_time">os.date ([format [, time]])</h4>
<p>Returns a string or a table containing date and time, formatted 
according to the given string format.</p>
<p>If the time argument is present, this is the time to be formatted 
(see the os.time function for a description of this value). Otherwise, 
date formats the current time.</p>
<p>If format starts with '!', then the date is formatted in Coordinated 
Universal Time. After this optional character, if format is the string 
"*t", then date returns a table with the following fields: year (four 
digits), month (1--12), day (1--31), hour (0--23), min (0--59), sec 
(0--61), wday (weekday, Sunday is&nbsp;1), yday (day of the year), and 
isdst (daylight saving flag, a boolean).</p>
<p>If format is not "*t", then date returns the date as a string, 
formatted according to the same rules as the C&nbsp;function strftime.</p>
<p>When called without arguments, date returns a reasonable date and 
time representation that depends on the host system and on the current 
locale (that is, os.date() is equivalent to os.date("%c")).</p>

<p>&nbsp;</p>

<h4 id="os.difftime_t2_t1">os.difftime (t2, t1)</h4>
<p>Returns the number of seconds from time t1 to time t2. In POSIX, 
Windows, and some other systems, this value is exactly t2-t1.</p>

<p>&nbsp;</p>

<h4 id="os.exit_code_">os.exit ([ code ])</h4>
<p>Calls the C&nbsp;function exit, with an optional code, to terminate 
the host program. The default value for code is the success code.</p>

<p>&nbsp;</p>

<h4 id="os.remove_filename">os.remove (filename)</h4>
<p>Deletes the file or directory with the given name. Directories must 
be empty to be removed. If this function fails, it returns nil, plus a 
string describing the error.</p>

<p>&nbsp;</p>

<h4 id="os.rename_oldname_newname">os.rename (oldname, newname)</h4>
<p>Renames file or directory named oldname to newname. If this function 
fails, it returns nil, plus a string describing the error.</p>

<p>&nbsp;</p>

<h4 id="os.time_table">os.time ([table])</h4>
<p>Returns the current time when called without arguments, or a time 
representing the date and time specified by the given table. This table 
must have fields year, month, and day, and may have fields hour, min, 
sec, and isdst (for a description of these fields, see the os.date 
function).</p>
<p>The returned value is a number, whose meaning depends on your system.
 In POSIX, Windows, and some other systems, this number counts the 
number of seconds since some given start time (the "epoch"). In other 
systems, the meaning is not specified, and the number returned by time 
can be used only as an argument to date and difftime.</p>
  </div>
<div id="node-1442" class="section-2">
  <h1 class="book-heading">Tables and Arrays</h1>
  <p>Tables in Lua implement associative arrays. That is, they can be 
indexed not just with numbers, but also with strings or any other value 
of the language, except <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">nil</span></code></span>.</p>

<p>This library provides generic functions for table manipulation. It 
provides all its functions inside the table <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">table</span></code></span>.</p>

<p>Most functions in the table library assume that the table represents a
 numerically-indexed array or list. For these functions, when we talk 
about the "length" of a table we mean the result of the length operator.</p>

<h4 id="table.concat_table_sep_i_j">table.concat (table [, sep [, i [, 
j]]])</h4>
<p>Given an array where all elements are strings or numbers, returns 
table[i]..sep..table[i+1] ... sep..table[j]. The default value for sep 
is the empty string, the default for i is 1, and the default for j is 
the length of the table. If i is greater than j, returns the empty 
string.</p>

<h4 id="table.insert_table_pos_value">table.insert (table, [pos,] value)</h4>
<p>Inserts element value at position <span class="geshifilter"><code 
class="lua geshifilter-lua">pos</code></span> in <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">table</span></code></span>,
 shifting up other elements to open space, if necessary. The default 
value for <span class="geshifilter"><code class="lua geshifilter-lua">pos</code></span>
 is <span class="geshifilter"><code class="lua geshifilter-lua">n+<span 
class="nu0">1</span></code></span>, where <span class="geshifilter"><code
 class="lua geshifilter-lua">n</code></span> is the length of the table,
 so that a call <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">table.insert</span><span class="br0">(</span>t,x<span
 class="br0">)</span></code></span> inserts <span class="geshifilter"><code
 class="lua geshifilter-lua">x</code></span> at the end of table <span 
class="geshifilter"><code class="lua geshifilter-lua">t</code></span>; 
however, if you are inserting at the end of the table, it is faster to 
use the length operator: <span class="geshifilter"><code class="lua 
geshifilter-lua">t<span class="br0">[</span>#t + <span class="nu0">1</span><span
 class="br0">]</span> <span class="sy0">=</span> x</code></span>.</p>

<h4 id="table.maxn_table">table.maxn (table)</h4>
<p>Returns the largest positive numerical index of the given table, or 
zero if the table has no positive numerical indices. (To do its job this
 function does a linear traversal of the whole table.)</p>

<h4 id="table.remove_table_pos">table.remove (table [, pos])</h4>
<p>Removes from table the element at position pos, shifting down other 
elements to close the space, if necessary. Returns the value of the 
removed element. The default value for pos is n, where n is the length 
of the table, so that a call table.remove(t) removes the last element of
 table t.</p>

<h4 id="table.sort_table_comp">table.sort (table [, comp])</h4>
<p>Sorts table elements in a given order, in-place, from table[1] to 
table[n], where n is the length of the table. If comp is given, then it 
must be a function that receives two table elements, and returns false 
when the first is less than the second (so that not comp(a[i+1],a[i]) 
will be false after the sort). If comp is not given, then the standard 
Lua operator &lt; is used instead.</p>
<p>The sort algorithm is not stable; that is, elements considered equal 
by the given order may have their relative positions changed by the 
sort.</p>
  </div>
<div id="node-1188" class="section-2">
  <h1 class="book-heading">Timer</h1>
  <p>Sometimes, it is useful to be able to call a function some time in 
the future rather than immediately. The timer library provides some 
basic functions to let you accomplish this.</p>

<h4 id="timer.performWithDelay_delay_listener_iterations_">timer.performWithDelay(
 delay, listener [, iterations] ) </h4>
<p>Invokes <span class="geshifilter"><code class="lua geshifilter-lua">listener</code></span>
 after <span class="geshifilter"><code class="lua geshifilter-lua">delay</code></span>
 milliseconds; returns a handle you can pass to <span 
class="geshifilter"><code class="lua geshifilter-lua">timer.cancel<span 
class="br0">(</span><span class="br0">)</span></code></span> to cancel 
the timer before it invokes <span class="geshifilter"><code class="lua 
geshifilter-lua">listener</code></span>. </p>
<p>The listener can be either a function listener or a table listener. 
If <span class="geshifilter"><code class="lua geshifilter-lua">listener</code></span>
 is a table, it must have a timer method because <a 
href="http://developer.anscamobile.com/events-and-listeners#timer">timer
 events</a> are sent to the listener. An optional parameter <span 
class="geshifilter"><code class="lua geshifilter-lua">iterations</code></span>
 specifies the number of times <span class="geshifilter"><code 
class="lua geshifilter-lua">listener</code></span> is invoked. By 
default, it is 1; pass 0 if you want it to loop forever. </p>

<table align="center" width="90%" cellspacing="0" cellpadding="0" 
border="1">
<tbody><tr>
<th>Function Listener</th>
<th>Table Listener</th>
</tr>
<tr>
<td>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="kw1">local</span> <span class="kw1">function</span> listener<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"listener called"</span> <span class="br0">)</span>
&nbsp;<span class="kw1">end</span>
&nbsp;
&nbsp;timer.performWithDelay<span class="br0">(</span>
&nbsp; &nbsp; <span class="nu0">1000</span>, listener <span class="br0">)</span></pre></td></tr></tbody></table></div>
</td>
   
<td>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> listener <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>
<span class="kw1">function</span> listener:timer<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"listener called )</span>
<span class="st0">end</span>
&nbsp;
<span class="st0">timer.performWithDelay(</span>
<span class="st0"> &nbsp; 1000, listener )</span></pre></td></tr></tbody></table></div>
</td>
</tr>
</tbody></table>

<h4 id="timer.cancel_timerId_">timer.cancel( timerId ) </h4>
<p>Cancels the timer operation associated with <span class="geshifilter"><code
 class="lua geshifilter-lua">timerId</code></span>.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="kw1">local</span> t <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;<span class="kw1">function</span> t:timer<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; <span class="kw1">local</span> count <span class="sy0">=</span> event.count
&nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Table listener called "</span> .. count .. <span class="st0">" time(s)"</span> <span class="br0">)</span>
&nbsp; &nbsp; <span class="kw1">if</span> count <span class="sy0">&gt;=</span> <span class="nu0">3</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; timer.cancel<span class="br0">(</span> self.source <span class="br0">)</span> <span class="co1">-- after 3rd invocation, cancel timer</span>
&nbsp; &nbsp; <span class="kw1">end</span>
&nbsp;<span class="kw1">end</span>
&nbsp;
&nbsp;
&nbsp;<span class="co1">-- Register to call t's timer method an infinite number of times</span>
&nbsp;timer.performWithDelay<span class="br0">(</span> <span class="nu0">1000</span>, t, <span class="nu0">0</span> <span class="br0">)</span></pre></td></tr></tbody></table></div>
  </div>
<div id="node-934" class="section-2">
  <h1 class="book-heading">Old: Lua Standard Libraries</h1>
  <p>Corona includes the standard Lua libraries that are part of the Lua
 distribution. These libraries provide useful and basic functionality. 
They are grouped into the following categories:</p>
<ul>
<li><strong>basic library</strong></li>
<li><strong>modules (external libraries)</strong></li>
<li><strong>string manipulation</strong></li>
<li><strong>table manipulation</strong></li>
<li><strong>mathematical functions (sin, log, etc.)</strong></li>
<li><strong>input and output</strong></li>
<li><strong>operating system facilities</strong></li>
</ul>
<p>Except for the basic library, each library provides all its functions
 as properties of a table or as methods of its objects. This creates a 
logical grouping of functions and is Lua’s way of creating a namespace 
for different sets of functionality.</p>
<p>For example, to calculate the square root of 100, you would use the 
square root function in the math library. The function is stored as the 
property <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="kw1">sqrt</span></code></span> of the global table math so you 
would call the square root function like so: <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">math.sqrt</span><span 
class="br0">(</span><span class="nu0">100</span><span class="br0">)</span></code></span>.</p>
<p>The original reference is available at 
http://www.lua.org/manual/5.1/manual.html#5. Note that for security and 
performance reasons, several functions have been removed from the 
original Lua libraries.</p>

<h3 id="Basic_Functions">Basic Functions</h3>

<h4 id="assert_v_message">assert (v [, message])</h4>
<p>Issues an error when the value of its argument v is false (i.e., nil 
or false); otherwise, returns all its arguments. message is an error 
message; when absent, it defaults to "assertion failed!"</p>

<h4 id="error_message_level">error (message [, level])</h4>
<p>Terminates the last protected function called and returns message as 
the error message. Function error never returns.</p>
<p>Usually, error adds some information about the error position at the 
beginning of the message. The level argument specifies how to get the 
error position. With level&nbsp;1 (the default), the error position is 
where the error function was called. Level&nbsp;2 points the error to 
where the function that called error was called; and so on. Passing a 
level&nbsp;0 avoids the addition of error position information to the 
message.</p>

<h4 id="G">_G</h4>
<p>A global variable (not a function) that holds the global environment 
(that is, _G._G = _G). Lua itself does not use this variable; changing 
its value does not affect any environment, nor vice-versa. (Use setfenv 
to change environments.)</p>

<h4 id="getfenv_f">getfenv ([f])</h4>
<p>Returns the current environment in use by the function. f can be a 
Lua function or a number that specifies the function at that stack 
level: Level&nbsp;1 is the function calling getfenv. If the given 
function is not a Lua function, or if f is 0, getfenv returns the global
 environment. The default for f is 1.</p>

<h4 id="getmetatable_object">getmetatable (object)</h4>
<p>If object does not have a metatable, returns nil. Otherwise, if the 
object's metatable has a "__metatable" field, returns the associated 
value. Otherwise, returns the metatable of the given object.</p>

<h4 id="ipairs_t">ipairs (t)</h4>
<p>Returns three values: an iterator function, the table t, and 0, so 
that the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> i,v <span class="kw1">in</span> <span class="kw1">ipairs</span><span class="br0">(</span>t<span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over the pairs (1,t[1]), (2,t[2]), ..., up to the first 
integer key absent from the table.</p>

<h4 id="next_table_index">next (table [, index])</h4>
<p>Allows a program to traverse all fields of a table. Its first 
argument is a table and its second argument is an index in this table. 
next returns the next index of the table and its associated value. When 
called with nil as its second argument, next returns an initial index 
and its associated value. When called with the last index, or with nil 
in an empty table, next returns nil. If the second argument is absent, 
then it is interpreted as nil. In particular, you can use next(t) to 
check whether a table is empty.</p>
<p>The order in which the indices are enumerated is not specified, even 
for numeric indices. (To traverse a table in numeric order, use a 
numerical for or the ipairs function.)</p>
<p>The behavior of next is undefined if, during the traversal, you 
assign any value to a non-existent field in the table. You may however 
modify existing fields. In particular, you may clear existing fields.</p>

<h4 id="pairs_t">pairs (t)</h4>
<p>Returns three values: the next function, the table t, and nil, so 
that the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> k,v <span class="kw1">in</span> <span class="kw1">pairs</span><span class="br0">(</span>t<span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all key–value pairs of table t.</p>
<p>See function next for the caveats of modifying the table during its 
traversal.</p>

<h4 id="pcall_f_arg1_...">pcall (f, arg1, ...)</h4>
<p>Calls function f with the given arguments in protected mode. This 
means that any error inside&nbsp;f is not propagated; instead, pcall 
catches the error and returns a status code. Its first result is the 
status code (a boolean), which is <strong>false</strong> if the call 
succeeds without errors. In such case, pcall also returns all results 
from the call, after this first result. In case of any error, pcall 
returns <strong>false</strong> plus the error message.</p>

<h4 id="print_...">print (...)</h4>
<p>Receives any number of arguments, and prints their values to stdout, 
using the tostring function to convert them to strings. print is not 
intended for formatted output, but only as a quick way to show a value, 
typically for debugging. For formatted output, use string.format.</p>

<h4 id="rawequal_v1_v2">rawequal (v1, v2)</h4>
<p>Checks whether v1 is equal to v2, without invoking any metamethod. 
Returns a boolean.</p>

<h4 id="rawget_table_index">rawget (table, index)</h4>
<p>Gets the real value of table[index], without invoking any metamethod.
 table must be a table; index may be any value.</p>

<h4 id="rawset_table_index_value">rawset (table, index, value)</h4>
<p>Sets the real value of table[index] to value, without invoking any 
metamethod. table must be a table, index any value different from nil, 
and value any Lua value.</p>
<p>This function returns table.</p>

<h4 id="select_index_...">select (index, ...)</h4>
<p>If index is a number, returns all arguments after argument number 
index. Otherwise, index must be the string "#", and select returns the 
total number of extra arguments it received.</p>

<h4 id="setfenv_f_table">setfenv (f, table)</h4>
<p>Sets the environment to be used by the given function. f can be a Lua
 function or a number that specifies the function at that stack level: 
Level&nbsp;1 is the function calling setfenv. setfenv returns the given 
function.</p>
<p>As a special case, when f is 0 setfenv changes the environment of the
 running thread. In this case, setfenv returns no values.</p>

<h4 id="setmetatable_table_metatable">setmetatable (table, metatable)</h4>
<p>Sets the metatable for the given table. (You cannot change the 
metatable of other types from Lua, only from&nbsp;C.) If metatable is 
nil, removes the metatable of the given table. If the original metatable
 has a "__metatable" field, raises an error.</p>
<p>This function returns table.</p>

<h4 id="tonumber_e_base">tonumber (e [, base])</h4>
<p>Tries to convert its argument to a number. If the argument is already
 a number or a string convertible to a number, then tonumber returns 
this number; otherwise, it returns nil.</p>
<p>An optional argument specifies the base to interpret the numeral. The
 base may be any integer between 2 and 36, inclusive. In bases 
above&nbsp;10, the letter 'A' (in either upper or lower case) 
represents&nbsp;10, 'B' represents&nbsp;11, and so forth, with 'Z' 
representing 35. In base 10 (the default), the number can have a decimal
 part, as well as an optional exponent part (see §2.1). In other bases, 
only unsigned integers are accepted.</p>

<h4 id="tostring_e">tostring (e)</h4>
<p>Receives an argument of any type and converts it to a string in a 
reasonable format. For complete control of how numbers are converted, 
use string.format.</p>
<p>If the metatable of e has a "__tostring" field, then tostring calls 
the corresponding value with e as argument, and uses the result of the 
call as its result.</p>

<h4 id="type_v">type (v)</h4>
<p>Returns the type of its only argument, coded as a string. The 
possible results of this function are "nil" (a string, not the value 
nil), "number", "string", "boolean", "table", "function", "thread", and 
"userdata".</p>

<h4 id="unpack_list_i_j">unpack (list [, i [, j]])</h4>
<p>Returns the elements from the given table. This function is 
equivalent to</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">return</span> list<span class="br0">[</span>i<span class="br0">]</span>, list<span class="br0">[</span>i+<span class="nu0">1</span><span class="br0">]</span>, ..., list<span class="br0">[</span>j<span class="br0">]</span></pre></td></tr></tbody></table></div>
<p>except that the above code can be written only for a fixed number of 
elements. By default, i is&nbsp;1 and j is the length of the list, as 
defined by the length operator (see §2.5.5).</p>

<h3 id="Modules">Modules</h3>
<p>Corona supports Lua’s module functionality for creating and loading 
external libraries. Currently, two example libraries are shipped with 
the SDK: “ui.lua” (for creating rollover buttons) and “sprite.lua” (for 
creating animated sprites, or “movieclips”).  </p>
<p>These libraries can be found in the sample projects “Button” and 
“Movieclip”, located in the Sample Code directory of the SDK. To use 
them in your own projects, copy them to your project directory.</p>
<p>You can also create Lua modules of your own, which is helpful for 
organizing large projects into multiple files, or creating reusable code
 libraries for future projects.</p>
<h3 id="Creating_external_libraries">Creating external libraries</h3>
<p>The easiest way to create a module is to use the following format, 
and save it to the same directory as your project’s main.lua file:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1">module<span class="br0">(</span>..., package.seeall<span class="br0">)</span>
&nbsp;
<span class="co1">-- Declare the functions you want in your module</span>
<span class="kw1">function</span> hello<span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span> <span class="br0">(</span><span class="st0">"Hello, module"</span><span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>The first line should be entered as shown here, including the three 
dots. Modules should be saved with a “.lua” file extension: for example,
 “testlib.lua”. </p>
<h3 id="Loading_external_libraries">Loading external libraries</h3>
<p>To load a module from your project directory, use <strong>require 
(modname)</strong> at the beginning of your main.lua file. The functions
 within the module will then be available using the format <strong>modname.functionname().</strong></p>
<p>You can optimize your main.lua by caching library functions as local 
variables:</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Load external library (should be in the same folder as main.lua)</span>
<span class="kw1">local</span> testlib <span class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span class="st0">"testlib"</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- Now the functions in "testlib.lua" are available here:</span>
&nbsp;
<span class="co1">-- call the testlib library function hello(). The "slow" way</span>
testlib.hello<span class="br0">(</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- cache same function, if you call more than once</span>
<span class="kw1">local</span> hello <span class="sy0">=</span> testlib.hello<span class="br0">(</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- now all future invocations are "fast"</span>
hello<span class="br0">(</span><span class="br0">)</span></pre></td></tr></tbody></table></div>

<h3 id="Syntax">Syntax</h3>

<h4 id="module_name_">module (name [, ···])</h4>
<p>Creates a module. If there is a table in package.loaded[name], this 
table is the module. Otherwise, if there is a global table t with the 
given name, this table is the module. Otherwise creates a new table t 
and sets it as the value of the global name and the value of 
package.loaded[name]. This function also initializes t._NAME with the 
given name, t._M with the module (t itself), and t._PACKAGE with the 
package name (the full module name minus last component; see below). 
Finally, module sets t as the new environment of the current function 
and the new value of package.loaded[name], so that require returns t.</p>
<p>This function may receive optional options after the module name, 
where each option is a function to be applied over the module.</p>

<h4 id="require_modname">require (modname)</h4>
<p>Loads the given module. The function starts by looking into the 
package.loaded table to determine whether modname is already loaded. If 
it is, then require returns the value stored at package.loaded[modname].
 Otherwise, it tries to find a loader for the module.</p>
<p>To find a loader, require is guided by the package.loaders array. By 
changing this array, we can change how require looks for a module. The 
following explanation is based on the default configuration for 
package.loaders.</p>
<p>First, require queries package.preload[modname]. If it has a value, 
this value (which should be a function) is the loader. Otherwise require
 searches for a Lua loader using the path stored in package.path. If 
that also fails, it tries an all-in-one loader (see package.loaders).</p>
<p>Once a loader is found, require calls the loader with a single 
argument, modname. If the loader returns any value, require assigns the 
returned value to package.loaded[modname]. If the loader returns no 
value and has not assigned any value to package.loaded[modname], then 
require assigns true to this entry. In any case, require returns the 
final value of package.loaded[modname].</p>
<p>If there is any error loading or running the module, or if it cannot 
find any loader for the module, then require signals an error.</p>

<h4 id="package.loaded">package.loaded</h4>
<p>A table used by require to control which modules are already loaded. 
When you require a module modname and package.loaded[modname] is not 
false, require simply returns the value stored there.</p>

<h4 id="package.loaders">package.loaders</h4>
<p>A table used by require to control how to load modules.</p>
<p>Each entry in this table is a searcher function. When looking for a 
module, require calls each of these searchers in ascending order, with 
the module name (the argument given to require) as its sole parameter. 
The function may return another function (the module loader) or a string
 explaining why it did not find that module (or nil if it has nothing to
 say). </p>
<p>When running in the simulator, the searcher looks for Lua files that 
can serve as Lua libraries. These Lua files must be in the same 
directory as your main.lua file. As long as they are in the same 
directory as your main.lua file, they will be packaged for you during 
device builds.</p>
<h4 id="package.seeall_module">package.seeall (module)</h4>
<p>Sets a metatable for module with its __index field referring to the 
global environment, so that this module inherits values from the global 
environment. To be used as an option to function module.</p>

<h2 id="String_Manipulation">String Manipulation</h2>
<p>This library provides generic functions for string manipulation, such
 as finding and extracting substrings, and pattern matching. When 
indexing a string in Lua, the first character is at position&nbsp;1 (not
 at&nbsp;0, as in C). Indices are allowed to be negative and are 
interpreted as indexing backwards, from the end of the string. Thus, the
 last character is at position -1, and so on.</p>
<p>The string library provides all its functions inside the table 
string. It also sets a metatable for strings where the __index field 
points to the string table. Therefore, you can use the string functions 
in object-oriented style. For instance, string.byte(s, i) can be written
 as s:byte(i).</p>
<p>The string library assumes one-byte character encodings.</p>

<h4 id="string.byte_s_i_j">string.byte (s [, i [, j]])</h4>
<p>Returns the internal numerical codes of the characters s[i], s[i+1], 
..., s[j]. The default value for i is&nbsp;1; the default value for j 
is&nbsp;i.</p>
<p>Note that numerical codes are not necessarily portable across 
platforms.</p>

<h4 id="string.char_...">string.char (...)</h4>
<p>Receives zero or more integers. Returns a string with length equal to
 the number of arguments, in which each character has the internal 
numerical code equal to its corresponding argument.</p>
<p>Note that numerical codes are not necessarily portable across 
platforms.</p>

<h4 id="string.find_s_pattern_init_plain">string.find (s, pattern [, 
init [, plain]])</h4>
<p>Looks for the first match of pattern in the string s. If it finds a 
match, then find returns the indices of&nbsp;s where this occurrence 
starts and ends; otherwise, it returns nil. A third, optional numerical 
argument init specifies where to start the search; its default value 
is&nbsp;1 and can be negative. A value of false as a fourth, optional 
argument plain turns off the pattern matching facilities, so the 
function does a plain "find substring" operation, with no characters in 
pattern being considered "magic". Note that if plain is given, then init
 must be given as well.</p>
<p>If the pattern has captures, then in a successful match the captured 
values are also returned, after the two indices.</p>

<h4 id="string.format_formatstring_...">string.format (formatstring, 
...)</h4>
<p>Returns a formatted version of its variable number of arguments 
following the description given in its first argument (which must be a 
string). The format string follows the same rules as the printf family 
of standard C&nbsp;functions. The only differences are that the 
options/modifiers *, l, L, n, p, and h are not supported and that there 
is an extra option, q. The q option formats a string in a form suitable 
to be safely read back by the Lua interpreter: the string is written 
between double quotes, and all double quotes, newlines, embedded zeros, 
and backslashes in the string are correctly escaped when written. For 
instance, the call</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">string.format</span><span class="br0">(</span><span class="st0">'%q'</span>, <span class="st0">'a string with "quotes" and <span class="es0">\n</span> new line'</span><span class="br0">)</span></pre></td></tr></tbody></table></div>
<p>will produce the string:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="st0">"a string with <span class="es0">\"</span>quotes<span class="es0">\"</span> and <span class="es0">\</span></span>
<span class="st0"> &nbsp; &nbsp; &nbsp;new line"</span></pre></td></tr></tbody></table></div>
<p>The options c, d, E, e, f, g, G, i, o, u, X, and x all expect a 
number as argument, whereas q and s expect a string.</p>
<p>This function does not accept string values containing embedded 
zeros, except as arguments to the q option.</p>

<h4 id="string.gmatch_s_pattern">string.gmatch (s, pattern)</h4>
<p>Returns an iterator function that, each time it is called, returns 
the next captures from pattern over string s. If pattern specifies no 
captures, then the whole match is produced in each call.</p>
<p>As an example, the following loop</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;s <span class="sy0">=</span> <span class="st0">"hello world from Lua"</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> w <span class="kw1">in</span> <span class="kw1">string</span>.gmatch<span class="br0">(</span>s, <span class="st0">"%a+"</span><span class="br0">)</span> <span class="kw1">do</span>
&nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span>w<span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all the words from string s, printing one per line.
 The next example collects all pairs key=value from the given string 
into a table:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;t <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp; &nbsp; &nbsp;s <span class="sy0">=</span> <span class="st0">"from=world, to=Lua"</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> k, v <span class="kw1">in</span> <span class="kw1">string</span>.gmatch<span class="br0">(</span>s, <span class="st0">"(%w+)=(%w+)"</span><span class="br0">)</span> <span class="kw1">do</span>
&nbsp; &nbsp; &nbsp; &nbsp;t<span class="br0">[</span>k<span class="br0">]</span> <span class="sy0">=</span> v
&nbsp; &nbsp; &nbsp;<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>For this function, a '^' at the start of a pattern does not work as 
an anchor, as this would prevent the iteration.</p>

<h4 id="string.gsub_s_pattern_repl_n">string.gsub (s, pattern, repl [, 
n])</h4>
<p>Returns a copy of s in which all (or the first n, if given) 
occurrences of the pattern have been replaced by a replacement string 
specified by repl, which can be a string, a table, or a function. gsub 
also returns, as its second value, the total number of matches that 
occurred.</p>
<p>If repl is a string, then its value is used for replacement. The 
character&nbsp;% works as an escape character: any sequence in repl of 
the form %n, with n between 1 and 9, stands for the value of the n-th 
captured substring (see below). The sequence %0 stands for the whole 
match. The sequence %% stands for a single&nbsp;%.</p>
<p>If repl is a table, then the table is queried for every match, using 
the first capture as the key; if the pattern specifies no captures, then
 the whole match is used as the key.</p>
<p>If repl is a function, then this function is called every time a 
match occurs, with all captured substrings passed as arguments, in 
order; if the pattern specifies no captures, then the whole match is 
passed as a sole argument.</p>
<p>If the value returned by the table query or by the function call is a
 string or a number, then it is used as the replacement string; 
otherwise, if it is false or nil, then there is no replacement (that is,
 the original match is kept in the string).</p>
<p>Here are some examples:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"hello world"</span>, <span class="st0">"(%w+)"</span>, <span class="st0">"%1 %1"</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="hello hello world world"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"hello world"</span>, <span class="st0">"%w+"</span>, <span class="st0">"%0 %0"</span>, <span class="nu0">1</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="hello hello world"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"hello world from Lua"</span>, <span class="st0">"(%w+)%s*(%w+)"</span>, <span class="st0">"%2 %1"</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="world hello Lua from"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"home = $HOME, user = $USER"</span>, <span class="st0">"%$(%w+)"</span>, <span class="kw1">os.getenv</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="home = /home/roberto, user = roberto"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"4+5 = $return 4+5$"</span>, <span class="st0">"%$(.-)%$"</span>, <span class="kw1">function</span> <span class="br0">(</span>s<span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">return</span> <span class="kw1">loadstring</span><span class="br0">(</span>s<span class="br0">)</span><span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">end</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="4+5 = 9"</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;<span class="kw1">local</span> t <span class="sy0">=</span> <span class="br0">{</span>name<span class="sy0">=</span><span class="st0">"lua"</span>, version<span class="sy0">=</span><span class="st0">"5.1"</span><span class="br0">}</span>
&nbsp; &nbsp; &nbsp;x <span class="sy0">=</span> <span class="kw1">string.gsub</span><span class="br0">(</span><span class="st0">"$name-$version.tar.gz"</span>, <span class="st0">"%$(%w+)"</span>, t<span class="br0">)</span>
&nbsp; &nbsp; &nbsp;<span class="co1">--&gt; x="lua-5.1.tar.gz"</span></pre></td></tr></tbody></table></div>

<h4 id="string.len_s">string.len (s)</h4>
<p>Receives a string and returns its length. The empty string "" has 
length 0. Embedded zeros are counted, so "a\000bc\000" has length 5.</p>

<h4 id="string.lower_s">string.lower (s)</h4>
<p>Receives a string and returns a copy of this string with all 
uppercase letters changed to lowercase. All other characters are left 
unchanged. The definition of what an uppercase letter is depends on the 
current locale.</p>

<h4 id="string.match_s_pattern_init">string.match (s, pattern [, init])</h4>
<p>Looks for the first match of pattern in the string s. If it finds 
one, then match returns the captures from the pattern; otherwise it 
returns nil. If pattern specifies no captures, then the whole match is 
returned. A third, optional numerical argument init specifies where to 
start the search; its default value is&nbsp;1 and can be negative.</p>

<h4 id="string.rep_s_n">string.rep (s, n)</h4>
<p>Returns a string that is the concatenation of n copies of the string 
s.</p>

<h4 id="string.reverse_s">string.reverse (s)</h4>
<p>Returns a string that is the string s reversed.</p>

<h4 id="string.sub_s_i_j">string.sub (s, i [, j])</h4>
<p>Returns the substring of s that starts at i and continues until j; i 
and j can be negative. If j is absent, then it is assumed to be equal to
 -1 (which is the same as the string length). In particular, the call 
string.sub(s,1,j) returns a prefix of s with length j, and string.sub(s,
 -i) returns a suffix of s with length i.</p>

<h4 id="string.upper_s">string.upper (s)</h4>
<p>Receives a string and returns a copy of this string with all 
lowercase letters changed to uppercase. All other characters are left 
unchanged. The definition of what a lowercase letter is depends on the 
current locale.</p>

<h3 id="Patterns">Patterns</h3>

<h4 id="Character_Class:">Character Class:</h4>

<p>A character class is used to represent a set of characters. The 
following combinations are allowed in describing a character class:
x: (where x is not one of the magic characters ^$()%.[]*+-?) represents 
the character x itself.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">.</code></span>:
 (a dot) represents all characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>a</code></span>: represents all letters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>c</code></span>: represents all control characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>d</code></span>: represents all digits.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>l</code></span>: represents all lowercase letters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>p</code></span>: represents all punctuation 
characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>s</code></span>: represents all space characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>u</code></span>: represents all uppercase letters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>w</code></span>: represents all alphanumeric 
characters.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>x</code></span>: represents all hexadecimal digits.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>z</code></span>: represents the character with 
representation 0.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="sy0">%</span>x</code></span>: (where x is any non-alphanumeric 
character) represents the character x. This is the standard way to 
escape the magic characters. Any punctuation character (even the non 
magic) can be preceded by a '%' when used to represent itself in a 
pattern.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="br0">[</span>set<span class="br0">]</span></code></span>: 
represents the class which is the union of all characters in set. A 
range of characters can be specified by separating the end characters of
 the range with a '-'. All classes %x described above can also be used 
as components in set. All other characters in set represent themselves. 
For example, [%w_] (or [_%w]) represents all alphanumeric characters 
plus the underscore, [0-7] represents the octal digits, and [0-7%l%-] 
represents the octal digits plus the lowercase letters plus the '-' 
character. The interaction between ranges and classes is not defined. 
Therefore, patterns like [%a-z] or [a-%%] have no meaning. </p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="br0">[</span>^set<span class="br0">]</span></code></span>: 
represents the complement of set, where set is interpreted as above.</p>
<p>For all classes represented by single letters (%a, %c, etc.), the 
corresponding uppercase letter represents the complement of the class. 
For instance, %S represents all non-space characters.</p>
<p>The definitions of letter, space, and other character groups depend 
on the current locale. In particular, the class [a-z] may not be 
equivalent to %l.</p>

<h4 id="Pattern_Item:">Pattern Item:</h4>
<p>A pattern item can be</p>
<ul>
<li>a single character class, which matches any single character in the 
class;</li>
<li>a single character class followed by '*', which matches 0 or more 
repetitions of characters in the class. These repetition items will 
always match the longest possible sequence;</li>
<li>a single character class followed by '+', which matches 1 or more 
repetitions of characters in the class. These repetition items will 
always match the longest possible sequence;</li>
<li>a single character class followed by '-', which also matches 0 or 
more repetitions of characters in the class. Unlike '*', these 
repetition items will always match the shortest possible sequence;</li>
<li>a single character class followed by '?', which matches 0 or 1 
occurrence of a character in the class;</li>
<li>%n, for n between 1 and 9; such item matches a substring equal to 
the n-th captured string (see below);</li>
<li>%bxy, where x and y are two distinct characters; such item matches 
strings that start with&nbsp;x, end with&nbsp;y, and where the x and y 
are balanced. This means that, if one reads the string from left to 
right, counting +1 for an x and -1 for a y, the ending y is the first y 
where the count reaches 0. For instance, the item %b() matches 
expressions with balanced parentheses.</li>
</ul>

<h4 id="Pattern:">Pattern:</h4>
<p>A pattern is a sequence of pattern items. A '^' at the beginning of a
 pattern anchors the match at the beginning of the subject string. A '$'
 at the end of a pattern anchors the match at the end of the subject 
string. At other positions, '^' and '$' have no special meaning and 
represent themselves.</p>

<h4 id="Captures:">Captures:</h4>
<p>A pattern can contain sub-patterns enclosed in parentheses; they 
describe captures. When a match succeeds, the substrings of the subject 
string that match captures are stored (captured) for future use. 
Captures are numbered according to their left parentheses. For instance,
 in the pattern "(a*(.)%w(%s*))", the part of the string matching 
"a*(.)%w(%s*)" is stored as the first capture (and therefore has 
number&nbsp;1); the character matching "." is captured with 
number&nbsp;2, and the part matching "%s*" has number&nbsp;3.</p>
<p>As a special case, the empty capture () captures the current string 
position (a number). For instance, if we apply the pattern "()aa()" on 
the string "flaaap", there will be two captures: 3&nbsp;and&nbsp;5.</p>
<p>A pattern cannot contain embedded zeros. Use %z instead.</p>

<h3 id="Table_Manipulation">Table Manipulation</h3>
<p>This library provides generic functions for table manipulation. It 
provides all its functions inside the table table.</p>
<p>Most functions in the table library assume that the table represents 
an array or a list. For these functions, when we talk about the "length"
 of a table we mean the result of the length operator.</p>

<h4 id="table.concat_table_sep_i_j">table.concat (table [, sep [, i [, 
j]]])</h4>
<p>Given an array where all elements are strings or numbers, returns 
table[i]..sep..table[i+1] ... sep..table[j]. The default value for sep 
is the empty string, the default for i is 1, and the default for j is 
the length of the table. If i is greater than j, returns the empty 
string.</p>

<h4 id="table.insert_table_pos_value">table.insert (table, [pos,] value)</h4>
<p>Inserts element value at position <span class="geshifilter"><code 
class="lua geshifilter-lua">pos</code></span> in <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">table</span></code></span>,
 shifting up other elements to open space, if necessary. The default 
value for <span class="geshifilter"><code class="lua geshifilter-lua">pos</code></span>
 is <span class="geshifilter"><code class="lua geshifilter-lua">n+<span 
class="nu0">1</span></code></span>, where <span class="geshifilter"><code
 class="lua geshifilter-lua">n</code></span> is the length of the table,
 so that a call <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">table.insert</span><span class="br0">(</span>t,x<span
 class="br0">)</span></code></span> inserts <span class="geshifilter"><code
 class="lua geshifilter-lua">x</code></span> at the end of table <span 
class="geshifilter"><code class="lua geshifilter-lua">t</code></span>; 
however, if you are inserting at the end of the table, it is faster to 
use the length operator: <span class="geshifilter"><code class="lua 
geshifilter-lua">t<span class="br0">[</span>#t + <span class="nu0">1</span><span
 class="br0">]</span> <span class="sy0">=</span> x</code></span>.</p>

<h4 id="table.maxn_table">table.maxn (table)</h4>
<p>Returns the largest positive numerical index of the given table, or 
zero if the table has no positive numerical indices. (To do its job this
 function does a linear traversal of the whole table.)</p>

<h4 id="table.remove_table_pos">table.remove (table [, pos])</h4>
<p>Removes from table the element at position pos, shifting down other 
elements to close the space, if necessary. Returns the value of the 
removed element. The default value for pos is n, where n is the length 
of the table, so that a call table.remove(t) removes the last element of
 table t.</p>

<h4 id="table.sort_table_comp">table.sort (table [, comp])</h4>
<p>Sorts table elements in a given order, in-place, from table[1] to 
table[n], where n is the length of the table. If comp is given, then it 
must be a function that receives two table elements, and returns false 
when the first is less than the second (so that not comp(a[i+1],a[i]) 
will be false after the sort). If comp is not given, then the standard 
Lua operator &lt; is used instead.</p>
<p>The sort algorithm is not stable; that is, elements considered equal 
by the given order may have their relative positions changed by the 
sort.</p>

<h3 id="Mathematical_Functions">Mathematical Functions</h3>
<p>This library is an interface to the standard C&nbsp;math library. It 
provides all its functions inside the table <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">math</span></code></span>.</p>

<h4 id="math.abs_x">math.abs (x)</h4>
<p>Returns the absolute value of x.</p>

<h4 id="math.acos_x">math.acos (x)</h4>
<p>Returns the arc cosine of x (in radians).</p>

<h4 id="math.asin_x">math.asin (x)</h4>
<p>Returns the arc sine of x (in radians).</p>

<h4 id="math.atan_x">math.atan (x)</h4>
<p>Returns the arc tangent of x (in radians).</p>

<h4 id="math.atan2_y_x">math.atan2 (y, x)</h4>
<p>Returns the arc tangent of y/x (in radians), but uses the signs of 
both parameters to find the quadrant of the result. (It also handles 
correctly the case of x being zero.)</p>

<h4 id="math.ceil_x">math.ceil (x)</h4>
<p>Returns the smallest integer larger than or equal to x.</p>

<h4 id="math.cos_x">math.cos (x)</h4>
<p>Returns the cosine of x (assumed to be in radians).</p>

<h4 id="math.cosh_x">math.cosh (x)</h4>
<p>Returns the hyperbolic cosine of x.</p>

<h4 id="math.deg_x">math.deg (x)</h4>
<p>Returns the angle x (given in radians) in degrees.</p>

<h4 id="math.exp_x">math.exp (x)</h4>
<p>Returns the value ex.</p>

<h4 id="math.floor_x">math.floor (x)</h4>
<p>Returns the largest integer smaller than or equal to x.</p>

<h4 id="math.fmod_x_y">math.fmod (x, y)</h4>
<p>Returns the remainder of the division of x by y that rounds the 
quotient towards zero.</p>

<h4 id="math.frexp_x">math.frexp (x)</h4>
<p>Returns m and e such that x = m2e, e is an integer and the absolute 
value of m is in the range [0.5, 1) (or zero when x is zero).</p>

<h4 id="math.huge">math.huge</h4>
<p>The value HUGE_VAL, a value larger than or equal to any other 
numerical value.</p>

<h4 id="math.ldexp_m_e">math.ldexp (m, e)</h4>
<p>Returns m2e (e should be an integer).</p>

<h4 id="math.log_x">math.log (x)</h4>
<p>Returns the natural logarithm of x.</p>

<h4 id="math.log10_x">math.log10 (x)</h4>
<p>Returns the base-10 logarithm of x.</p>

<h4 id="math.max_x_...">math.max (x, ...)</h4>
<p>Returns the maximum value among its arguments.</p>

<h4 id="math.min_x_...">math.min (x, ...)</h4>
<p>Returns the minimum value among its arguments.</p>

<h4 id="math.modf_x">math.modf (x)</h4>
<p>Returns two numbers, the integral part of x and the fractional part 
of x.</p>

<h4 id="math.pi">math.pi</h4>
<p>The value of pi.</p>

<h4 id="math.pow_x_y">math.pow (x, y)</h4>
<p>Returns xy. (You can also use the expression x^y to compute this 
value.)</p>

<h4 id="math.rad_x">math.rad (x)</h4>
<p>Returns the angle x (given in degrees) in radians.</p>

<h4 id="math.random_m_n">math.random ([m [, n]])</h4>
<p>This function is an interface to the simple pseudo-random generator 
function rand provided by ANSI&nbsp;C. (No guarantees can be given for 
its statistical properties.)</p>
<p>When called without arguments, returns a uniform pseudo-random real 
number in the range [0,1). When called with an integer number m, 
math.random returns a uniform pseudo-random integer in the range [1, m].
 When called with two integer numbers m and n, math.random returns a 
uniform pseudo-random integer in the range [m, n].</p>

<h4 id="math.randomseed_x">math.randomseed (x)</h4>
<p>Sets x as the "seed" for the pseudo-random generator: equal seeds 
produce equal sequences of numbers.</p>

<h4 id="math.sin_x">math.sin (x)</h4>
<p>Returns the sine of x (assumed to be in radians).</p>
<h4 id="math.sinh_x">math.sinh (x)</h4>
<p>Returns the hyperbolic sine of x.</p>
<h4 id="math.sqrt_x">math.sqrt (x)</h4>
<p>Returns the square root of x. (You can also use the expression x^0.5 
to compute this value.)</p>
<h4 id="math.tan_x">math.tan (x)</h4>
<p>Returns the tangent of x (assumed to be in radians).</p>
<h4 id="math.tanh_x">math.tanh (x)</h4>
<p>Returns the hyperbolic tangent of x.</p>

<h2 id="Input_and_Output_Facilities">Input and Output Facilities</h2>

<p>The I/O library provides two different styles for file manipulation. 
The first one implicitly operates on a default file object; that is, 
there are operations to set a default input file and a default output 
file, and all input/output operations are over these default files. The 
second style uses explicit file objects.</p>
<p>When using implicit file descriptors, all operations are supplied by 
table io. When using explicit file descriptors, the operation <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">io.open</span></code></span>
 returns a file descriptor and then all operations are supplied as 
methods of the file descriptor.</p>
<p>The table io also provides three predefined file descriptors with 
their usual meanings from C: <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">io.stdin</span></code></span>, <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">io.stdout</span></code></span>,
 and <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="kw1">io.stderr</span></code></span>. The I/O library never closes
 these files.</p>
<p>Unless otherwise stated, all I/O functions return nil on failure 
(plus an error message as a second result and a system-dependent error 
code as a third result) and some value different from nil on success.</p>
<h3 id="File_paths">File paths</h3>
<p>For security reasons, you can only open files in your application's 
sandbox. The io library requires you to supply paths to these files. To 
do so, you use <span class="geshifilter"><code class="lua 
geshifilter-lua">system.pathForFile</code></span>.</p>
<p>Here's an example of how to open an existing file or create one if it
 does not already exist:</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="de1"><pre class="de1"><span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"data.txt"</span>, system.DocumentsDirectory <span class="br0">)</span>
&nbsp;
<span class="co1">-- io.open opens a file at path. returns nil if no file found</span>
<span class="kw1">local</span> file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"r"</span> <span class="br0">)</span>
<span class="kw1">if</span> file <span class="kw1">then</span>
&nbsp; &nbsp;<span class="co1">-- read all contents of file into a string</span>
&nbsp; &nbsp;<span class="kw1">local</span> contents <span class="sy0">=</span> file:<span class="kw1">read</span><span class="br0">(</span> <span class="st0">"*a"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Contents of "</span> .. path .. <span class="st0">"<span class="es0">\n</span>"</span> .. contents <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">else</span>
&nbsp; &nbsp;<span class="co1">-- create file b/c it doesn't exist yet</span>
&nbsp; &nbsp;file <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"w"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">local</span> numbers <span class="sy0">=</span> <span class="br0">{</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span>,<span class="nu0">5</span>,<span class="nu0">6</span>,<span class="nu0">7</span>,<span class="nu0">8</span>,<span class="nu0">9</span><span class="br0">}</span>
&nbsp; &nbsp;file:<span class="kw1">write</span><span class="br0">(</span> <span class="st0">"Feed me data!<span class="es0">\n</span>"</span>, numbers<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>, numbers<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>, <span class="st0">"<span class="es0">\n</span>"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">for</span> _,v <span class="kw1">in</span> <span class="kw1">ipairs</span><span class="br0">(</span> numbers <span class="br0">)</span> <span class="kw1">do</span> file:<span class="kw1">write</span><span class="br0">(</span> v, <span class="st0">" "</span> <span class="br0">)</span> <span class="kw1">end</span>
&nbsp; &nbsp;file:<span class="kw1">write</span><span class="br0">(</span> <span class="st0">"<span class="es0">\n</span>No more data<span class="es0">\n</span>"</span> <span class="br0">)</span>
&nbsp; &nbsp;<span class="kw1">io.close</span><span class="br0">(</span> file <span class="br0">)</span>
<span class="kw1">end</span></pre></td></tr></tbody></table></div>
<h3 id="Implicit_default_file_manipulation">Implicit (default) file 
manipulation</h3>

<h4 id="io.close_file">io.close ([file])</h4>
<p>Equivalent to file:close(). Without a file, closes the default output
 file.</p>

<h4 id="io.flush_">io.flush ()</h4>
<p>Equivalent to file:flush over the default output file.</p>

<h4 id="io.input_file">io.input ([file])</h4>
<p>When called with a file name, it opens the named file (in text mode),
 and sets its handle as the default input file. When called with a file 
handle, it simply sets this file handle as the default input file. When 
called without parameters, it returns the current default input file.</p>
<p>In case of errors this function raises the error, instead of 
returning an error code.</p>

<h4 id="io.lines_filename">io.lines ([filename])</h4>
<p>Opens the given file name in read mode and returns an iterator 
function that, each time it is called, returns a new line from the file.
 Therefore, the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> line <span class="kw1">in</span> <span class="kw1">io.lines</span><span class="br0">(</span>filename<span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all lines of the file. When the iterator function 
detects the end of file, it returns nil (to finish the loop) and 
automatically closes the file.</p>
<p>The call io.lines() (with no file name) is equivalent to 
io.input():lines(); that is, it iterates over the lines of the default 
input file. In this case it does not close the file when the loop ends.</p>

<h4 id="io.open_filename_mode">io.open (filename [, mode])</h4>
<p>This function opens a file, in the mode specified in the string mode.
 It returns a new file handle, or, in case of errors, nil plus an error 
message.</p>
<p>The mode string can be any of the following:</p>
<p>"r": read mode (the default);</p>
<p>"w": write mode;</p>
<p>"a": append mode;</p>
<p>"r+": update mode, all previous data is preserved;</p>
<p>"w+": update mode, all previous data is erased;</p>
<p>"a+": append update mode, previous data is preserved, writing is only
 allowed at the end of file.</p>
<p>The mode string can also have a 'b' at the end, which is needed in 
some systems to open the file in binary mode. This string is exactly 
what is used in the standard&nbsp;C function fopen.</p>

<h4 id="io.output_file">io.output ([file])</h4>
<p>Similar to <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="kw1">io.input</span></code></span>, but 
operates over the default output file.</p>

<h4 id="io.popen_prog_mode">io.popen (prog [, mode])</h4>
<p>Starts program prog in a separated process and returns a file handle 
that you can use to read data from this program (if mode is "r", the 
default) or to write data to this program (if mode is "w").</p>
<p>This function is system dependent and is not available on all 
platforms.</p>

<h4 id="io.read_...">io.read (...)</h4>
<p>Equivalent to io.input():read.</p>

<h4 id="io.tmpfile_">io.tmpfile ()</h4>
<p>Returns a handle for a temporary file. This file is opened in update 
mode and it is automatically removed when the program ends.</p>

<h4 id="io.type_obj">io.type (obj)</h4>
<p>Checks whether obj is a valid file handle. Returns the string "file" 
if obj is an open file handle, "closed file" if obj is a closed file 
handle, or nil if obj is not a file handle.</p>

<h4 id="io.write_...">io.write (...)</h4>
<p>Equivalent to io.output():write.</p>

<h3 id="Explicit_file_manipulation">Explicit file manipulation</h3>

<p>You create a file object using the object returned by the function 
io.open. Note the use of colon ':' indicating that all operations are on
 the object (see Object Methods).</p>

<h4 id="file:close_">file:close ()</h4>
<p>Closes file. Note that files are automatically closed when their 
handles are garbage collected, but that takes an unpredictable amount of
 time to happen.</p>

<h4 id="file:flush_">file:flush ()</h4>
<p>Saves any written data to file.</p>

<h4 id="file:lines_">file:lines ()</h4>
<p>Returns an iterator function that, each time it is called, returns a 
new line from the file. Therefore, the construction</p>
<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; &nbsp;<span class="kw1">for</span> line <span class="kw1">in</span> file:lines<span class="br0">(</span><span class="br0">)</span> <span class="kw1">do</span> body <span class="kw1">end</span></pre></td></tr></tbody></table></div>
<p>will iterate over all lines of the file. (Unlike io.lines, this 
function does not close the file when the loop ends.)</p>

<h4 id="file:read_...">file:read (...)</h4>
<p>Reads the file file, according to the given formats, which specify 
what to read. For each format, the function returns a string (or a 
number) with the characters read, or nil if it cannot read data with the
 specified format. When called without formats, it uses a default format
 that reads the entire next line (see below).</p>
<p>The available formats are</p>
<p>"*n": reads a number; this is the only format that returns a number 
instead of a string.</p>
<p>"*a": reads the whole file, starting at the current position. On end 
of file, it returns the empty string.</p>
<p>"*l": reads the next line (skipping the end of line), returning nil 
on end of file. This is the default format.</p>
<p>number: reads a string with up to this number of characters, 
returning nil on end of file. If number is zero, it reads nothing and 
returns an empty string, or nil on end of file.</p>

<h4 id="file:seek_whence_offset">file:seek ([whence] [, offset])</h4>
<p>Sets and gets the file position, measured from the beginning of the 
file, to the position given by offset plus a base specified by the 
string whence, as follows:</p>
<p>"set": base is position 0 (beginning of the file);</p>
<p>"cur": base is current position;</p>
<p>"end": base is end of file;</p>
<p>In case of success, function seek returns the final file position, 
measured in bytes from the beginning of the file. If this function 
fails, it returns nil, plus a string describing the error.</p>
<p>The default value for whence is "cur", and for offset is 0. 
Therefore, the call file:seek() returns the current file position, 
without changing it; the call file:seek("set") sets the position to the 
beginning of the file (and returns 0); and the call file:seek("end") 
sets the position to the end of the file, and returns its size.</p>

<h4 id="file:setvbuf_mode_size">file:setvbuf (mode [, size])</h4>
<p>Sets the buffering mode for an output file. There are three available
 modes:</p>
<p>"no": no buffering; the result of any output operation appears 
immediately.</p>
<p>"full": full buffering; output operation is performed only when the 
buffer is full (or when you explicitly flush the file (see io.flush)).</p>
<p>"line": line buffering; output is buffered until a newline is output 
or there is any input from some special files (such as a terminal 
device).</p>
<p>For the last two cases, size specifies the size of the buffer, in 
bytes. The default is an appropriate size.</p>

<h4 id="file:write_...">file:write (...)</h4>
<p>Writes the value of each of its arguments to the file. The arguments 
must be strings or numbers. To write other values, use tostring or 
string.format before write.</p>

<h3 id="Operating_System_Facilities">Operating System Facilities</h3>

<p>This library is implemented through the table os.</p>

<h4 id="os.clock_">os.clock ()</h4>
<p>Returns an approximation of the amount in seconds of CPU time used by
 the program.</p>

<h4 id="os.date_format_time">os.date ([format [, time]])</h4>
<p>Returns a string or a table containing date and time, formatted 
according to the given string format.</p>
<p>If the time argument is present, this is the time to be formatted 
(see the os.time function for a description of this value). Otherwise, 
date formats the current time.</p>
<p>If format starts with '!', then the date is formatted in Coordinated 
Universal Time. After this optional character, if format is the string 
"*t", then date returns a table with the following fields: year (four 
digits), month (1--12), day (1--31), hour (0--23), min (0--59), sec 
(0--61), wday (weekday, Sunday is&nbsp;1), yday (day of the year), and 
isdst (daylight saving flag, a boolean).</p>
<p>If format is not "*t", then date returns the date as a string, 
formatted according to the same rules as the C&nbsp;function strftime.</p>
<p>When called without arguments, date returns a reasonable date and 
time representation that depends on the host system and on the current 
locale (that is, os.date() is equivalent to os.date("%c")).</p>

<h4 id="os.difftime_t2_t1">os.difftime (t2, t1)</h4>
<p>Returns the number of seconds from time t1 to time t2. In POSIX, 
Windows, and some other systems, this value is exactly t2-t1.</p>

<h4 id="os.exit_code_">os.exit ([ code ])</h4>
<p>Calls the C&nbsp;function exit, with an optional code, to terminate 
the host program. The default value for code is the success code.</p>

<h4 id="os.remove_filename">os.remove (filename)</h4>
<p>Deletes the file or directory with the given name. Directories must 
be empty to be removed. If this function fails, it returns nil, plus a 
string describing the error.</p>

<h4 id="os.rename_oldname_newname">os.rename (oldname, newname)</h4>
<p>Renames file or directory named oldname to newname. If this function 
fails, it returns nil, plus a string describing the error.</p>

<h4 id="os.time_table">os.time ([table])</h4>
<p>Returns the current time when called without arguments, or a time 
representing the date and time specified by the given table. This table 
must have fields year, month, and day, and may have fields hour, min, 
sec, and isdst (for a description of these fields, see the os.date 
function).</p>
<p>The returned value is a number, whose meaning depends on your system.
 In POSIX, Windows, and some other systems, this number counts the 
number of seconds since some given start time (the "epoch"). In other 
systems, the meaning is not specified, and the number returned by time 
can be used only as an argument to date and difftime.</p>
  </div>
<div id="node-935" class="section-2">
  <h1 class="book-heading">Old: Corona Core Libraries</h1>
  <p>Corona adds its own set of libraries on top of the <a 
href="http://developer.anscamobile.com/lua-standard-libraries">standard 
Lua libraries</a>. These libraries enable you to create applications. 
Some libraries are built-in whereas others must be explicitly loaded. <br>
The following are Corona’s core libraries. These are built-in and loaded
 automatically when the application launches:<br>
</p><ul>
<li>	<strong>display</strong> provides all routines for creating display
 objects.</li>
<li>	<strong>transition</strong> simplifies the animation of display 
objects, simplifying the process of creating basic tweens.</li>
<li>	<strong>easing</strong> is a collection of interpolation functions 
that can be used in conjunction with the transition library.</li>
<li>	<strong>timer</strong> provides rudimentary timing functions such 
as delayed invocation. </li>
<li>	<strong>media</strong> provides access to the multimedia 
capabilities of the device.</li>
<li>	<strong>native</strong> provides access to native interface 
elements that may vary in appearance and size across devices.</li>
<li>	<strong>system</strong> is a misc collection of system level 
features.</li>
</ul>
<p>Just like the standard Lua libraries, you can access them at the 
global scope; you do not have to explicitly load them using <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">require</span></code></span>.</p>
<p>A global Runtime object exists for the lifetime of your application. 
It is the object you use to register for <a 
href="http://developer.anscamobile.com/events-and-listeners-0#Runtime_Events">Runtime
 events</a>. For more information on events and listeners, see <a 
href="http://developer.anscamobile.com/events-and-listeners-0#Registering_for_Events">Registering
 for Events</a>.</p>
  </div>
<div id="node-1198" class="section-2">
  <h1 class="book-heading">Old: Corona Internal Libraries</h1>
  <p>Corona also has some additional built-in libraries. To speed up 
launch time, these are not automatically loaded by default. Hence to 
make these libraries available, you must explicitly load them using <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">require</span></code></span>.</p>

<dl><dt>crypto</dt> <dd>provides routines for calculating common message
 digests (hashes) and hash-based message authentication codes (HMAC).</dd>
<dt>socket</dt> <dd>provides networking access.</dd>

<h3 id="crypto">crypto</h3>

<p>Corona includes functions for calculating hash and HMAC (hash-based 
message authentication codes). Although these libraries are built into 
Corona, you need to use the Lua <u>require</u> syntax to make the 
functions available to your code, e.g. placing <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="kw1">local</span> crypto <span
 class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span
 class="st0">"crypto"</span><span class="br0">)</span></code></span> at 
the top of your Lua file.</p>

<h4 id="crypto.digest_algorithm_string_raw_">crypto.digest( algorithm, 
string [, raw] )</h4>
<p>This function generates the message digest of the input string and 
returns it. See <a 
href="http://developer.anscamobile.com/Algorithm_Constants">Algorithm 
Constants</a> for valid values for algorithm. The optional <span 
class="geshifilter"><code class="lua geshifilter-lua">raw</code></span> 
flag, defaulted to <strong>false</strong>, is a boolean indicating 
whether the output should be a direct binary equivalent of the message 
digest, or formatted as a hexadecimal string (the default).</p>

<h4 id="crypto.hmac_algorithm_string_key_raw_">crypto.hmac( algorithm, 
string, key [, raw] )</h4>
<p>This function returns HMAC of the string and returns it. See <a 
href="http://developer.anscamobile.com/Algorithm_Constants">Algorithm 
Constants</a> for valid values for algorithm. The parameter key is used 
as the seed for the HMAC generation. The optional <span 
class="geshifilter"><code class="lua geshifilter-lua">raw</code></span> 
flag, defaulted to <strong>false</strong>, is a boolean indicating 
whether the output should be a direct binary equivalent of the HMAC or 
formatted as a hexadecimal string (the default). </p>

<h4 id="Algorithm_Constants">Algorithm Constants</h4>

<p>The algorithm parameter is a constant for a hashing algorithm:</p>

<ul><li><h5 id="crypto.md4">crypto.md4</h5> (Note: HMAC is not available
 for this algorithm)</li>
<li>	<h5 id="crypto.md5">crypto.md5</h5></li>
<li>	<h5 id="crypto.sha1">crypto.sha1</h5></li>
<li>	<h5 id="crypto.sha224">crypto.sha224</h5></li>
<li>	<h5 id="crypto.sha256">crypto.sha256</h5></li>
<li>	<h5 id="crypto.sha384">crypto.sha384</h5></li>
<li>	<h5 id="crypto.sha512">crypto.sha512</h5></li>
</ul>socket (Networking)

<p>Corona includes the latest version (v2.02) of the <strong>LuaSocket</strong>
 libraries. These Lua modules implement common network protocols such as
 SMTP (sending e-mails), HTTP (WWW access) and FTP (uploading and 
downloading files). Also included are features to support MIME (common 
encodings), URL manipulation and LTN12 (transferring and filtering 
data). </p>
<p>Full LuaSocket documentation can be found here: </p>
<p><a 
href="http://www.tecgraf.puc-rio.br/%7Ediego/professional/luasocket/reference.html">http://www.tecgraf.puc-rio.br/~diego/professional/luasocket/reference.html</a></p>
<p>Although these libraries are built into Corona, you need to use the 
Lua require syntax to make the functions available to your code. This is
 demonstrated in the example below, and in other online code samples 
available from the global Lua community.</p>

<h4 id="Simple_image_downloading">Simple image downloading</h4>
<p>This example uses the <strong>http.request</strong> function to 
download a PNG file, save it to a local directory, and then display it 
as an image. JPEG files can also be downloaded and displayed in this 
manner.</p>

<div class="geshifilter"><table class="lua geshifilter-lua"><tbody><tr 
class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Load the relevant LuaSocket modules</span>
<span class="kw1">local</span> http <span class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span class="st0">"socket.http"</span><span class="br0">)</span>
<span class="kw1">local</span> ltn12 <span class="sy0">=</span> <span class="kw1">require</span><span class="br0">(</span><span class="st0">"ltn12"</span><span class="br0">)</span>
&nbsp;
<span class="co1">-- Create local file for saving data</span>
<span class="kw1">local</span> path <span class="sy0">=</span> system.pathForFile<span class="br0">(</span> <span class="st0">"hello.png"</span>, system.DocumentsDirectory <span class="br0">)</span>
myFile <span class="sy0">=</span> <span class="kw1">io.open</span><span class="br0">(</span> path, <span class="st0">"w+b"</span> <span class="br0">)</span> 
&nbsp;
<span class="co1">-- Request remote file and save data to local file</span>
http.request<span class="br0">{</span>
&nbsp; &nbsp; url <span class="sy0">=</span> <span class="st0">"http://developer.anscamobile.com/demo/hello.png"</span>, 
&nbsp; &nbsp; sink <span class="sy0">=</span> ltn12.sink.file<span class="br0">(</span>myFile<span class="br0">)</span>,
<span class="br0">}</span>
&nbsp;
<span class="co1">-- Display local file</span>
testImage <span class="sy0">=</span> display.newImage<span class="br0">(</span><span class="st0">"hello.png"</span>,system.DocumentsDirectory,<span class="nu0">60</span>,<span class="nu0">50</span><span class="br0">)</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>

<p>When testing this code in the Corona Simulator, the Documents 
directory on your Mac stands in for the application’s local directory on
 the iPhone. As a result, you will see the downloaded PNG file being 
stored in your Documents directory.</p>

<h4 id="Examples">Examples</h4>
<p>For an example of how to use this library, see the <strong>SimpleImageDownload</strong>
 project in the Sample Code folder of the Corona SDK.</p>
  </dl></div>
<div id="node-1205" class="section-2">
  <h1 class="book-heading">Game Edition: Introduction</h1>
  <p style="color: rgb(255, 0, 0);"><strong>August 15, 2010:</strong> 
This documentation has now been updated to cover Game Edition Alpha 3.</p>

<p>Welcome to Corona® Game Edition! We appreciate you taking the time to
 use an early version of our product, and please feel free to send any 
feedback to beta@anscamobile.com, or to any member of our engineering 
staff. </p>

<p>Corona Game Edition is currently a superset of Corona SDK 2.0 Beta 7.
 This document covers the features specific to the Game Edition, 
including Box2D physics engine support, sprite sheets, audio 
enhancements, and OpenFeint leaderboards, achievements and Network Save 
Card features.</p>
<p>For general Corona documentation, see the other areas of the online 
API Reference.</p>
<p>For the ongoing Corona development roadmap, see <a 
href="http://www.anscamobile.com/corona/roadmap">http://www.anscamobile.com/corona/roadmap</a></p>

<h3 id="When_To_Use_Game_Edition">When To Use Game Edition</h3>
<p>While the base size of a compiled Corona application is about 300 KB,
 some of the Game Edition features add significantly to this size. For 
example, the physics engine adds about 200 KB, and the OpenFeint library
 adds about 3-4 MB,  partly due to the large number of graphical assets 
included in the OpenFeint interface. Partial inclusion of these features
 is not supported in this version.</p>  </div>
<div id="node-1208" class="section-2">
  <h1 class="book-heading">Game Edition: Box2D Physics Engine</h1>
  <h3 id="Box2D_Features">Box2D Features</h3>
<p>Corona Game Edition incorporates the latest version of the Box2D 
physics engine (currently v2.1.2) , written by Erin Catto of Blizzard 
Entertainment.</p>
<p>Note that while the full C++ libraries are included, the Corona API 
is in progress. Features supported so far include:</p>
<ul>
<li>Automatic world setup, scaling, and synchronization with visible 
Corona objects</li>
<li>Basic collision geometry (boxes, circles and arbitrary polygons)</li>
<li>Complex collision geometry (multi-element bodies)</li>
<li>Attributes for primary body and fixture properties</li>
<li>Collision events via Corona event listeners, including collision 
forces</li>
<li>Four collision event phases: <em>preSolve</em>, <em>began</em>, <em>ended</em>
 and <em>postSolve</em></li>
<li>Draggable object handling within the simulation</li>
<li>Seven types of joints: <em>distance</em>, <em>pivot</em>, <em>piston</em>,
 <em>friction</em>, <em>weld</em>, <em>wheel</em> and <em>pulley</em> 
(some of these are renamed from their Box2D counterparts; see “Joints” 
section below)</li>
<li>Joint motors and limits</li>
<li>Applied forces and impulses, both linear and angular</li>
<li>Dynamic gravity, including accelerometer-driven gravity</li>
<li>Sensors and bullets</li>
<li>Collision categories, masking and groups</li>
</ul>

<p>Features not yet supported include:</p>
<ul>
<li>Gear joints and mouse joints</li>
<li>Ray casting, region queries, etc.</li>
<li>“DebugDraw” mode</li>
<li>Joint and body destructors</li>
<li>Miscellaneous setters and getters for object attributes</li>
<li>Automatic resizing of physics objects when Corona display objects 
are resized with xScale/yScale attributes (avoid using xScale/yScale on 
an already-existing physical object in the meantime).</li>
</ul>

<p>&nbsp;</p>

<h3 id="The_Corona_physics_API">The Corona physics API</h3>
<p>The Corona API differs from the C++ Box2D API. In particular, Corona 
treats most physical body properties as an extension of visible objects:
 any standard Corona display object, including images, vector drawings, 
or animated sprites, can be “made physical”, and will automatically 
begin to interact with other objects in the simulation.</p>
<p>Our design goal is to allow users to think primarily in terms of 
visible game objects wherever possible, as opposed to constructing an 
invisible physical world and then attaching visible sprites afterwards.</p>
<p>Also, Corona automatically translates between its familiar onscreen 
units and the internal metric units of the physical simulation. All 
position values are exposed in pixels, which are converted internally to
 meters at a default ratio of 30 pixels per meter (this ratio is 
user-settable with <em>physics.setScale</em>).</p> 
<p>For consistency with the rest of the Corona SDK, all angular values 
are exposed in degrees, rather than radians, and position (0,0) remains 
at the upper left-hand corner of the screen, with the y-axis pointing 
downwards. Shape definitions should declare their points in <em>clockwise</em>
 order.</p>

<p>&nbsp;</p>

<h3 id="Physics_world_setup">Physics world setup</h3>
<p>This line makes the Box2D features available under the “physics” 
namespace:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> physics <span class="sy0">=</span> <span class="kw1">require</span> <span class="st0">"physics"</span></pre></div></div>

<p>These functions start, pause, and stop the physics simulation. <span 
class="geshifilter"><code class="lua geshifilter-lua">start</code></span>
 either instantiates  or resumes the world, and should be called before 
any of the other functions in this section. <span class="geshifilter"><code
 class="lua geshifilter-lua">stop</code></span> is treated as a request 
to destroy the world.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">physics.start<span class="br0">(</span><span class="br0">)</span>
&nbsp;
physics.pause<span class="br0">(</span><span class="br0">)</span>
physics.stop<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="physics.setGravity">physics.setGravity</h4>
<p>Sets the x,y components of the global gravity vector, in units of m/s<sup>2</sup>.
 The default is ( 0, 9.8 ) to simulate standard Earth gravity, pointing 
downwards on the y-axis.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">physics.setGravity<span class="br0">(</span> <span class="nu0">0</span>, <span class="nu0">10</span> <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="physics.getGravity">physics.getGravity</h4>
<p>Returns the x,y components of the global gravity vector, in units of 
m/s<sup>2</sup>. This takes advantage of the fact that Lua functions can
 return multiple values.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">gx, gy <span class="sy0">=</span> physics.getGravity<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Tilt-based_gravity">Tilt-based gravity</h4>

<p>Using the above setter, and the existing Corona accelerometer API, it
 is very easy to implement tilt-based dynamic gravity (note that the 
y-component returned by the accelerometer hardware must be inverted to 
conform to Corona coordinates):</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> <span class="kw1">function</span> onTilt<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; physics.setGravity<span class="br0">(</span> <span class="nu0">10</span> <span class="sy0">*</span> event.xGravity, -<span class="nu0">10</span> <span class="sy0">*</span> event.yGravity <span class="br0">)</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"accelerometer"</span>, onTilt <span class="br0">)</span></pre></div></div>

<p>See the “ShapeTumbler” sample project for an example of this feature 
(the accelerometer is not present in the Corona Simulator, so create a 
device build to see the effect).</p>

<p>&nbsp;</p>

<h4 id="physics.setScale">physics.setScale</h4>
<p>Sets the internal pixels-per-meter ratio that is used in converting 
between onscreen Corona coordinates and simulated physics coordinates. 
This should be done only once, before any physical objects are 
instantiated.</p>
<p>Changing this value has no visual consequences, and simply affects 
the accuracy of the physical model. The Box2D engine is tuned for 
simulating medium-sized objects between 0.1m and 10m in size, so it 
works best when the objects in your game are mapped to physical 
properties that fall roughly within this range. </p>
<p>The default scaling value is 30, which means that the optimal 0.1m to
 10m range corresponds to visible sprites between 3 and 300 pixels in 
size, which should cover most typical iPhone content. For 
higher-resolution devices like iPad, Android, or iPhone 4, you may wish 
to increase this value to 60 or more.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">physics.setScale<span class="br0">(</span> <span class="nu0">60</span> <span class="br0">)</span></pre></div></div>

<p>You may also want to increase this value if the objects you are 
simulating are relatively small. As a rough guide, take the width of a 
sprite in pixels and divide it by its real-world width, if any. For 
example, a basketball is about 0.25 meters across, so a 20-pixel 
basketball sprite suggests a physics scaling factor of roughly (20 / 
0.25) = 80. However, the resulting effect also depends on how much your 
chosen density (mass) values approximate the "real world". Therefore, 
you should ultimately set this scaling factor to whatever feels right 
within the context of your game: if objects seem too sluggish, and fall 
too slowly, then they are too big and heavy for your purposes -- try 
raising the scaling value and/or reducing their densities.</p>

<p>Note that this pixels-per-meter factor is relative to your <em>original</em>
 content dimensions, if you use the Corona content scaling features to 
deploy the same code across different screen resolutions (such as iPhone
 and Android). See the <strong>Corona API Reference</strong> for more 
information on autoscaling content for multiple screens.</p>

<p>Also, since onscreen objects are <em>not</em> resized when this value
 is changed, the visible simulation may behave strangely if it is 
changed while physical objects are already onscreen. In other words, 
this setting is not the correct way to <em>visibly</em> scale the world.
 To do that, you should add all the game objects to a common Corona 
display group, which will cause the simulation to operate according to 
the group’s internal coordinates rather than the global stage 
coordinates, and then scale or pan that group. See the “EggBreaker” 
sample code for a demonstration of this technique.</p>  </div>
<div id="node-1462" class="section-2">
  <h1 class="book-heading">Game Edition: Physics Bodies</h1>
  <h3 id="Bodies">Bodies</h3>
<p>The Box2D world is based on the interactions of rigid bodies. These 
physical bodies can be bound to Corona display objects in a one-to-one 
relationship, and Corona will automatically handle all position updates 
and other synchronization tasks.</p>

<p>In fact, our goal is that you should be able to consider the physical
 bodies as literally part of the visible display objects. Therefore, the
 body constructor <span class="geshifilter"><code class="lua 
geshifilter-lua">physics.addBody</code></span> does not return a new 
object, but instead “extends” an existing display object with physical 
properties.</p>
<p>Therefore, standard object read/write attributes like <span 
class="geshifilter"><code class="lua geshifilter-lua">x</code></span>, <span
 class="geshifilter"><code class="lua geshifilter-lua">y</code></span> 
and <span class="geshifilter"><code class="lua geshifilter-lua">rotation</code></span>
 should continue to work normally on a physical body, although if the <span
 class="geshifilter"><code class="lua geshifilter-lua">bodyType</code></span>
 is “dynamic”, the physics engine may “fight back” against your attempts
 to move the object manually, since it will be under the constant effect
 of gravity and other forces. The “DragPlatforms” sample code shows one 
method for changing body types to “kinematic” during dragging, which 
temporarily removes them from the influence of external forces.</p>
<p>A display object that has physical properties can be deleted in the 
normal way, using <span class="geshifilter"><code class="lua 
geshifilter-lua">object:removeSelf<span class="br0">(</span><span 
class="br0">)</span></code></span>. It will be automatically removed 
from both the visible screen and the physical simulation <em>(<strong>known
 bug:</strong> the latter is not working correctly, but this will be 
fixed shortly)</em>.</p>

<p>&nbsp;</p>

<h4 id="Simple_body_construction">Simple body construction</h4>
<hr>

<p>&nbsp;</p>

<h4 id="physics.addBody">physics.addBody</h4>
<p><span style="color: rgb(255, 0, 0);">(Revised for Alpha 2.)</span></p>
<p>This allows you to turn any Corona display object into a simulated 
physical object with one line of code, including the assignment of 
physical properties.</p>
<p>Physical bodies have three main physical properties:</p>

<ul>
<li><span class="geshifilter"><code class="lua geshifilter-lua">density</code></span>
 is multiplied by the area of the body’s shape to determine its mass. 
This parameter is based on a standard value of 1.0 for water, so 
materials that are lighter than water (such as wood) have a density 
below 1.0, and heavier materials (such as stone) have a density greater 
than 1.0. However, feel free to set density values to whatever feels 
right for your game, since overall object behavior will also depend on 
your gravity and pixels-to-meter scale settings (see previous section). 
The default value is 1.0.</li>

<li><span class="geshifilter"><code class="lua geshifilter-lua">friction</code></span>
 may be any non-negative value; a value of 0 means no friction and 1.0 
means fairly strong friction. The default value is 0.3.</li>

<li><span class="geshifilter"><code class="lua geshifilter-lua">bounce</code></span>
 is the Box2d property known internally as “restitution”, and determines
 how much of an object’s velocity is returned after a collision. Values 
greater than 0.3 are fairly “bouncy”, and an object with a bounce value 
of 1.0 will rebound forever (i.e., if dropped to the ground, it will 
bounce back up to the height from which it was dropped). Bounce values 
higher than 1.0 are valid, but will cause strange behavior: objects will
 literally gain velocity with each collision until they fly off into 
space. The default value is 0.2, which is slightly bouncy.</li>
</ul>

<p>&nbsp;</p>

<h4 id="Default_rectangular_bodies">Default (rectangular) bodies</h4>
<hr>
<p>By default, this constructor assumes that the physical object is 
rectangular, with collision boundaries that automatically snap to the 
edges of the associated image or vector object. This works well for 
crates, platforms, large ground bodies, and other simple rectangular 
sprites. All parameters in the table are optional, and all default to 
reasonable values if not provided.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> crate <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span>, <span class="nu0">100</span>, <span class="nu0">200</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> crate, <span class="br0">{</span> density <span class="sy0">=</span> <span class="nu0">1.0</span>, friction <span class="sy0">=</span> <span class="nu0">0.3</span>, bounce <span class="sy0">=</span> <span class="nu0">0.2</span> <span class="br0">}</span> <span class="br0">)</span></pre></div></div>

<p>Note that the table of physical attributes can be declared externally
 and then used multiple times:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> crate1 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span>, <span class="nu0">100</span>, <span class="nu0">200</span> <span class="br0">)</span>
<span class="kw1">local</span> crate2 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span>, <span class="nu0">180</span>, <span class="nu0">280</span> <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> crateMaterial <span class="sy0">=</span> <span class="br0">{</span> density <span class="sy0">=</span> <span class="nu0">1.0</span>, friction <span class="sy0">=</span> <span class="nu0">0.3</span>, bounce <span class="sy0">=</span> <span class="nu0">0.2</span> <span class="br0">}</span>
&nbsp;
physics.addBody<span class="br0">(</span> crate1, crateMaterial <span class="br0">)</span>
physics.addBody<span class="br0">(</span> crate2, crateMaterial <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Circular_bodies">Circular bodies</h4>
<hr>

<p>Circular bodies require an additional <span class="geshifilter"><code
 class="lua geshifilter-lua">radius</code></span> parameter. This works 
well for balls, rocks, and other objects that can be treated as 
perfectly round when calculating collisions. If the visible sprite is 
round but irregular (say, a boulder or an egg), you may wish to set this
 radius slightly smaller than the physical image size. </p>
<p>Note that there is no such thing as a non-circular oval in Box2D 
collision geometry, since circular bodies exist as a special case. To 
make an oval body, you would instead lay out a series of specific 
boundary points to outline the shape as a polygon (see below).</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> ball <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"ball.png"</span>, <span class="nu0">100</span>, <span class="nu0">200</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> ball, <span class="br0">{</span> density <span class="sy0">=</span> <span class="nu0">1.0</span>, friction <span class="sy0">=</span> <span class="nu0">0.3</span>, bounce <span class="sy0">=</span> <span class="nu0">0.2</span>, radius <span class="sy0">=</span> <span class="nu0">25</span> <span class="br0">}</span> <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Polygon_bodies">Polygon bodies</h4>
<hr>

<p>General polygonal bodies that don’t fall into the above two special 
cases are generated with a “shape” parameter, which is used to pass a 
Lua table of (x,y) coordinate points that outline the collision 
boundaries. These coordinates are specified relative to the display 
object: by default, Corona sets the origin of a display object at the <em>center</em>
 of the corresponding image file (or vector object). </p>
<p>For example, to define a rectangular shape 20 pixels high and 40 
pixels wide, with its origin at its center, the following shape 
definition would be used:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">squareShape <span class="sy0">=</span> <span class="br0">{</span> -<span class="nu0">20</span>,-<span class="nu0">10</span>, <span class="nu0">20</span>,-<span class="nu0">10</span>, <span class="nu0">20</span>,<span class="nu0">10</span>, -<span class="nu0">20</span>,<span class="nu0">10</span> <span class="br0">}</span></pre></div></div>

<p>The maximum number of points (and therefore edges) allowed per 
collision shape is eight. Once defined, a shape definition can be 
re-used multiple times. </p>
<p>Note that these polygon coordinates must be defined in clockwise 
order, and the resulting shape must be concave-only. Coordinate sets 
that violate these two rules may appear to work, but their objects will 
behave oddly in collisions: for example, they may become stuck to other 
objects. (Convex physical objects must be assembled from multiple 
elements attached to the same body; see "Complex body construction" 
below.)</p>
<p>Here are two valid examples:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> triangle <span class="sy0">=</span> display.newImage<span class="br0">(</span><span class="st0">"triangle.png"</span><span class="br0">)</span>
triangle.x <span class="sy0">=</span> <span class="nu0">200</span>
triangle.y <span class="sy0">=</span> <span class="nu0">150</span>
triangleShape <span class="sy0">=</span> <span class="br0">{</span> <span class="nu0">0</span>,-<span class="nu0">35</span>, <span class="nu0">37</span>,<span class="nu0">30</span>, -<span class="nu0">37</span>,<span class="nu0">30</span> <span class="br0">}</span>
&nbsp;
physics.addBody<span class="br0">(</span> triangle, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">1.6</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.2</span>, shape<span class="sy0">=</span>triangleShape <span class="br0">}</span> <span class="br0">)</span>
&nbsp;
<span class="co1">------</span>
&nbsp;
<span class="kw1">local</span> pentagon <span class="sy0">=</span> display.newImage<span class="br0">(</span><span class="st0">"pentagon.png"</span><span class="br0">)</span>
pentagon.x <span class="sy0">=</span> <span class="nu0">200</span>
pentagon.y <span class="sy0">=</span> <span class="nu0">50</span>
pentagonShape <span class="sy0">=</span> <span class="br0">{</span> <span class="nu0">0</span>,-<span class="nu0">37</span>, <span class="nu0">37</span>,-<span class="nu0">10</span>, <span class="nu0">23</span>,<span class="nu0">34</span>, -<span class="nu0">23</span>,<span class="nu0">34</span>, -<span class="nu0">37</span>,-<span class="nu0">10</span> <span class="br0">}</span>
&nbsp;
physics.addBody<span class="br0">(</span> pentagon, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">3.0</span>, friction<span class="sy0">=</span><span class="nu0">0.8</span>, bounce<span class="sy0">=</span><span class="nu0">0.3</span>, shape<span class="sy0">=</span>pentagonShape <span class="br0">}</span> <span class="br0">)</span></pre></div></div>

<p>For examples of polygonal body specifications, see “ShapeTumbler” and
 the bumper objects in “SimplePool”.</p>

<p><strong>Alpha 2: bodyType constructor revised</strong></p>

<p>In Alpha 1, there was an optional bodyType attribute that could be 
specified during body construction, as follows:</p>

<p><strong>OLD:</strong></p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">physics.addBody<span class="br0">(</span> triangle, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">1.6</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.2</span>, bodyType<span class="sy0">=</span><span class="st0">"static"</span>, shape<span class="sy0">=</span>triangleShape <span class="br0">}</span> <span class="br0">)</span></pre></div></div>

<p>In Alpha 2, this attribute is no longer part of the body element 
definition, and will be ignored if specified in the above format. 
Instead, the body type may be specified in an optional string parameter 
before the first body element:</p>

<p><strong>NEW:</strong></p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">physics.addBody<span class="br0">(</span> triangle, <span class="st0">"static"</span>, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">1.6</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.2</span>, shape<span class="sy0">=</span>triangleShape <span class="br0">}</span> <span class="br0">)</span></pre></div></div>

<p>Alternatively, you can construct the body and then set its type 
attribute:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">physics.addBody<span class="br0">(</span> triangle, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">1.6</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.2</span>, shape<span class="sy0">=</span>triangleShape <span class="br0">}</span> <span class="br0">)</span>
triangle.bodyType <span class="sy0">=</span> <span class="st0">"static"</span></pre></div></div>

<p>As before, the possible types are “static”, “dynamic” and 
“kinematic”, and the default type is “dynamic” if no value is specified.
 </p>

<p>In general, you can allow moving objects to default to “dynamic”, and
 specify “static” for objects (like walls or the ground) that shouldn’t 
move or fall under gravity.</p>

<p style="color: rgb(255, 0, 0);"><strong>Note:</strong> all sample code
 included with Alpha 2 has been revised to reflect this change.</p>

<p>This API change was required to support complex bodies, since the 
bodyType is a property of the entire body, and does not belong to any 
single element of a multi-element body. See the “Complex Body 
Construction” section below for more information on the new API, and the
 discussion of the body.bodyType attribute for more about how the three 
types differ.</p>

<p>&nbsp;</p>

<h4 id="Complex_body_construction">Complex body construction</h4>
<hr>

<p>The above examples assume a body with only one element. However, it 
is also possible to construct a body from multiple elements. In this 
context, each body element is specified as a separate polygon shape with
 its own physical properties. </p>

<p>For example, to model a pencil, you would probably want to define the
 eraser end as a separate body element with a much higher “bounce” value
 than the rest of the pencil.</p>
<p>Also, since collision polygons in Box2D must be convex, any game 
object with a concave shape must be constructed by appending multiple 
body elements. For example, to model a car, you would use a body with 
two or more body elements, since the shape of a car includes convex 
angles.
</p>
<p>The constructor for a complex body is the same as the simple polygon 
body constructor, except with more than one body element listed:</p>
<p> physics.addBody( displayObject, [bodyType,] bodyElement1, 
[bodyElement2, ...] )
</p>
<p>Each body element may have its own physical properties, along with a 
shape definition for its collision boundaries.  For example:
</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">&nbsp; 
<span class="kw1">local</span> car <span class="sy0">=</span> display.newImage<span class="br0">(</span><span class="st0">"big_red_car.png"</span><span class="br0">)</span>
roofShape <span class="sy0">=</span> <span class="br0">{</span> -<span class="nu0">20</span>,-<span class="nu0">10</span>, <span class="nu0">20</span>,-<span class="nu0">10</span>, <span class="nu0">20</span>,<span class="nu0">10</span>, -<span class="nu0">20</span>,<span class="nu0">10</span> <span class="br0">}</span>
hoodShape <span class="sy0">=</span> <span class="br0">{</span> <span class="nu0">0</span>,-<span class="nu0">35</span>, <span class="nu0">37</span>,<span class="nu0">30</span>, -<span class="nu0">37</span>,<span class="nu0">30</span> <span class="br0">}</span>
trunkShape <span class="sy0">=</span> <span class="br0">{</span> <span class="nu0">0</span>,-<span class="nu0">37</span>, <span class="nu0">37</span>,-<span class="nu0">10</span>, <span class="nu0">23</span>,<span class="nu0">34</span>, -<span class="nu0">23</span>,<span class="nu0">34</span>, -<span class="nu0">37</span>,-<span class="nu0">10</span> <span class="br0">}</span>
&nbsp; 
physics.addBody<span class="br0">(</span> car, <span class="st0">"dynamic"</span>,
&nbsp; <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">3.0</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.2</span>, shape<span class="sy0">=</span>roofShape <span class="br0">}</span>,
&nbsp; <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">6.0</span>, friction<span class="sy0">=</span><span class="nu0">0.6</span>, bounce<span class="sy0">=</span><span class="nu0">0.4</span>, shape<span class="sy0">=</span>hoodShape <span class="br0">}</span>,
&nbsp; <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">4.0</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.4</span>, shape<span class="sy0">=</span>trunkShape <span class="br0">}</span>
<span class="br0">)</span></pre></div></div> 
  
<p><em>(These shape definitions are for example only, and probably would
 not make a very good car shape.)</em> </p>
<p>As in the simpler cases, the <span class="geshifilter"><code 
class="lua geshifilter-lua">bodyType</code></span> attribute is optional
 and will default to “dynamic” if not specified. </p>

<p>&nbsp;</p>

<h4 id="Sensors">Sensors</h4>
<hr>
<p>Any body (or element of a multi-element body) can be turned into a 
“sensor”. Sensors do not physically interact with other bodies, but 
produce collision events when other bodies pass through them. For 
example, the pockets on a pool table might be implemented as sensors.</p>
<p>Because the simplest Corona body constructors are based on visible 
display objects, the easiest way to implement an invisible sensor region
 is to create a display object and then make it invisible:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> rect <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">50</span>, <span class="nu0">50</span>, <span class="nu0">100</span>, <span class="nu0">100</span> <span class="br0">)</span>
rect:setFillColor<span class="br0">(</span> <span class="nu0">255</span>, <span class="nu0">255</span>, <span class="nu0">255</span>, <span class="nu0">100</span> <span class="br0">)</span>
rect.isVisible <span class="sy0">=</span> <span class="kw1">false</span> &nbsp;<span class="co1">-- optional</span>
physics.newSimpleBody<span class="br0">(</span> rect, <span class="br0">{</span> isSensor <span class="sy0">=</span> <span class="kw1">true</span> <span class="br0">}</span> <span class="br0">)</span></pre></div></div>

<p>The visible object can be used for game debugging, and then the 
isVisible property can be set to false once debugging is complete. In 
the above example, the initial display object is a translucent vector 
rectangle using the Corona drawing API.</p>

<p>&nbsp;</p>

<h4 id="Destroying_bodies">Destroying bodies</h4>
<hr>
<p style="color: rgb(255, 0, 0);" ;="">(Alpha 3 and above)</p>
<p>Physics bodies can be destroyed like any other display objects:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:removeSelf<span class="br0">(</span><span class="br0">)</span>
myBody.parent:<span class="kw1">remove</span><span class="br0">(</span> myBody <span class="br0">)</span></pre></div></div>

<p>The first method above is recommended for simplicity, and is the same
 syntax used to destroy physics joints (which do not have parents, since
 they are invisible and not part of the display hierarchy).</p>

<p>As of Alpha 3, you should be able to freely destroy bodies and joints
 whenever you like. Corona will automatically handle the process of 
holding onto the corresponding Box2D objects until the end of the 
current physics world step, and then safely dispose of them.</p>

<p>Note: while Box2D objects will be safely retained until the end of 
the current world step, their Lua references will be deleted <em>immediately</em>.
 Therefore, be careful not to accidentally delete the same Lua object 
more than once. This situation could occur when deleting objects 
involved in collisions, which can potentially have many event phases 
before the collision is fully resolved. The solution is simple:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> <span class="kw1">function</span> onCollision<span class="br0">(</span> self, event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span> event.phase <span class="sy0">==</span> <span class="st0">"began"</span> <span class="br0">)</span> <span class="kw1">then</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">-- Check if body still exists before removing!</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span> crate1 <span class="br0">)</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; crate1:removeSelf<span class="br0">(</span><span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; crate1 <span class="sy0">=</span> <span class="kw1">nil</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
<span class="kw1">end</span></pre></div></div>

<p>&nbsp;</p>

<h3 id="Body_properties">Body properties</h3>
<p>Many of the native Box2D setter/getter methods have been reduced to 
simpler dot properties on the display object. The following examples 
assume that a body <span class="geshifilter"><code class="lua 
geshifilter-lua">myBody</code></span> has been created using one of the 
above constructor methods.</p>

<p>&nbsp;</p>

<h4 id="body.isAwake">body.isAwake</h4>
<p>A boolean for the current awake state. By default, all bodies 
automatically “go to sleep” when nothing interacts with them for a 
couple of seconds, and then they stop being simulated until something 
(e.g., a collision) wakes them up. This property can either fetch their 
current state or forcibly wake them up.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.isAwake <span class="sy0">=</span> <span class="kw1">true</span>
<span class="kw1">local</span> state <span class="sy0">=</span> myBody.isAwake</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.isBodyActive">body.isBodyActive</h4>
<p>A boolean for the current active state. Inactive bodies are not 
destroyed, but they are removed from the simulation and cease to 
interact with other bodies.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.isBodyActive <span class="sy0">=</span> <span class="kw1">true</span>
<span class="kw1">local</span> state <span class="sy0">=</span> myBody.isBodyActive</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.isBullet">body.isBullet</h4>
<p>A boolean for whether the body should be treated as a “bullet”. 
Bullets are subject to continuous collision detection, rather than 
periodic collision detection at world timesteps. This is more 
computationally expensive, but it prevents fast-moving objects from 
passing through solid barriers. The default is <strong>false</strong>.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.isBullet <span class="sy0">=</span> <span class="kw1">true</span>
<span class="kw1">local</span> state <span class="sy0">=</span> myBody.isBullet</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.isSleepingAllowed">body.isSleepingAllowed</h4>
<p>A boolean for whether the body is ever allowed to go to sleep. 
Keeping bodies awake has a larger overhead, and is often not required, 
because collisions with other bodies will automatically wake them up. 
However, forcing awakeness is useful in cases such as the tilt-gravity 
case (since sleeping bodies do not respond to changes in global 
gravity). The default is <strong>false</strong>.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.isSleepingAllowed <span class="sy0">=</span> <span class="kw1">true</span>
<span class="kw1">local</span> state <span class="sy0">=</span> myBody.isSleepingAllowed</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.isFixedRotation">body.isFixedRotation</h4>
<p>A boolean for whether the rotation of the body should be locked, even
 if the body is under load or subjected to off-center forces. The 
default is <strong>false</strong>.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.isFixedRotation <span class="sy0">=</span> <span class="kw1">true</span>
<span class="kw1">local</span> state <span class="sy0">=</span> myBody.isFixedRotation</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.angularVelocity">body.angularVelocity</h4>
<p>The numerical value of the current angular (rotational) velocity, in 
degrees per second.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.angularVelocity <span class="sy0">=</span> <span class="nu0">50</span>
<span class="kw1">local</span> v <span class="sy0">=</span> myBody.angularVelocity</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.linearDamping">body.linearDamping</h4>
<p>The numerical value for how much the body's linear motion is damped. 
The default is zero.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.linearDamping <span class="sy0">=</span> <span class="nu0">5</span>
<span class="kw1">local</span> d <span class="sy0">=</span> myBody.linearDamping</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.angularDamping">body.angularDamping</h4>
<p>The numerical value for how much the body's rotation should be 
damped. The default is zero.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.angularDamping <span class="sy0">=</span> <span class="nu0">5</span>
<span class="kw1">local</span> d <span class="sy0">=</span> myBody.angularDamping</pre></div></div>

<p>&nbsp;</p>

<h4 id="body.bodyType">body.bodyType</h4>
<p>A string value for the type of physical body being simulated. 
Possible values are <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"static"</span></code></span>, <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"dynamic"</span></code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"kinematic"</span></code></span>. </p>
<ul>
<li>static bodies don't move, and don't interact with each other; 
examples of static objects would include the ground, or the walls of a 
pinball machine.</li> 
<li>dynamic bodies are affected by gravity and collisions with the other
 body types. </li>
<li>kinematic objects are affected by forces but not by gravity, so you 
should generally set draggable objects to “kinematic”, at least for the 
duration of the drag event. </li>
</ul>
<p>The default body type is <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="st0">"dynamic"</span></code></span>.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody.bodyType <span class="sy0">=</span> <span class="st0">"kinematic"</span>
<span class="kw1">local</span> currentType <span class="sy0">=</span> myBody.bodyType</pre></div></div>

<p>&nbsp;</p>

<h3 id="Body_methods">Body methods</h3>
<p>The following examples assume that a body <span class="geshifilter"><code
 class="lua geshifilter-lua">myBody</code></span> has been created using
 one of the above constructor methods.</p>

<p>&nbsp;</p>

<h4 id="body:setLinearVelocity">body:setLinearVelocity</h4>
<p>A function that accepts x,y components for the body's linear 
velocity, in pixels per second.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:setLinearVelocity<span class="br0">(</span> <span class="nu0">2</span>, <span class="nu0">4</span> <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="body:getLinearVelocity">body:getLinearVelocity</h4>
<p>A function that returns x,y components for the body's linear 
velocity, in pixels per second.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">vx, vy <span class="sy0">=</span> myBody:getLinearVelocity<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="body:applyForce">body:applyForce</h4>
<p>A function that accepts x,y components of a linear force, applied at a
 given point with x,y world coordinates. If the target point is the 
body's center of mass, it will tend to push the body in a straight line;
 if the target is offset from the body's center of mass, the body will 
spin about its center of mass.</p>
<p> For symmetrical objects, the center of mass and the center of the 
object will have the same position: <span class="geshifilter"><code 
class="lua geshifilter-lua"><span class="br0">(</span>object.x, object.y<span
 class="br0">)</span>.</code></span> Also note that the amount of force 
may need to be fairly high to move heavy objects.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:applyForce<span class="br0">(</span> <span class="nu0">500</span>, <span class="nu0">2000</span>, myBody.x, myBody.y <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="body:applyTorque">body:applyTorque</h4>
<p>A function that accepts a numerical value for applied rotational 
force. The body will rotate about its center of mass.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:applyTorque<span class="br0">(</span> <span class="nu0">100</span> <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="body:applyLinearImpulse">body:applyLinearImpulse</h4>
<p>Like applyForce, except that an <strong>impulse</strong> is a single,
 momentary jolt.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:applyLinearImpulse<span class="br0">(</span> <span class="nu0">600</span>, <span class="nu0">200</span>, myBody.x, myBody.y <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="body:applyAngularImpulse">body:applyAngularImpulse</h4>
<p>Like applyTorque, except that an <strong>angular impulse</strong> is a
 single, momentary jolt.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:applyAngularImpulse<span class="br0">(</span> <span class="nu0">100</span> <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="body:resetMassData">body:resetMassData</h4>
<p>If the default mass data for the body has been overridden (TBD), this
 function resets it to the mass calculated from the shapes.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myBody:resetMassData<span class="br0">(</span><span class="br0">)</span></pre></div></div>
  </div>
<div id="node-1461" class="section-2">
  <h1 class="book-heading">Game Edition: Collision Detection</h1>
  <h3 id="Collision_events">Collision events</h3>
<p><span style="color: rgb(255, 0, 0);">(Revised for Alpha 3.)</span></p>
<p>Box2D collision events are exposed through the standard Corona 
event-listener model, with three new event types.
For general collision detection, you should listen for an event named <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="st0">"collision"</span></code></span>.
 The "collision" event includes phases for <span class="geshifilter"><code
 class="lua geshifilter-lua"><span class="st0">"began"</span></code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"ended"</span></code></span>, which signify the moments of 
initial contact and broken contact. These phases exist for both normal 
two-body collisions and body-sensor collisions. If you do not implement a
 "collision" listener, this event will not fire.</p>

<p><em>(As of Alpha 3, the "preSolve" and "postSolve" collision event 
phases have been deprecated, and replaced by the separate event types 
below.)</em></p>

<p>In addition to "collision" events, two other event types are 
optionally available whenever two bodies (not sensors) collide. 
Previously, these were also phases of the "collision" event type, but 
they have now been separated into unique event types, since they have 
more specialized uses.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"preCollision"</span></code></span>: an event type that 
fires right before the objects start to interact. Depending on your game
 logic, you may wish to detect this event and conditionally override the
 collision. For example, in a platform game, you may wish to construct 
“one-sided” platforms that the character can jump vertically through, 
but only in one direction. If you do not implement a "preCollision" 
listener, this event will not fire.
</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua"><span 
class="st0">"postCollision"</span></code></span>: an event type that 
fires right after the objects have interacted. This is the only event in
 which the collision force is reported. See the “Collision forces” 
section below for more on this topic. If you do not implement a 
"postCollision" listener, this event will not fire.
</p>
<p>Note that the “preCollision” and "postCollision" events are quite 
noisy, and may report many times per contact. Therefore, you should only
 listen for these events if you need pre-collision warnings or 
post-collision force measurements, and we also recommend that you use 
local listeners within the objects of interest, rather than listening 
globally to all "preCollision" or "postCollision" events in the world. </p>
<p></p>
 
<p>Collisions are reported between pairs of objects, and they can be 
detected either globally, using a Runtime listener, or locally within an
 object, using a table listener. See the "CollisionDetection" sample 
code for working examples of global and local collision listeners.</p>

<p>&nbsp;</p>

<h4 id="Global_collision_listeners">Global collision listeners</h4>
<hr>

<p>When detected as a Runtime event, each collision event includes <span
 class="geshifilter"><code class="lua geshifilter-lua">event.object1</code></span>
 and <span class="geshifilter"><code class="lua geshifilter-lua">event.object2</code></span>,
 which contain the table IDs of the two Corona display objects involved.
 </p>
<p>Because Corona display objects behave like Lua tables, you may freely
 add any arbitrary data to these tables, such as names, category 
designators, point values, or even stored functions, and then retrieve 
this data at collision time. This is similar to the <span 
class="geshifilter"><code class="lua geshifilter-lua">userData</code></span>
 attribute in Box2D, but it is essentially unlimited, since you can 
assign as many custom attributes as you like.</p>
<p>For example, you may wish to store object names in an 
easily-accessible string format:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> crate1 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span>, <span class="nu0">100</span>, <span class="nu0">200</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> crate1, <span class="br0">{</span> density <span class="sy0">=</span> <span class="nu0">1.0</span>, friction <span class="sy0">=</span> <span class="nu0">0.3</span>, bounce <span class="sy0">=</span> <span class="nu0">0.2</span> <span class="br0">}</span> <span class="br0">)</span>
crate1.myName <span class="sy0">=</span> <span class="st0">"first crate"</span>
&nbsp;
<span class="kw1">local</span> crate2 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span>, <span class="nu0">100</span>, <span class="nu0">120</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> crate2, <span class="br0">{</span> density <span class="sy0">=</span> <span class="nu0">1.0</span>, friction <span class="sy0">=</span> <span class="nu0">0.3</span>, bounce <span class="sy0">=</span> <span class="nu0">0.2</span> <span class="br0">}</span> <span class="br0">)</span>
crate2.myName <span class="sy0">=</span> <span class="st0">"second crate"</span>
&nbsp;
<span class="kw1">local</span> <span class="kw1">function</span> onCollision<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span> event.phase <span class="sy0">==</span> <span class="st0">"began"</span> <span class="br0">)</span> <span class="kw1">then</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"began: "</span> .. event.object1.myName .. <span class="st0">" &amp; "</span> .. event.object2.myName <span class="br0">)</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">elseif</span> <span class="br0">(</span> event.phase <span class="sy0">==</span> <span class="st0">"ended"</span> <span class="br0">)</span> <span class="kw1">then</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"ended: "</span> .. event.object1.myName .. <span class="st0">" &amp; "</span> .. event.object2.myName <span class="br0">)</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"collision"</span>, onCollision <span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Local_collision_listeners">Local collision listeners</h4>
<hr>

<p>When detected with a table listener within an object, each collision 
event includes <span class="geshifilter"><code class="lua 
geshifilter-lua">event.other</code></span>, which contains the table ID 
of the other Corona display object involved in the collision. Again, you
 may wish to store each object’s name in string format and retrieve it 
during the collision event:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> crate1 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> crate1, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">3.0</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.3</span> <span class="br0">}</span> <span class="br0">)</span>
crate1.myName <span class="sy0">=</span> <span class="st0">"first crate"</span>
&nbsp;
<span class="kw1">local</span> crate2 <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"crate.png"</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> crate2, <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">3.0</span>, friction<span class="sy0">=</span><span class="nu0">0.5</span>, bounce<span class="sy0">=</span><span class="nu0">0.3</span> <span class="br0">}</span> <span class="br0">)</span>
crate2.myName <span class="sy0">=</span> <span class="st0">"second crate"</span>
&nbsp;
<span class="kw1">local</span> <span class="kw1">function</span> onLocalCollision<span class="br0">(</span> self, event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span> event.phase <span class="sy0">==</span> <span class="st0">"began"</span> <span class="br0">)</span> <span class="kw1">then</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> self.myName .. <span class="st0">": collision began with "</span> .. event.other.myName <span class="br0">)</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">elseif</span> <span class="br0">(</span> event.phase <span class="sy0">==</span> <span class="st0">"ended"</span> <span class="br0">)</span> <span class="kw1">then</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> self.myName .. <span class="st0">": collision ended with "</span> .. event.other.myName <span class="br0">)</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
<span class="kw1">end</span>
&nbsp;
crate1.collision <span class="sy0">=</span> onLocalCollision
crate1:addEventListener<span class="br0">(</span> <span class="st0">"collision"</span>, crate1 <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; 
crate2.collision <span class="sy0">=</span> onLocalCollision
crate2:addEventListener<span class="br0">(</span> <span class="st0">"collision"</span>, crate2 <span class="br0">)</span></pre></div></div>

<p>See the "CollisionDetection" sample code for examples of both of 
these methods. (Run the project using Corona Terminal to see the output 
of the collisions.)</p>

<p>&nbsp;</p>

<h4 id="Collision_forces">Collision forces</h4>
<hr>

<p>Once a collision has occurred, you can obtain the direct force of the
 collision, along with the sideways force between the two objects, which
 is effectively a frictional force. For example, you may have game 
objects that should be destroyed only if a collision is sufficiently 
forceful.</p>
<p>The direct force of the collision is reported within the 
"postCollision" event as <span class="geshifilter"><code class="lua 
geshifilter-lua">event.force</code></span>, and the frictional force is 
available as <span class="geshifilter"><code class="lua geshifilter-lua">event.friction</code></span>.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> <span class="kw1">function</span> onPostCollision<span class="br0">(</span> event <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span> event.force <span class="sy0">&gt;</span> <span class="nu0">1.0</span> <span class="br0">)</span> <span class="kw1">then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span> <span class="st0">"Collision force: "</span> .. event.force .. <span class="st0">" Friction: "</span> .. event.friction <span class="br0">)</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">end</span>
<span class="kw1">end</span>
&nbsp;
Runtime:addEventListener<span class="br0">(</span> <span class="st0">"postCollision"</span>, onPostCollision <span class="br0">)</span></pre></div></div>

<p>In the example above, very small forces are screened out. Also, a 
global listener is used here to simplify the example.</p>
<p>
Since the <span class="geshifilter"><code class="lua geshifilter-lua">postCollision</code></span>
 event stream from the physics engine can be quite noisy (it registers a
 series of increasingly tiny forces as objects "settle"), you will 
probably want to choose your own threshold for ignoring some of it. See 
the "CollisionDetection" sample project for an example of how to do this
 (run the project using Corona Terminal to see the output of the 
collisions.)</p>
<p>(Technical note: Box2D is actually reporting collision <em>impulses</em>,
 which are forces multiplied by the elapsed time of each world step, but
 since this time interval is always the same, this distinction can be 
ignored for the purposes of game logic.)</p>

<p>&nbsp;</p>

<h4 id="Collision_categories_masking_and_groups">Collision categories, 
masking, and groups</h4>
<hr>
<p>By default, all bodies collide with all other bodies, but you may 
want to fine-tune this behavior. For example, in the classic arcade game
 <em>Asteroids</em>, none of the asteroids collide with other asteroids,
 but all of them should collide with the player and with the enemy 
spaceships. There are two ways to accomplish this. </p>
<p>First, you can assign <span class="geshifilter"><code class="lua 
geshifilter-lua">categoryBits</code></span> and <span 
class="geshifilter"><code class="lua geshifilter-lua">maskBits</code></span>
 to your objects via a filter definition, which is an optional table 
assigned during body construction. An object will only collide with 
other objects if their categoryBits are among its assigned maskBits. 
Normally, an object will only have one category bit assigned, but may 
have one or more mask bits depending on what other things it should 
collide with.</p>
<p>In the example below, the red balloon has a maskBits value of 3, so 
it would collide with any objects in category bits 2 and 1, which in 
this case would include other red balloons (category bit 2) or the wall 
objects (category bit 1). Meanwhile, it will pass through any blue 
balloons (category bit 4), since bit 4 is not included in its maskBits 
value.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">borderCollisionFilter <span class="sy0">=</span> <span class="br0">{</span> categoryBits <span class="sy0">=</span> <span class="nu0">1</span>, maskBits <span class="sy0">=</span> <span class="nu0">6</span> <span class="br0">}</span> 
<span class="co1">-- border collides with (4 &amp; 2) only</span>
&nbsp;
borderBody <span class="sy0">=</span> <span class="br0">{</span> friction<span class="sy0">=</span><span class="nu0">0.4</span>, bounce<span class="sy0">=</span><span class="nu0">0.8</span>, bodyType<span class="sy0">=</span><span class="st0">"static"</span>, filter<span class="sy0">=</span>borderCollisionFilter <span class="br0">}</span>
&nbsp;
<span class="kw1">local</span> borderTop <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">320</span>, <span class="nu0">1</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> borderTop, borderBody <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> borderBottom <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">0</span>, <span class="nu0">479</span>, <span class="nu0">320</span>, <span class="nu0">1</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> borderBottom, borderBody <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> borderLeft <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">0</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">480</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> borderLeft, borderBody <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> borderRight <span class="sy0">=</span> display.newRect<span class="br0">(</span> <span class="nu0">319</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">480</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> borderRight, borderBody <span class="br0">)</span>
&nbsp;
<span class="kw1">local</span> redCollisionFilter <span class="sy0">=</span> <span class="br0">{</span> categoryBits <span class="sy0">=</span> <span class="nu0">2</span>, maskBits <span class="sy0">=</span> <span class="nu0">3</span> <span class="br0">}</span> 
<span class="co1">-- red collides with (2 &amp; 1) only</span>
&nbsp;
<span class="kw1">local</span> blueCollisionFilter <span class="sy0">=</span> <span class="br0">{</span> categoryBits <span class="sy0">=</span> <span class="nu0">4</span>, maskBits <span class="sy0">=</span> <span class="nu0">5</span> <span class="br0">}</span> 
<span class="co1">-- blue collides with (4 &amp; 1) only</span>
&nbsp;
<span class="kw1">local</span> redBody <span class="sy0">=</span> <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">0.2</span>, friction<span class="sy0">=</span><span class="nu0">0</span>, bounce<span class="sy0">=</span><span class="nu0">0.95</span>, radius<span class="sy0">=</span><span class="nu0">43.0</span>, filter<span class="sy0">=</span>redCollisionFilter <span class="br0">}</span>
<span class="kw1">local</span> blueBody <span class="sy0">=</span> <span class="br0">{</span> density<span class="sy0">=</span><span class="nu0">0.2</span>, friction<span class="sy0">=</span><span class="nu0">0</span>, bounce<span class="sy0">=</span><span class="nu0">0.95</span>, radius<span class="sy0">=</span><span class="nu0">43.0</span>, filter<span class="sy0">=</span>blueCollisionFilter <span class="br0">}</span>
&nbsp;
redBalloon <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"red_balloon.png"</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> redBalloon, redBody <span class="br0">)</span>
&nbsp;
blueBalloon <span class="sy0">=</span> display.newImage<span class="br0">(</span> <span class="st0">"blue_balloon.png"</span> <span class="br0">)</span>
physics.addBody<span class="br0">(</span> blueBalloon, blueBody <span class="br0">)</span></pre></div></div>

<p>Note that categoryBits and maskBits are binary values that are 
currently assigned using decimal numbers. This is convenient for lower 
bits like 1, 2, 4 and 8, but not so convenient for higher bits -- since 
there are 16 possible categoryBits, the highest bit value is 32768. 
Therefore, future versions of this API may use a different bit 
assignment syntax, such as binary or hexadecimal values.</p>
<p>The second method is to assign a groupIndex to each object, via the 
same filter definition shown above. This value can be a positive or 
negative integer, and is a simpler way of specifying collision rules: 
objects with the same positive groupIndex value will always collide with
 each other, and objects with the same negative groupIndex value will 
never collide with each other.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> greenCollisionFilter <span class="sy0">=</span> <span class="br0">{</span> groupIndex <span class="sy0">=</span> -<span class="nu0">2</span> <span class="br0">}</span></pre></div></div>

<p>If both groupIndex and collisionBits/maskBits are assigned to an 
object, the groupIndex has higher precedence.</p>
<p>See the "CollisionFilter" sample code for an example of collision 
filtering.</p>

<p>&nbsp;</p>

<h4 id="Collision_event_propagation_rules">Collision event propagation 
rules</h4>
<p><span style="color: rgb(255, 0, 0);">(New for Alpha 3.)</span></p>
<p>
Collision events in Corona now have a propagation model similar to touch
 events. You can use this to further optimize your game performance by 
limiting the number of events that are created.</p>
<p>
By default, a collision between two objects will fire a local event for 
the first object, then a local event for the second object, then a 
global event in the Runtime object (assuming all have active listeners 
enabled). However, you may only be interested in some of this 
information. For example, in a game with one player character and lots 
of enemies, you may only be interested in what the player has collided 
with.</p>
<p>
As of Alpha 3, any collision event handler that returns <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">true</span></code></span>
 will stop further propagation of that collision event, even if there 
are further listeners that would otherwise have received it. This allows
 you to further limit the number of events that are created and passed 
to the Lua side. While individual events are not very expensive, large 
numbers of them can affect overall performance, so limiting event 
propagation is a good practice.
</p>  </div>
<div id="node-1463" class="section-2">
  <h1 class="book-heading">Game Edition: Physics Joints</h1>
  <h3 id="Joints">Joints</h3>
<p>Joints are used to assemble more complex game objects from multiple 
rigid bodes. For example, joints would be used to join the limbs of a 
ragdoll figure, or the wheels of a car. </p>
<p>Box2D includes a number of different joint types, each with different
 parameters and functions. Some joint types can be powered by motors, 
and others are subject to various physical restrictions in their ranges 
of motion.</p>
<p>The simplest joint type is the “pivot” joint, which joins two objects
 at a single pivot point, and is illustrated in the “Bridge” and 
“Chains” sample projects.</p>
<p>To construct a joint, first construct the bodies that will be joined,
 and then submit those bodies to the desired joint constructor function.</p>

<p>&nbsp;</p>

<h4 id="Pivot_joint">Pivot joint</h4>
<hr>
<p>A pivot joint (also known as a “revolute joint” in Box2D terms) joins
 two bodies at an overlapping point. The initial arguments are the two 
bodies joined, followed by an anchor point in the global coordinates of 
the world. </p>
<p>Pivot joints can optionally be constrained in their range of 
rotation. For example, if constructing a “ragdoll” figure, the head/neck
 joint would have a limited range of angular motion.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="st0">"pivot"</span>, crateA, crateB, <span class="nu0">200</span>,<span class="nu0">300</span> <span class="br0">)</span></pre></div></div>

<p><strong>Joint motors</strong></p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.isMotorEnabled <span class="co1">-- (boolean)</span>
myJoint.motorSpeed
myJoint.motorTorque &nbsp;<span class="co1">-- (get-only)</span>
myJoint.maxMotorTorque &nbsp;<span class="co1">-- (set-only)</span></pre></div></div>

<p>By default, joint motors have a fairly weak maximum torque, and 
therefore setting <span class="geshifilter"><code class="lua 
geshifilter-lua">motorSpeed</code></span> may appear to have little 
visible effect. Therefore, you should generally set <span 
class="geshifilter"><code class="lua geshifilter-lua">maxMotorTorque</code></span>
 to a high value (such as <span class="geshifilter"><code class="lua 
geshifilter-lua"><span class="nu0">100000</span></code></span>) if you 
are trying to move any significant mass, such as rotating a wheel to 
power a car.</p>

<p><strong>Rotation limits</strong></p>

<p>Pivot joints can optionally be constrained in their range of 
rotation. For example, if constructing a "ragdoll" figure, the head/neck
 joint would have a limited range of angular motion. These rotation 
limits are specified in degrees:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.isLimitEnabled <span class="sy0">=</span> <span class="kw1">true</span> <span class="co1">-- (boolean)</span>
&nbsp;
myJoint:setRotationLimits<span class="br0">(</span> -<span class="nu0">45</span>, <span class="nu0">45</span> <span class="br0">)</span>
a1, a2 <span class="sy0">=</span> myJoint:getRotationLimits<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p><strong>Other attributes:</strong></p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.jointAngle <span class="co1">-- (get-only; value in degrees)</span>
myJoint.jointSpeed <span class="co1">-- (get only; value in degrees per second)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Distance_joint">Distance joint</h4>
<hr>
<p>A distance joint joins two bodies at a fixed distance. The initial 
arguments are the two bodies joined, followed by an (x,y) anchor point 
for each body. Anchor points are declared in the world coordinates.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="st0">"distance"</span>, crateA, crateB, crateA.x,crateA.y, crateB.x,crateB.y <span class="br0">)</span></pre></div></div>

<p><strong>Other attributes:</strong></p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.length
myJoint.frequency
myJoint.dampingRatio</pre></div></div>

<p><span class="geshifilter"><code class="lua geshifilter-lua">length</code></span>
 is the distance between the anchor points, which should not be zero or 
very short (you should use a pivot joint if you need to directly anchor 
one body to another).</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">frequency</code></span>
 is the mass-spring damping frequency (in Hz)</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">dampingRatio</code></span>
 ranges from 0, for no damping, to 1, for critical damping.</p>

<p>&nbsp;</p>

<h4 id="Piston_joint">Piston joint</h4>
<hr>
<p>A piston joint (also known as a “prismatic joint” in Box2D terms) 
joins two bodies along a single, restricted axis of motion, like the 
pistons or a shock absorber in a car. The initial arguments are the two 
bodies joined, followed by an anchor point in the first body and a 
vector defining the axis along which motion is allowed.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="st0">"piston"</span>, crateA, crateB, crateA.x,crateA.y, axisDistanceX,axisDistanceY <span class="br0">)</span></pre></div></div>

<p>(Note: at least one of the bodies should be dynamic, with non-fixed 
rotation.)</p>

<p><strong>Joint motors</strong></p>

<p>A piston joint may also be driven by a motor. Unlike the pivot joint,
 this motion will be linear, along the specified axis, rather than 
rotational.
</p>
<p></p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.isMotorEnabled <span class="co1">-- (boolean)</span>
myJoint.motorSpeed <span class="co1">-- (linear speed, in units of pixels per second)</span>
myJoint.motorForce &nbsp;<span class="co1">-- (get-only)</span>
myJoint.maxMotorForce &nbsp;<span class="co1">-- (set-only)</span></pre></div></div>

<p><strong>Motion limits</strong></p>

<p>In addition, limits on its range of linear motion may be specified:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.isLimitEnabled <span class="sy0">=</span> <span class="kw1">true</span> <span class="co1">-- (boolean)</span>
&nbsp;
myJoint:setLimits<span class="br0">(</span> <span class="nu0">100</span>, <span class="nu0">200</span> <span class="br0">)</span>
p1, p2 <span class="sy0">=</span> myJoint:getLimits<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p><strong>Other attributes:</strong></p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.jointTranslation <span class="co1">-- (get-only; linear value in pixels)</span>
myJoint.jointSpeed <span class="co1">-- (get only; value in pixels per second)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Friction_joint">Friction joint</h4>
<hr>

<p>A friction joint is a special kind of pivot joint that resists 
motion, and is therefore “sticky”:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="st0">"friction"</span>, crateA, crateB, <span class="nu0">200</span>,<span class="nu0">300</span> <span class="br0">)</span></pre></div></div>

<p>It exposes only two attributes:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.maxForce
myJoint.maxTorque</pre></div></div>

<p>&nbsp;</p>

<h4 id="Weld_joint">Weld joint</h4>
<hr>

<p>A weld joint “welds” two bodies together at a specified point in 
world coordinates:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="st0">"weld"</span>, crateA, crateB, <span class="nu0">200</span>,<span class="nu0">300</span> <span class="br0">)</span></pre></div></div>

<p>This joint does not move or rotate at all, and so it exposes no 
attributes.</p>
<p>However, due to mathematical approximation, this joint may appear 
slightly “soft” during motion, and so if you want to rigidly bond 
multiple shapes together, you may want to specify them as multiple body 
elements within a single complex body, rather than using weld joints.</p>

<p>&nbsp;</p>

<h4 id="Wheel_joint">Wheel joint</h4>
<hr>

<p>A wheel joint (also known as a “line joint” in Box2D terms) combines a
 piston and a pivot joint, like a wheel mounted on the shock absorber of
 a car. Most of its properties are inherited from the standard piston 
joint; the difference is that the body at the end of the axis is allowed
 to rotate freely.</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="st0">"wheel"</span>, crateA, crateB, crateA.x,crateA.y, axisDistanceX,axisDistanceY <span class="br0">)</span></pre></div></div>

<p><strong>Joint motors</strong></p>
<p>Like a piston joint, the “shock absorber” portion of a wheel joint 
may be driven by a joint motor. This motion will be linear, along the 
specified axis, rather than rotational.</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.isMotorEnabled <span class="co1">-- (boolean)</span>
myJoint.motorSpeed <span class="co1">-- (linear speed, in units of pixels per second)</span>
myJoint.motorForce &nbsp;<span class="co1">-- (get-only)</span>
<span class="co1">-- myJoint.maxMotorForce &nbsp;-- (not currently supported in Box2D library; known bug)</span></pre></div></div>

<p><strong>Motion limits</strong></p>
<p>In addition, limits on its range of linear motion may be specified:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.isLimitEnabled <span class="sy0">=</span> <span class="kw1">true</span> <span class="co1">-- (boolean)</span>
&nbsp;
myJoint:setLimits<span class="br0">(</span> <span class="nu0">100</span>, <span class="nu0">200</span> <span class="br0">)</span>
p1, p2 <span class="sy0">=</span> myJoint:getLimits<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p><strong>Other attributes:</strong></p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.jointTranslation <span class="co1">-- (get-only; linear value in pixels)</span>
myJoint.jointSpeed <span class="co1">-- (get only; value in pixels per second)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Pulley_joint">Pulley joint</h4>
<hr>

<p>A pulley joint attaches two bodies with an imaginary rope whose 
length remains constant: if one body is pulled down, the other one will 
move up.</p>
<p>This constructor is a bit complicated, because it must specify a 
joint anchor point within each body, and also a stationary anchor point 
in world coordinates for each side of the “rope” to hang from. Finally, 
there is a “ratio” property to optionally simulate a block and tackle 
arrangement, in which one side of the rope moves faster than the other. 
By default, this ratio is 1.0, which simulates a simple pulley.</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint <span class="sy0">=</span> physics.newJoint<span class="br0">(</span> <span class="sy0">&amp;</span>quot<span class="sy0">;</span>pulley<span class="sy0">&amp;</span>quot<span class="sy0">;</span>, crateA, crateB, anchorA_x,anchorA_y, anchorB_x,anchorB_y, crateA.x,crateA.y, crateB.x,crateB.y, <span class="nu0">1.0</span> <span class="br0">)</span></pre></div></div>

<p>It exposes the following read-only attributes:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint.length1 <span class="co1">-- (get-only; value in pixels)</span>
myJoint.length2 <span class="co1">-- (get-only; value in pixels)</span>
myJoint.ratio <span class="co1">-- (get-only)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Common_features_of_all_joints">Common features of all joints</h4>
<hr>

<p>In addition to the above, all joint types share several common 
attributes and functions:</p>

<p><strong>myJoint:getAnchorA<br>
myJoint:getAnchorB</strong></p>

<p>A function that returns the (x,y) coordinates of the joint’s anchor 
points within objects A and B, which are the two joined objects. The 
values are given in the local coordinates of each object, so an anchor 
point at the center of the object would be at position (0, 0).</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">x, y <span class="sy0">=</span> myJoint:getAnchorA<span class="br0">(</span><span class="br0">)</span>
x, y <span class="sy0">=</span> myJoint:getAnchorB<span class="br0">(</span><span class="br0">)</span></pre></div></div>
<p><strong>myJoint:getReactionForce</strong></p>
<p>A function that returns the reaction force (in Newtons) at the joint 
anchor in the second body.</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">reactionForce <span class="sy0">=</span> myJoint:getReactionForce<span class="br0">(</span><span class="br0">)</span></pre></div></div>

<p>&nbsp;</p>

<h4 id="Destroying_joints">Destroying joints</h4>
<hr>
<p style="color: rgb(255, 0, 0);" ;="">(Alpha 3 and above)</p>
<p>To destroy an existing joint, and detach the two bodies (which may 
then collide), use <span class="geshifilter"><code class="lua 
geshifilter-lua">removeSelf<span class="br0">(</span><span class="br0">)</span></code></span>:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">myJoint:removeSelf<span class="br0">(</span><span class="br0">)</span></pre></div></div>
  </div>
<div id="node-1209" class="section-2">
  <h1 class="book-heading">Game Edition: Sprite Sheets</h1>
  <h3 id="What_are_Sprite_Sheets">What are Sprite Sheets?</h3>
<p>Sprite sheets are 2D animations packed as multiple frames into a 
single texture image. This allows a much more efficient use of texture 
memory, which is highly limited on mobile devices, and also minimizes 
loading time.</p>
<p>Corona Game Edition currently supports sprite sheets in which all 
animation frames are the same size. We plan to support differently-sized
 frames in the future.</p>
<p> Corona also includes constructors for complex animated characters 
with multiple sequences, and sequence playback methods that are 
time-based rather than frame-based, so animation duration will remain 
consistent on slower devices. These time-based sequences also allow you 
to individually choose and tweak the frame rate for each sequence, 
rather than having the animation speed locked to the application’s 
global frame rate.</p>
<p>There may be more than one instance of each sprite on the stage at 
the same time, playing at different locations and with different 
durations. A sprite animation behaves like any other Corona display 
object -- it may be added to a group or transformed, or even used as a 
Box2D physics object.</p>
<p>For constructing sprite sheets, a useful utility is Zwoptex (<a 
href="http://developer.anscamobile.com/%22http://www.zwoptexapp.com/%22">http://www.zwoptexapp.com/</a>).
 Zwoptex recently switched from being free to paid software, but the 
web-based version at that site remains free. Note that the Plist 
metadata also generated by this tool is not currently used, since the 
sprite frame size is specified from within Corona.</p>
<p> The “JungleScene” sample project demonstrates sprite sheets running 
animations at different frame rates. To see an example of sprite sheet 
source images, view the files “greenman.png” and “runningcat.png” in 
that project folder.</p>

<p>&nbsp;</p>

<h3 id="Summary">Summary</h3>
<p>For each animation sequence, the developer specifies the following 
things:</p>
<ul>
<li>Source image (the sprite sheet)</li>
<li>Size of sprite (width, height). In our initial implementation, all 
sprite frames must be the same size. Typically they are powers of two, 
but this isn't really required.</li>
<li>Location of sprite frames -- these may not be contiguous!</li>
</ul>

<p>When drawing an instance of the sprite animation, the developer 
specifies:</p>
<ul>
<li>Destination in the scene</li>
<li>Optional transforms such as rotate/scale</li>
<li>Length of animation (time-based)</li>
<li>Looping behavior</li>
</ul>

<p>&nbsp;</p>

<h3 id="Sprite_API">Sprite API</h3>
<p>This line makes the sprite features available under the “sprite” 
namespace:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">require</span> <span class="st0">"sprite"</span></pre></div></div>

<p>&nbsp;</p>
<h4 id="sprite.newSpriteSheet">sprite.newSpriteSheet</h4>

<p>Creates a new sprite sheet, but does not add anything to the display 
list.</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">spriteSheet <span class="sy0">=</span> sprite.newSpriteSheet<span class="br0">(</span><span class="st0">"image.png"</span>, frameWidth, frameHeight<span class="br0">)</span></pre></div></div>

<p>Currently, the number of frames in the sprite sheet is assumed to be <span
 class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">floor</span><span
 class="br0">(</span>imageWidth<span class="sy0">/</span>frameWidth<span
 class="br0">)</span> <span class="sy0">*</span> <span class="kw1">floor</span><span
 class="br0">(</span>imageHeight<span class="sy0">/</span>frameHeight<span
 class="br0">)</span></code></span>. They are indexed in row major 
order:</p>
<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="nu0">1</span> <span class="nu0">2</span> <span class="nu0">3</span>
<span class="nu0">4</span> <span class="nu0">5</span> <span class="nu0">6</span>
<span class="nu0">7</span> <span class="nu0">8</span> <span class="nu0">9</span></pre></div></div>
<p>In the future, there will be additional ways to specify a sprite 
sheet.</p>

<p>&nbsp;</p>
<h4 id="spriteSet_sprite.newSpriteSetspriteSheet_startFrame_frameCount">spriteSet
 = sprite.newSpriteSet(spriteSheet, startFrame, frameCount)</h4>
<p>Creates a new sprite set from a sprite sheet. Since a single sprite 
sheet may contain images from unrelated game characters, a “sprite set” 
defines the collection of frames that belong to the same game character,
 which may then be subdivided into different animation sequences for 
playback. For example, a fighting game character would probably have 
different animation sequences for punching and for kicking, but these 
would be defined within the same sprite set.</p>
<p><span class="geshifilter"><code class="lua geshifilter-lua">startFrame</code></span>
 is the index number of the first frame of the sprite, using the index 
defined in <span class="geshifilter"><code class="lua geshifilter-lua">newSpriteSheet<span
 class="br0">(</span><span class="br0">)</span></code></span> above, and
 <span class="geshifilter"><code class="lua geshifilter-lua">frameCount</code></span>
 is the total number of frames in the set.</p>
<p>A sprite set is a Lua table containing keys to one or more animation 
sequences for a given character. Each sprite set is created with an 
initial sequence named "default", containing all frames in the set, so 
you can either use this default sequence immediately or define further 
animation sequences within the set.</p>

<p>&nbsp;</p>
<h4 
id="sprite.add_spriteSet_startFlying_startFrame_frameCount_time_loopCount_">sprite.add(
 spriteSet, "startFlying", startFrame, frameCount, time, [loopCount]) </h4>
<p>Adds a sequence named "startFlying" to the sprite set with the 
specified frames. The sequence has <span class="geshifilter"><code 
class="lua geshifilter-lua">frameCount</code></span> frames, and will 
play for <span class="geshifilter"><code class="lua geshifilter-lua"><span
 class="kw1">time</span></code></span> milliseconds. You can control the
 frame rate of each sequence individually by altering this <span 
class="geshifilter"><code class="lua geshifilter-lua"><span class="kw1">time</span></code></span>
 parameter. </p>
<p>If <span class="geshifilter"><code class="lua geshifilter-lua">frameCount</code></span>
 is negative, the sequence starts playing backwards. For example, <span 
class="geshifilter"><code class="lua geshifilter-lua">startFrame <span 
class="sy0">=</span> <span class="nu0">3</span></code></span> and <span 
class="geshifilter"><code class="lua geshifilter-lua">frameCount <span 
class="sy0">=</span> -<span class="nu0">3</span></code></span> will play
 frames in a <em>3, 2, 1</em> order.</p>
<p>The optional parameter <span class="geshifilter"><code class="lua 
geshifilter-lua">loopCount</code></span> specifies how many times the 
animation sequence will loop. A loopCount of 0 (which is the default) 
means that the sequence will loop indefinitely. A loopCount of -1 means 
that the sequence will "bounce" back and forth exactly once (1, 2, 3, 2,
 1). Finally, a loopCount of -2 means that the sequence will bounce back
 and forth forever. In our 3-frame example, this would play in the 
following order: <em>1, 2, 3, 2, 1, 2, 3, 2, 1</em> (...) and so on.</p>

<p>&nbsp;</p>
<h4 id="si_sprite.newSprite_spriteSet_">si = sprite.newSprite( spriteSet
 )</h4>
<p>Create a new instance of a sprite.  A sprite is a DisplayObject. 
Sprites play one animation sequence at a time.</p>

<p>&nbsp;</p>
<h4 id="si:preparesequence">si:prepare([sequence])</h4>
<p>Stops any currently playing animation sequence, optionally sets the 
new current sequence, and also moves to the first frame of that 
sequence. This also resets the loop counter, if any. However, this does 
not start playing the current sequence. </p>

<p>&nbsp;</p>
<h4 id="si:play">si:play()</h4>
<p>Play animation sequence, starting at the current frame.  Does not 
reset looping.</p>

<p>&nbsp;</p>
<h4 id="si:pause">si:pause()</h4>
<p>Stop animation, but the frame remains on the last displayed frame. 
Playback can resume later with play().</p>

<p>&nbsp;</p>
<h4 id="si:addEventListenersprite_listener">si:addEventListener("sprite",
 listener)</h4>
<p>Notify listener when the spriteInstance animation has an event.</p>

<p>The event, passed to the listener, has the following fields:</p>
<p><strong>event.sprite
The sprite that fired the event; its current properties may also be 
accessed via the event: e.g., <span class="geshifilter"><code class="lua
 geshifilter-lua">event.sprite.sequence</code></span>.
</strong></p><p><strong><strong>event.phase</strong><br>
The phase is one of:</strong></p><strong>
<p>"end" - the sprite stops playing</p>
<p>"loop" - the sprite loops (from last to first, or reverses direction)</p>
<p>"next" - the sprite's next frame is played</p>

<p>Also see "Custom Events" in the Corona API Reference.</p>

<h4 id="Sprite_properties">Sprite properties</h4>
<hr>
<p><strong>animating</strong> = true/false. read only.</p>
<p><strong>currentFrame</strong> = frame # of animation. read/write.</p>
<p><strong>sequence</strong> = name of currently playing sequence</p>
  </strong></div><strong>
<div id="node-1210" class="section-2">
  <h1 class="book-heading">Game Edition: OpenFeint</h1>
  <p>OpenFeint is a 3rd party library that enables social gaming 
features such as public leaderboards and achievements. For more 
information, see <a href="http://www.openfeint.com/">http://www.openfeint.com/</a>
 and <a href="http://www.openfeint.com/developers">http://www.openfeint.com/developers</a>.</p>
<ul>
<li>This API is experimental and subject to change, since OpenFeint is 
currently evolving, and Apple’s Game Center has recently been announced.</li>
<li>In the current alpha, this feature is iPhone-only, since OpenFeint 
is not available for Android.</li>
<li>There is no simulator support for this feature, since OpenFeint is 
not available for MacOS.</li>
</ul>

<p>For examples of basic OpenFeint integration, see the “OpenFeint 
landscape” and “OpenFeint portrait” sample projects (these must be built
 for iPhone or iPad).</p>

<p>&nbsp;</p>

<h3 id="OpenFeint_API">OpenFeint API</h3>
<p>This line makes the OpenFeint features available under the 
“openfeint” namespace:</p>

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1">openfeint <span class="sy0">=</span> <span class="kw1">require</span> <span class="st0">"openfeint"</span></pre></div></div>

<p>&nbsp;</p>

<h4 
id="openfeint.init_OpenFeint_Product_Key_OpenFeint_Product_Secret_Display_Name_">openfeint.init(
 "&lt;OpenFeint Product Key&gt;", "&lt;OpenFeint Product Secret&gt;", 
"Display Name" )</h4>
<p>Initializes an app with the specified product key, secret, and 
display name. This should only be called once, as early as possible.</p>

<p>&nbsp;</p>

<h4 id="openfeint.launchDashboard">openfeint.launchDashboard()</h4>
<p>Launches the OpenFeint dashboard.</p>

<p>&nbsp;</p>

<h4 id="openfeint.launchDashboardWithListLeaderboardsPage">openfeint.launchDashboardWithListLeaderboardsPage()</h4>
<h4 id="openfeint.launchDashboardWithChallengesPage">openfeint.launchDashboardWithChallengesPage()</h4>
<h4 id="openfeint.launchDashboardWithAchievementsPage">openfeint.launchDashboardWithAchievementsPage()</h4>
<h4 id="openfeint.launchDashboardWithFindFriendsPage">openfeint.launchDashboardWithFindFriendsPage()</h4>
<h4 id="openfeint.launchDashboardWithWhosPlayingPage">openfeint.launchDashboardWithWhosPlayingPage()</h4>
<p>Launches variations of the OpenFeint dashboard.</p>

<p>&nbsp;</p>

<h4 id="openfeint.unlockAchievement_achievementId_">openfeint.unlockAchievement(
 achievementId )</h4>
<p>Unlocks the specified achievement.</p>

<p>&nbsp;</p>

<h4 id="openfeint.setHighScore_leaderboardId_score_">openfeint.setHighScore(
 leaderboardId, score )</h4>
<p>Sets a high score.</p>

<p>&nbsp;</p>

<h4 id="Network_Save_Card">Network Save Card</h4>
<hr>
You can now save arbitrary blobs of game data in the cloud, using 
OpenFeint's "Network Save Card":

<div class="geshifilter"><div class="lua geshifilter-lua"><pre class="de1"><span class="kw1">local</span> downloadListener <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">(</span>event<span class="br0">)</span> 
&nbsp; &nbsp; <span class="kw1">print</span><span class="br0">(</span>event.name .. <span class="st0">" =&gt; '"</span> .. event.blob .. <span class="st0">"' downloaded"</span><span class="br0">)</span> 
&nbsp; &nbsp; <span class="kw1">return</span> <span class="kw1">true</span> 
<span class="kw1">end</span>
&nbsp;
openfeint.uploadBlob<span class="br0">(</span> blobKey, <span class="st0">"some blob data"</span> <span class="br0">)</span>
openfeint.downloadBlob<span class="br0">(</span> blobKey, downloadListener <span class="br0">)</span></pre></div></div>

<p>The <span class="geshifilter"><code class="lua geshifilter-lua">blobKey</code></span>
 is a string key to identify what data to store. The blob data is any 
lstring up to the length that OpenFeint allows. </p>
<p>The download listener will be invoked when the download finishes. If 
the blob's length is 0, then the download did not succeed.</p>  </div>
</strong></div><strong>
    
  

</strong></body></html>
